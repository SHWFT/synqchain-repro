<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SynqChain - Supply Chain. Perfected. Sync'd.</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            margin: 0; 
            padding: 0; 
        }
        .app-container { 
            display: none; 
        }
        .app-container.active { 
            display: flex; 
        }
        .login-container { 
            display: flex; 
        }
        .login-container.hidden { 
            display: none; 
        }
        /* Horizontal Navigation Styles */
        .nav-item-horizontal {
            position: relative;
            transition: all 0.2s ease;
        }
        
        .nav-item-horizontal.active { 
            background-color: #3b82f6; 
            color: white; 
            font-weight: 600;
        }
        
        .nav-item-horizontal:hover {
            background-color: #e5e7eb;
            color: #111827;
        }
        
        .nav-item-horizontal.active:hover {
            background-color: #2563eb;
            color: white;
        }
        
        /* Legacy sidebar styles (keeping for compatibility) */
        .nav-item.active { 
            background-color: #f1f5f9; 
            color: #1f2937; 
            font-weight: 600;
        }
        
        .nav-item:hover {
            background-color: #e5e7eb;
            color: #111827;
        }
        
        .nav-collapsed .nav-item.active {
            background-color: #f1f5f9;
            color: #1f2937;
            font-weight: 600;
        }
        
        .nav-collapsed .nav-item:hover {
            background-color: #e5e7eb;
            color: #111827;
        }

        .po-tab-content {
            animation: fadeIn 0.3s ease-in-out;
        }

        .po-tab-content.hidden {
            display: none;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Legacy sidebar styles - no longer needed but kept for compatibility */
        .nav-collapsed {
            width: 4rem !important;
        }
        .nav-collapsed .nav-text {
            display: none !important;
        }
        .nav-collapsed .nav-logo-text {
            display: none !important;
        }
        .toggle-button {
            display: none; /* Hidden since we no longer have a sidebar */
        }

        /* Professional SaaS Login Background */
        .saas-gradient-bg {
            background: linear-gradient(135deg, 
                #ffffff 0%, 
                #f8fafc 25%, 
                #f1f5f9 50%, 
                #e2e8f0 75%, 
                #cbd5e1 100%);
            position: relative;
        }
        
        .saas-gradient-bg::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 20% 80%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 80% 20%, rgba(139, 92, 246, 0.08) 0%, transparent 50%),
                        radial-gradient(circle at 40% 40%, rgba(16, 185, 129, 0.05) 0%, transparent 50%);
            pointer-events: none;
        }
        
        /* SaaS Typography */
        .saas-brand-title {
            font-family: 'Inter', sans-serif;
            font-weight: 700;
            letter-spacing: -0.025em;
            font-size: 3.5rem;
            background: rgba(30, 41, 59, 0.15);
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 1rem;
            padding: 1rem 2rem;
            color: #1e293b;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .saas-tagline {
            font-family: 'Inter', sans-serif;
            font-weight: 500;
            color: #475569;
            letter-spacing: 0.025em;
        }
        
        .saas-subtitle {
            font-family: 'Inter', sans-serif;
            font-weight: 400;
            color: #64748b;
            letter-spacing: 0.01em;
        }

        .ai-support-button {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 1000;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            transition: all 0.3s ease;
            animation: pulse 2s infinite;
        }
        .ai-support-button:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 25px rgba(0,0,0,0.2);
        }
        .ai-chat-window {
            position: fixed;
            bottom: 6rem;
            right: 2rem;
            width: 350px;
            height: 500px;
            background: white;
            border-radius: 1rem;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            z-index: 1001;
            display: none;
            flex-direction: column;
            overflow: hidden;
        }
        .ai-chat-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1rem;
            text-align: center;
            font-weight: 600;
        }
        .ai-chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            max-height: 350px;
        }
        .ai-message {
            margin-bottom: 1rem;
            padding: 0.75rem;
            border-radius: 0.75rem;
            max-width: 85%;
        }
        .ai-message.bot {
            background: #f3f4f6;
            margin-right: auto;
        }
        .ai-message.user {
            background: #3b82f6;
            color: white;
            margin-left: auto;
        }
        .ai-suggestions {
            padding: 1rem;
            border-top: 1px solid #e5e7eb;
            background: #f9fafb;
        }
        .ai-suggestion {
            display: block;
            width: 100%;
            text-align: left;
            padding: 0.5rem;
            margin-bottom: 0.5rem;
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            cursor: pointer;
            font-size: 0.875rem;
            transition: all 0.2s ease;
        }
        .ai-suggestion:hover {
            background: #f3f4f6;
            border-color: #3b82f6;
        }
        @keyframes pulse {
            0% { box-shadow: 0 4px 20px rgba(0,0,0,0.15); }
            50% { box-shadow: 0 4px 20px rgba(102, 126, 234, 0.4); }
            100% { box-shadow: 0 4px 20px rgba(0,0,0,0.15); }
        }
        .content-page { 
            display: none; 
            min-height: calc(100vh - 4rem); /* Ensure content takes full height minus padding */
            overflow-y: auto;
            height: 100%;
        }
        .content-page.active { 
            display: block; 
        }
        
        /* Ensure scrolling works on all pages */
        .overflow-auto {
            overflow-y: auto !important;
            overflow-x: hidden !important;
        }
        .modal { 
            display: none; 
            position: fixed; 
            top: 0; 
            left: 0; 
            right: 0; 
            bottom: 0; 
            background: rgba(0,0,0,0.5); 
            z-index: 50; 
        }
        .modal.active { 
            display: flex; 
            align-items: center; 
            justify-content: center; 
        }
        .wizard-step { 
            display: none; 
        }
        .wizard-step.active { 
            display: block; 
        }
        .status-draft { background-color: #f3f4f6; color: #374151; }
        .status-pending-approval { background-color: #fef3c7; color: #92400e; }
        .status-approved { background-color: #d1fae5; color: #065f46; }
        .status-acknowledged { background-color: #dbeafe; color: #1e40af; }
        .status-in-fulfillment { background-color: #e0e7ff; color: #5b21b6; }
        .status-shipped { background-color: #fecaca; color: #991b1b; }
        .status-delivered { background-color: #bbf7d0; color: #059669; }
        .status-invoiced { background-color: #fed7d7; color: #e53e3e; }
        .status-paid { background-color: #c6f6d5; color: #22543d; }
        .status-closed { background-color: #f7fafc; color: #2d3748; }
        
        /* Login animation */
        .login-fade-out {
            animation: fadeOut 0.5s ease-in-out forwards;
        }
        .app-fade-in {
            animation: fadeIn 0.5s ease-in-out forwards;
        }
        
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
    </style>
</head>
<body class="bg-gray-50 h-screen overflow-hidden">
    <!-- Login Page - Full Screen Gateway -->
    <div id="login-container" class="login-container h-screen w-full">
        <div class="min-h-screen w-full flex items-center justify-center saas-gradient-bg">
            <div class="max-w-lg w-full space-y-8 p-8 relative z-10">
                <!-- Logo and Branding -->
                <div class="text-center">
                    <div class="mx-auto w-24 h-24 bg-gradient-to-br from-white via-gray-50 to-gray-200 rounded-2xl flex items-center justify-center mb-8 shadow-lg border border-gray-200">
                        <img src="./public/brand/synqchain-new-logo.png" alt="Sync'd by SynqChain" width="48" height="48">
                    </div>
                    <p class="text-lg mb-4 saas-tagline">Supply Chain. Perfected. Sync'd.</p>
                    <p class="text-sm saas-subtitle">Next-generation procurement intelligence platform</p>
                </div>
                
                <form id="loginForm" class="mt-8 space-y-6">
                    <div class="bg-white/95 backdrop-blur-lg rounded-2xl shadow-2xl p-8 border border-white/20"
                         style="box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);">
                        <div class="space-y-6">
                    <div>
                                <label for="email" class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
                        <input id="email" name="email" type="email" value="demo@demo.com" required 
                                       class="block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200" 
                                       placeholder="Enter your email">
                    </div>
                    <div>
                                <label for="password" class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                        <input id="password" name="password" type="password" value="demo" required
                                       class="block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200" 
                                       placeholder="Enter your password">
                    </div>
                    </div>
                    
                        <button type="submit" class="w-full mt-8 bg-slate-900 hover:bg-slate-800 text-white py-3 px-6 rounded-lg font-medium focus:outline-none focus:ring-2 focus:ring-slate-500 focus:ring-offset-2 transition-all duration-200 shadow-lg hover:shadow-xl">
                            Access Platform
                        </button>
                        
                        <div class="mt-6 text-center">
                            <div class="bg-blue-50 rounded-lg p-3 border border-blue-200">
                                <p class="text-sm text-blue-800 font-medium">Demo Access</p>
                                <p class="text-xs text-blue-600">demo@demo.com / demo</p>
                            </div>
                        </div>
                    </div>
                </form>
                
                <!-- Features Preview -->
                <div class="grid grid-cols-3 gap-4 mt-8 text-center">
                    <div class="text-gray-600">
                        <div class="text-2xl mb-1">📊</div>
                        <div class="text-xs">Analytics</div>
            </div>
                    <div class="text-gray-600">
                        <div class="text-2xl mb-1">🤖</div>
                        <div class="text-xs">AI Assistant</div>
                    </div>
                    <div class="text-gray-600">
                        <div class="text-2xl mb-1">⚡</div>
                        <div class="text-xs">Real-time</div>
                    </div>
                </div>
                
            </div>
        </div>
    </div>

    <!-- Main Application - Hidden Until Login -->
    <div id="app-container" class="app-container h-screen flex flex-col">
        <!-- Top Navigation Bar -->
        <div id="top-nav" class="bg-white shadow-lg border-b border-gray-200 h-16 flex items-center justify-between px-6">
            <!-- Left Side - Logo and Brand -->
            <div class="flex items-center space-x-6">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-white via-gray-50 to-gray-200 rounded-xl flex items-center justify-center shadow-md border border-gray-200">
                        <img src="./public/brand/synqchain-new-logo.png" alt="Sync'd by SynqChain" width="20" height="20">
                    </div>
                    <span class="text-2xl font-bold text-slate-700 tracking-tight">Sync'd</span>
                </div>
            </div>

            <!-- Center - Navigation Menu -->
            <nav class="flex items-center space-x-1 flex space-x-4">
                <button id="nav-dashboard" class="nav-item-horizontal px-4 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 transition-colors active">
                    Dashboard
                </button>
                <button id="nav-projects" class="nav-item-horizontal px-4 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 transition-colors">
                    Projects
                </button>
                <button id="nav-suppliers" class="nav-item-horizontal px-4 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 transition-colors">
                    Suppliers
                </button>
                <button id="nav-po" class="nav-item-horizontal px-4 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 transition-colors">
                    PO Management
                </button>
                <button id="nav-supplier-portal" class="nav-item-horizontal px-4 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 transition-colors">
                    Supplier Portal
                </button>
                <button id="nav-analytics" class="nav-item-horizontal px-4 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 transition-colors">
                    Analytics
                </button>
                <button id="nav-erp-integration" class="nav-item-horizontal px-4 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 transition-colors">
                    ERP Integration
                </button>

            </nav>

            <!-- Right Side - Account Dropdown -->
            <div class="relative">
                <button id="account-dropdown-button" class="flex items-center space-x-3 px-3 py-2 rounded-md hover:bg-gray-100 transition-colors">
                    <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                        <span class="text-blue-600 font-medium text-sm">DU</span>
                    </div>
                    <div class="text-left">
                        <div class="text-sm font-medium text-gray-900">Demo User</div>
                        <div class="text-xs text-gray-500">demo@demo.com</div>
                    </div>
                    <svg class="w-4 h-4 text-gray-400 transition-transform" id="account-dropdown-chevron" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                    </svg>
                </button>
                
                <!-- Account Dropdown Menu -->
                <div id="account-dropdown-menu" class="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg border border-gray-200 py-1 z-50 hidden">
                    <div class="px-4 py-2 border-b border-gray-100">
                        <div class="text-sm font-medium text-gray-900">Demo User</div>
                        <div class="text-xs text-gray-500">demo@demo.com</div>
                    </div>
                    <button onclick="handleNavClick('settings'); toggleAccountDropdown();" class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors flex items-center space-x-2">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                        </svg>
                        <span>Settings</span>
                    </button>
                    <button onclick="handleLogout()" class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors flex items-center space-x-2">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                        </svg>
                        <span>Logout</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="flex-1" style="height: calc(100vh - 4rem); overflow-y: auto; overflow-x: hidden;">
            
            <!-- Modal for supplier details and forms -->
            <div id="modal" class="modal">
                <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4">
                    <div class="flex items-center justify-between p-6 border-b border-gray-200">
                        <h3 id="modal-title" class="text-lg font-semibold text-gray-900"></h3>
                        <button onclick="closeModal()" class="text-gray-400 hover:text-gray-600">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    <div id="modal-content" class="p-6">
                        <!-- Modal content will be inserted here -->
                    </div>
                </div>
            </div>
            <!-- Dashboard -->
            <div id="dashboard-content" class="content-page">
                <div class="p-8">
                    <div class="flex items-center justify-between mb-8">
                        <div>
                            <h1 class="text-3xl font-bold text-gray-900">Dashboard</h1>
                            <p class="text-gray-600">Welcome back! Here's what's happening with your procurement.</p>
                        </div>
                        <div class="text-sm text-gray-500">
                            Last updated: <span id="last-updated">just now</span>
                        </div>
                    </div>
                    
                    <!-- Page-Wide Metrics Filter Section -->
                    <div class="mb-6">
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h3 class="text-lg font-semibold text-gray-900 mb-1">Metrics View</h3>
                                    <p class="text-sm text-gray-600">Select time period to view all dashboard metrics</p>
                                </div>
                                <div class="flex items-center space-x-4">
                                    <div class="flex items-center space-x-2">
                                        <label class="text-sm font-medium text-gray-700">Time Period:</label>
                                        <select id="metrics-time-filter" onchange="applyMetricsTimeFilter()" class="border border-gray-300 rounded-lg px-4 py-2 text-sm font-medium bg-white">
                                            <option value="total">Total (All Time)</option>
                                            <option value="monthly">Monthly View</option>
                                            <option value="weekly">Weekly View</option>
                                            <option value="daily">Daily View</option>
                                        </select>
                                    </div>
                                    <div class="flex items-center space-x-3">
                                        <input type="date" id="dashboard-start-date" class="border border-gray-300 rounded-lg px-3 py-2 text-sm">
                                        <span class="text-gray-500 text-sm">to</span>
                                        <input type="date" id="dashboard-end-date" class="border border-gray-300 rounded-lg px-3 py-2 text-sm">
                                        <button onclick="applyDashboardDateFilter()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 font-medium transition-colors text-sm">Apply</button>
                                        <button onclick="resetDashboardDateFilter()" class="text-blue-600 hover:text-blue-800 text-sm font-medium">Reset</button>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-3 flex items-center justify-between">
                                <span id="dashboard-date-filter-status" class="text-sm text-gray-500">Showing: Total (All Time) Data</span>
                                <div class="flex items-center space-x-4 text-xs text-gray-400">
                                    <span>📊 Total Spend</span>
                                    <span>💰 Platform Savings</span>
                                    <span>📋 Active Projects</span>
                                    <span>📦 Active POs</span>
                                    <span>🎯 All KPIs</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-5 gap-6 mb-8">
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow cursor-pointer" onclick="navigateToAnalytics()">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                    <span class="text-blue-600 text-xl">💰</span>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">Total Spend</p>
                                    <p class="text-2xl font-semibold text-gray-900 total-spend-value">$2.4M</p>
                                    <p class="text-xs text-green-600 spend-change-text">+12% vs last month</p>
                                </div>
                            </div>
                            <div class="mt-2">
                                <p class="text-xs text-gray-400">Click for analytics</p>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow cursor-pointer" onclick="openSavingsTracker()">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                                        <span class="text-green-600 text-xl">💰</span>
                                    </div>
                                    <div class="ml-4">
                                        <p class="text-sm font-medium text-gray-500">Platform Savings</p>
                                        <p class="text-2xl font-semibold text-gray-900 platform-savings-value" id="totalSavings">$12,395</p>
                                        <p class="text-xs text-green-600" id="savingsRate">+$1,847/day avg</p>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <span class="text-xs text-gray-500">Auto-updated by time filter</span>
                                    <p class="text-xs text-gray-400 mt-1">Click for details</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow cursor-pointer" onclick="navigateToProjects()">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                                    <span class="text-purple-600 text-xl">📊</span>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">Active Projects</p>
                                    <p class="text-2xl font-semibold text-gray-900 active-projects-value">23</p>
                                    <p class="text-xs text-blue-600 projects-ending-text">3 ending this week</p>
                                </div>
                            </div>
                            <div class="mt-2">
                                <p class="text-xs text-gray-400">Click to view projects</p>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow cursor-pointer" onclick="navigateToPOs()">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center">
                                    <span class="text-orange-600 text-xl">📋</span>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">Active POs</p>
                                    <p class="text-2xl font-semibold text-gray-900 active-pos-value">47</p>
                                    <p class="text-xs text-orange-600 pos-approval-text">5 need approval</p>
                                </div>
                            </div>
                            <div class="mt-2">
                                <p class="text-xs text-gray-400">Click to manage POs</p>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow cursor-pointer" onclick="navigateToSuppliers()">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-indigo-100 rounded-lg flex items-center justify-center">
                                    <span class="text-indigo-600 text-xl">🏢</span>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">Total Suppliers</p>
                                    <p class="text-2xl font-semibold text-gray-900">234</p>
                                    <p class="text-xs text-indigo-600">187 active (80%)</p>
                                </div>
                            </div>
                            <div class="mt-2">
                                <p class="text-xs text-gray-400">Click to manage suppliers</p>
                            </div>
                        </div>
                    </div>

                    <!-- Savings Dashboard -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                        <!-- Platform Savings Breakdown -->
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <h3 class="text-lg font-medium text-gray-900 mb-4">Platform Savings Breakdown</h3>
                            <div class="space-y-4">
                                <div class="flex items-center justify-between p-2 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors" onclick="showPlatformSavingsDetails('process-automation')">
                                    <div class="flex items-center">
                                        <div class="w-3 h-3 bg-green-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">Process Automation</span>
                                    </div>
                                    <span class="text-sm font-semibold text-gray-900">$12,450</span>
                                </div>
                                <div class="flex items-center justify-between p-2 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors" onclick="showPlatformSavingsDetails('supplier-management')">
                                    <div class="flex items-center">
                                        <div class="w-3 h-3 bg-blue-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">Supplier Management</span>
                                    </div>
                                    <span class="text-sm font-semibold text-gray-900">$8,920</span>
                                </div>
                                <div class="flex items-center justify-between p-2 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors" onclick="showPlatformSavingsDetails('contract-optimization')">
                                    <div class="flex items-center">
                                        <div class="w-3 h-3 bg-purple-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">Contract Optimization</span>
                                    </div>
                                    <span class="text-sm font-semibold text-gray-900">$4,850</span>
                                </div>
                                <div class="flex items-center justify-between p-2 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors" onclick="showPlatformSavingsDetails('data-analytics')">
                                    <div class="flex items-center">
                                        <div class="w-3 h-3 bg-yellow-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">Data Analytics</span>
                                    </div>
                                    <span class="text-sm font-semibold text-gray-900">$2,342</span>
                                </div>
                                <div class="pt-3 border-t border-gray-200">
                                    <div class="flex items-center justify-between">
                                        <span class="text-sm font-medium text-gray-900">Total Platform Savings</span>
                                        <span class="text-lg font-bold text-green-600" id="platform-savings-breakdown">$12,395</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Sourcing Savings by Projects -->
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <h3 class="text-lg font-medium text-gray-900 mb-4">Project Sourcing Savings</h3>
                            <div class="space-y-4">
                                <div class="flex items-center justify-between p-2 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors" onclick="showProjectDetails('manufacturing-equipment')">
                                    <div>
                                        <p class="text-sm font-medium text-gray-900">Manufacturing Equipment RFQ</p>
                                        <p class="text-xs text-gray-500">Completed • Target: $850K</p>
                                    </div>
                                    <div class="text-right">
                                        <p class="text-sm font-semibold text-green-600">$1.2M</p>
                                        <p class="text-xs text-green-600">+41% vs target</p>
                                    </div>
                                </div>
                                <div class="flex items-center justify-between p-2 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors" onclick="showProjectDetails('it-services')">
                                    <div>
                                        <p class="text-sm font-medium text-gray-900">IT Services Consolidation</p>
                                        <p class="text-xs text-gray-500">In Progress • Target: $340K</p>
                                    </div>
                                    <div class="text-right">
                                        <p class="text-sm font-semibold text-green-600">$485K</p>
                                        <p class="text-xs text-green-600">+43% vs target</p>
                                    </div>
                                </div>
                                <div class="flex items-center justify-between p-2 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors" onclick="showProjectDetails('logistics-optimization')">
                                    <div>
                                        <p class="text-sm font-medium text-gray-900">Logistics Optimization</p>
                                        <p class="text-xs text-gray-500">Completed • Target: $220K</p>
                                    </div>
                                    <div class="text-right">
                                        <p class="text-sm font-semibold text-green-600">$295K</p>
                                        <p class="text-xs text-green-600">+34% vs target</p>
                                    </div>
                                </div>
                                <div class="flex items-center justify-between p-2 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors" onclick="showProjectDetails('office-supplies')">
                                    <div>
                                        <p class="text-sm font-medium text-gray-900">Office Supplies Sourcing</p>
                                        <p class="text-xs text-gray-500">In Progress • Target: $85K</p>
                                    </div>
                                    <div class="text-right">
                                        <p class="text-sm font-semibold text-green-600">$92K</p>
                                        <p class="text-xs text-green-600">+8% vs target</p>
                                    </div>
                                </div>
                                <div class="pt-3 border-t border-gray-200">
                                    <div class="flex items-center justify-between">
                                        <span class="text-sm font-medium text-gray-900">Total Project Savings</span>
                                        <span class="text-lg font-bold text-green-600">$2.07M</span>
                                    </div>
                                    <div class="flex items-center justify-between mt-1">
                                        <span class="text-xs text-gray-500">vs Target: $1.5M</span>
                                        <span class="text-xs font-medium text-green-600">+38% above target</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Organizational KPIs -->
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-8">
                        <h3 class="text-lg font-medium text-gray-900 mb-6">Organizational KPIs</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6">
                            <!-- Program Savings -->
                            <div class="text-center cursor-pointer hover:bg-gray-50 p-2 rounded-lg transition-colors" onclick="showKPIDetails('program-savings')">
                                <div class="w-16 h-16 bg-green-100 rounded-lg flex items-center justify-center mx-auto mb-3">
                                    <span class="text-green-600 text-2xl">💰</span>
                                </div>
                                <p class="text-xs font-medium text-gray-500 uppercase tracking-wide">Program Savings</p>
                                <p class="text-2xl font-bold text-gray-900 mt-1">$1.5M</p>
                                <p class="text-xs text-green-600 mt-1">Target: $3.0M</p>
                                <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
                                    <div class="bg-green-500 h-2 rounded-full" style="width: 50%"></div>
                                </div>
                                <p class="text-xs text-gray-400 mt-1">Click for details</p>
                            </div>

                            <!-- On-Time Delivery -->
                            <div class="text-center cursor-pointer hover:bg-gray-50 p-2 rounded-lg transition-colors" onclick="showKPIDetails('otd-rate')">
                                <div class="w-16 h-16 bg-red-100 rounded-lg flex items-center justify-center mx-auto mb-3">
                                    <span class="text-red-600 text-2xl">🚚</span>
                                </div>
                                <p class="text-xs font-medium text-gray-500 uppercase tracking-wide">On-Time Delivery</p>
                                <p class="text-2xl font-bold text-gray-900 mt-1">78.2%</p>
                                <p class="text-xs text-red-600 mt-1">Target: 95%</p>
                                <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
                                    <div class="bg-red-500 h-2 rounded-full" style="width: 78.2%"></div>
                                </div>
                                <p class="text-xs text-gray-400 mt-1">Click for details</p>
                            </div>

                            <!-- Purchase Price Variance -->
                            <div class="text-center cursor-pointer hover:bg-gray-50 p-2 rounded-lg transition-colors" onclick="showKPIDetails('ppv-variance')">
                                <div class="w-16 h-16 bg-green-100 rounded-lg flex items-center justify-center mx-auto mb-3">
                                    <span class="text-green-600 text-2xl">📊</span>
                                </div>
                                <p class="text-xs font-medium text-gray-500 uppercase tracking-wide">PPV</p>
                                <p class="text-2xl font-bold text-gray-900 mt-1">-3.2%</p>
                                <p class="text-xs text-green-600 mt-1">Target: -5.0%</p>
                                <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
                                    <div class="bg-green-500 h-2 rounded-full" style="width: 64%"></div>
                                </div>
                                <p class="text-xs text-gray-400 mt-1">Click for details</p>
                            </div>

                            <!-- Supplier Quality (PPM) -->
                            <div class="text-center cursor-pointer hover:bg-gray-50 p-2 rounded-lg transition-colors" onclick="showKPIDetails('quality-ppm')">
                                <div class="w-16 h-16 bg-red-100 rounded-lg flex items-center justify-center mx-auto mb-3">
                                    <span class="text-red-600 text-2xl">⚙️</span>
                                </div>
                                <p class="text-xs font-medium text-gray-500 uppercase tracking-wide">Quality (PPM)</p>
                                <p class="text-2xl font-bold text-gray-900 mt-1">485</p>
                                <p class="text-xs text-red-600 mt-1">Target: 100 PPM</p>
                                <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
                                    <div class="bg-red-500 h-2 rounded-full" style="width: 20%"></div>
                                </div>
                                <p class="text-xs text-gray-400 mt-1">Click for details</p>
                            </div>

                            <!-- Supplier Responsiveness -->
                            <div class="text-center cursor-pointer hover:bg-gray-50 p-2 rounded-lg transition-colors" onclick="showKPIDetails('response-time')">
                                <div class="w-16 h-16 bg-green-100 rounded-lg flex items-center justify-center mx-auto mb-3">
                                    <span class="text-green-600 text-2xl">⚡</span>
                                </div>
                                <p class="text-xs font-medium text-gray-500 uppercase tracking-wide">Response Time</p>
                                <p class="text-2xl font-bold text-gray-900 mt-1">12h</p>
                                <p class="text-xs text-green-600 mt-1">Target: 24h</p>
                                <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
                                    <div class="bg-green-500 h-2 rounded-full" style="width: 50%"></div>
                                </div>
                                <p class="text-xs text-gray-400 mt-1">Click for details</p>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
                        <div class="px-6 py-4 border-b border-gray-200">
                            <h3 class="text-lg font-medium text-gray-900">Recent Activity</h3>
                        </div>
                        <div class="p-6">
                            <div class="space-y-4">
                                <div class="flex items-start space-x-3">
                                    <span class="text-green-500 text-lg">✅</span>
                                    <div>
                                        <p class="text-sm font-medium text-gray-900">PO-2025-032 approved</p>
                                        <p class="text-xs text-gray-500">Industrial Solutions Inc  $167,000  15 minutes ago</p>
                                    </div>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <span class="text-blue-500 text-lg">📊</span>
                                    <div>
                                        <p class="text-sm font-medium text-gray-900">Q2 IT Procurement project milestone reached</p>
                                        <p class="text-xs text-gray-500">TechCorp Inc  75% completion  1 hour ago</p>
                                    </div>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <span class="text-purple-500 text-lg">🚀</span>
                                    <div>
                                        <p class="text-sm font-medium text-gray-900">New supplier onboarded</p>
                                        <p class="text-xs text-gray-500">NextGen Manufacturing Ltd  2 hours ago</p>
                                    </div>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <span class="text-orange-500 text-lg">📦</span>
                                    <div>
                                        <p class="text-sm font-medium text-gray-900">Shipment received</p>
                                        <p class="text-xs text-gray-500">PO-2025-028  European Logistics Ltd  3 hours ago</p>
                                    </div>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <span class="text-teal-500 text-lg">💰</span>
                                    <div>
                                        <p class="text-sm font-medium text-gray-900">Cost savings target exceeded</p>
                                        <p class="text-xs text-gray-500">European Supplier Consolidation  $720K achieved  4 hours ago</p>
                            </div>
                        </div>
                                <div class="flex items-start space-x-3">
                                    <span class="text-red-500 text-lg">⚠️</span>
                                    <div>
                                        <p class="text-sm font-medium text-gray-900">Quality alert resolved</p>
                                        <p class="text-xs text-gray-500">Automotive Parts supplier issue closed  5 hours ago</p>
                                    </div>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <span class="text-indigo-500 text-lg">🔄</span>
                                    <div>
                                        <p class="text-sm font-medium text-gray-900">ERP sync completed</p>
                                        <p class="text-xs text-gray-500">2,847 records synchronized  6 hours ago</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- KPI Details Modal -->
            <div id="kpi-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
                <div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                    <div class="p-6 border-b border-gray-200">
                        <div class="flex items-center justify-between">
                            <h2 id="kpi-modal-title" class="text-xl font-bold text-gray-900">KPI Details</h2>
                            <button onclick="closeModal('kpi-modal')" class="text-gray-500 hover:text-gray-700">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div id="kpi-modal-content" class="p-6">
                        <!-- Dynamic content will be inserted here -->
                    </div>
                </div>
            </div>

            <!-- Platform Savings Modal -->
            <div id="platform-savings-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
                <div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                    <div class="p-6 border-b border-gray-200">
                        <div class="flex items-center justify-between">
                            <h2 id="platform-modal-title" class="text-xl font-bold text-gray-900">Platform Savings Details</h2>
                            <button onclick="closeModal('platform-savings-modal')" class="text-gray-500 hover:text-gray-700">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div id="platform-modal-content" class="p-6">
                        <!-- Dynamic content will be inserted here -->
                    </div>
                </div>
            </div>

            <!-- Project Details Modal -->
            <div id="project-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
                <div class="bg-white rounded-xl shadow-2xl max-w-3xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                    <div class="p-6 border-b border-gray-200">
                        <div class="flex items-center justify-between">
                            <h2 id="project-modal-title" class="text-xl font-bold text-gray-900">Project Details</h2>
                            <button onclick="closeModal('project-modal')" class="text-gray-500 hover:text-gray-700">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div id="project-modal-content" class="p-6">
                        <!-- Dynamic content will be inserted here -->
                    </div>
                </div>
            </div>

            <!-- New Project Form Modal -->
            <div id="new-project-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
                <div class="bg-white rounded-xl shadow-2xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                    <div class="p-6 border-b border-gray-200">
                        <div class="flex items-center justify-between">
                            <h2 class="text-xl font-bold text-gray-900">Create New Project</h2>
                            <button onclick="closeModal('new-project-modal')" class="text-gray-500 hover:text-gray-700">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="p-6">
                        <form id="new-project-form" onsubmit="submitNewProject(event)">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <!-- Left Column -->
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Project Name *</label>
                                        <input type="text" id="project-name" required class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                                        <textarea id="project-description" rows="3" class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Client *</label>
                                        <select id="project-client" required class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                            <option value="">Select a client</option>
                                            <option value="TechCorp Inc">TechCorp Inc</option>
                                            <option value="Industrial Solutions">Industrial Solutions</option>
                                            <option value="GlobalTrade Ltd">GlobalTrade Ltd</option>
                                            <option value="Healthcare Systems">Healthcare Systems</option>
                                            <option value="Auto Manufacturing">Auto Manufacturing</option>
                                            <option value="Energy Solutions">Energy Solutions</option>
                                            <option value="Financial Services">Financial Services</option>
                                            <option value="RetailMax Corp">RetailMax Corp</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Priority Level *</label>
                                        <select id="project-priority" required class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                            <option value="">Select priority</option>
                                            <option value="Critical">Critical</option>
                                            <option value="High">High</option>
                                            <option value="Medium">Medium</option>
                                            <option value="Low">Low</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <!-- Right Column -->
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Savings Target ($)</label>
                                        <input type="number" id="project-savings" min="0" step="1000" class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Start Date</label>
                                        <input type="date" id="project-start-date" class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Due Date</label>
                                        <input type="date" id="project-due-date" class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Category</label>
                                        <select id="project-category" class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                            <option value="">Select category</option>
                                            <option value="Technology">Technology</option>
                                            <option value="Manufacturing">Manufacturing</option>
                                            <option value="Healthcare">Healthcare</option>
                                            <option value="Automotive">Automotive</option>
                                            <option value="Energy">Energy</option>
                                            <option value="Retail">Retail</option>
                                            <option value="Services">Services</option>
                                            <option value="Logistics">Logistics</option>
                                            <option value="Office">Office</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- AI Suggestions Section -->
                            <div class="mt-8 border-t pt-6">
                                <div class="flex items-center justify-between mb-4">
                                    <h3 class="text-lg font-medium text-gray-900">🤖 AI Project Suggestions</h3>
                                    <button type="button" onclick="generateAISuggestions()" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 font-medium transition-colors text-sm">
                                        Generate Suggestions
                                    </button>
                                </div>
                                <div id="ai-suggestions" class="space-y-3">
                                    <p class="text-gray-500 text-sm">Click "Generate Suggestions" to get AI-powered project recommendations based on your current KPIs and initiatives.</p>
                                </div>
                            </div>
                            
                            <!-- Form Actions -->
                            <div class="flex justify-end space-x-3 mt-8 pt-6 border-t">
                                <button type="button" onclick="closeModal('new-project-modal')" class="px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 font-medium transition-colors">
                                    Cancel
                                </button>
                                <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium transition-colors">
                                    Create Project
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Project Stats Detail Modal -->
            <div id="project-stats-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
                <div class="bg-white rounded-xl shadow-2xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                    <div class="p-6 border-b border-gray-200">
                        <div class="flex items-center justify-between">
                            <h2 id="stats-modal-title" class="text-xl font-bold text-gray-900">Project Statistics</h2>
                            <button onclick="closeModal('project-stats-modal')" class="text-gray-500 hover:text-gray-700">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div id="stats-modal-content" class="p-6">
                        <!-- Dynamic content will be inserted here -->
                    </div>
                </div>
            </div>

            <!-- Supplier Details Modal -->
            <div id="supplier-details-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
                <div class="bg-white rounded-xl shadow-2xl max-w-5xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                    <div class="p-6 border-b border-gray-200">
                        <div class="flex items-center justify-between">
                            <h2 id="supplier-modal-title" class="text-xl font-bold text-gray-900">Supplier Details</h2>
                            <button onclick="closeModal('supplier-details-modal')" class="text-gray-500 hover:text-gray-700">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div id="supplier-modal-content" class="p-6">
                        <!-- Dynamic content will be inserted here -->
                    </div>
                </div>
            </div>

            <!-- Add Supplier Modal -->
            <div id="add-supplier-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
                <div class="bg-white rounded-xl shadow-2xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                    <div class="p-6 border-b border-gray-200">
                        <div class="flex items-center justify-between">
                            <h2 class="text-xl font-bold text-gray-900">Add New Supplier</h2>
                            <button onclick="closeModal('add-supplier-modal')" class="text-gray-500 hover:text-gray-700">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="p-6">
                        <form id="add-supplier-form" onsubmit="submitSupplier(event)">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                <div>
                                    <label for="supplier-name" class="block text-sm font-medium text-gray-700 mb-2">Company Name *</label>
                                    <input type="text" id="supplier-name" name="supplier-name" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                <div>
                                    <label for="supplier-category" class="block text-sm font-medium text-gray-700 mb-2">Category *</label>
                                    <select id="supplier-category" name="supplier-category" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
                                        <option value="">Select category...</option>
                                        <option value="Manufacturing">Manufacturing</option>
                                        <option value="Technology">Technology</option>
                                        <option value="Services">Services</option>
                                        <option value="Logistics">Logistics</option>
                                        <option value="Raw Materials">Raw Materials</option>
                                    </select>
                                </div>
                                <div>
                                    <label for="supplier-location" class="block text-sm font-medium text-gray-700 mb-2">Location *</label>
                                    <input type="text" id="supplier-location" name="supplier-location" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500" placeholder="City, State/Country">
                                </div>
                                <div>
                                    <label for="supplier-contact" class="block text-sm font-medium text-gray-700 mb-2">Primary Contact *</label>
                                    <input type="email" id="supplier-contact" name="supplier-contact" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500" placeholder="contact@supplier.com">
                                </div>
                                <div>
                                    <label for="supplier-phone" class="block text-sm font-medium text-gray-700 mb-2">Phone</label>
                                    <input type="tel" id="supplier-phone" name="supplier-phone" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                <div>
                                    <label for="supplier-website" class="block text-sm font-medium text-gray-700 mb-2">Website</label>
                                    <input type="url" id="supplier-website" name="supplier-website" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500" placeholder="https://supplier.com">
                                </div>
                            </div>
                            
                            <div class="mb-6">
                                <label for="supplier-description" class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                                <textarea id="supplier-description" name="supplier-description" rows="3" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Brief description of supplier capabilities..."></textarea>
                            </div>

                            <!-- AI Automation Section -->
                            <div class="bg-purple-50 border border-purple-200 rounded-lg p-6 mb-6">
                                <div class="flex items-center justify-between mb-4">
                                    <div>
                                        <h3 class="text-lg font-medium text-purple-900">SynqBot AI Automation</h3>
                                        <p class="text-sm text-purple-600">Let AI help you gather supplier information automatically</p>
                                    </div>
                                    <button type="button" onclick="automateSupplierInfo()" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 font-medium transition-colors">
                                        🤖 Auto-Fill with AI
                                    </button>
                                </div>
                                <div id="ai-automation-status" class="hidden">
                                    <div class="flex items-center text-purple-600 mb-2">
                                        <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-purple-600 mr-2"></div>
                                        <span class="text-sm">SynqBot is gathering supplier information...</span>
                                    </div>
                                </div>
                                <div id="ai-suggestions" class="space-y-2">
                                    <p class="text-sm text-gray-600">AI will automatically research and populate supplier details based on company name and website.</p>
                                </div>
                            </div>

                            <div class="flex space-x-4">
                                <button type="submit" class="flex-1 bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 font-medium transition-colors">
                                    Add Supplier
                                </button>
                                <button type="button" onclick="closeModal('add-supplier-modal')" class="px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium transition-colors">
                                    Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Supplier Profile Modal -->
            <div id="supplier-profile-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
                <div class="bg-white rounded-xl shadow-2xl max-w-6xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                    <div class="p-6 border-b border-gray-200">
                        <div class="flex items-center justify-between">
                            <h2 id="supplier-profile-title" class="text-xl font-bold text-gray-900">Supplier Profile</h2>
                            <button onclick="closeModal('supplier-profile-modal')" class="text-gray-500 hover:text-gray-700">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div id="supplier-profile-content" class="p-6">
                        <!-- Dynamic content will be inserted here -->
                    </div>
                </div>
            </div>

            <!-- PO Management -->
            <div id="po-content" class="content-page">
                <div class="p-8">
                    <!-- Header -->
                    <div class="flex items-center justify-between mb-8">
                        <div>
                            <h1 class="text-3xl font-bold text-gray-900">Purchase Order Management</h1>
                            <p class="text-gray-600">Comprehensive PO management with integrated approvals</p>
                        </div>
                        <div class="flex space-x-3">
                            <button onclick="exportPOs()" class="bg-white text-gray-700 px-4 py-2 rounded-lg border border-gray-300 hover:bg-gray-50 font-medium transition-colors">
                                📊 Export CSV
                            </button>
                            <button onclick="showCreatePOWizard()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 font-medium transition-colors">
                                + New Purchase Order
                            </button>
                        </div>
                    </div>

                    <!-- Tabs Navigation -->
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 mb-6">
                        <div class="px-6 py-4 border-b border-gray-200">
                            <nav class="flex space-x-8">
                                <button onclick="switchPOTab('order-management')" id="tab-order-management" class="po-tab-button whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm transition-colors border-blue-500 text-blue-600">
                                    Order Management Hub
                                </button>
                                <button onclick="switchPOTab('approvals')" id="tab-approvals" class="po-tab-button whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm transition-colors border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300">
                                    Approvals
                                    <span class="ml-2 bg-red-100 text-red-800 text-xs font-medium px-2 py-0.5 rounded-full">5</span>
                                </button>
                                <button onclick="switchPOTab('supplier-updates')" id="tab-supplier-updates" class="po-tab-button whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm transition-colors border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300">
                                    Supplier Updates
                                    <span class="ml-2 bg-orange-100 text-orange-800 text-xs font-medium px-2 py-0.5 rounded-full">3</span>
                                </button>
                                <button onclick="switchPOTab('history')" id="tab-history" class="po-tab-button whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm transition-colors border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300">
                                    History
                                </button>
                                <button onclick="switchPOTab('ai-automation')" id="tab-ai-automation" class="po-tab-button whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm transition-colors border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300">
                                    AI & Automation
                                    <span class="ml-2 bg-gradient-to-r from-purple-100 to-blue-100 text-purple-800 text-xs font-medium px-2 py-0.5 rounded-full">New</span>
                                </button>
                            </nav>
                        </div>
                    </div>

                    <!-- Tab Content Container -->
                    <div id="po-tab-content">
                        <!-- Order Management Hub Tab -->
                        <div id="po-tab-order-management" class="po-tab-content active">
                    <!-- PO Stats -->
                    <div class="grid grid-cols-1 md:grid-cols-5 gap-6 mb-8">
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <div class="flex items-center">
                                        <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                            <span class="text-blue-600 text-xl">📋</span>
                                        </div>
                                        <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">Total POs</p>
                                    <p class="text-2xl font-semibold text-gray-900">47</p>
                                            <p class="text-xs text-blue-600">+3 this week</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <div class="flex items-center">
                                        <div class="w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center">
                                            <span class="text-yellow-600 text-xl">⏳</span>
                                        </div>
                                        <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">Pending Approval</p>
                                    <p class="text-2xl font-semibold text-gray-900">5</p>
                                            <p class="text-xs text-yellow-600">2 urgent</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <div class="flex items-center">
                                        <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                                            <span class="text-purple-600 text-xl">🚚</span>
                                        </div>
                                        <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">In Transit</p>
                                    <p class="text-2xl font-semibold text-gray-900">12</p>
                                            <p class="text-xs text-purple-600">4 arriving this week</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <div class="flex items-center">
                                        <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                                            <span class="text-green-600 text-xl">✅</span>
                                        </div>
                                        <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">Delivered</p>
                                    <p class="text-2xl font-semibold text-gray-900">28</p>
                                            <p class="text-xs text-green-600">98% on-time</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <div class="flex items-center">
                                        <div class="w-12 h-12 bg-indigo-100 rounded-lg flex items-center justify-center">
                                            <span class="text-indigo-600 text-xl">💰</span>
                                        </div>
                                        <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">Total Value</p>
                                    <p class="text-2xl font-semibold text-gray-900">$1.2M</p>
                                            <p class="text-xs text-indigo-600">8% under budget</p>
                                </div>
                            </div>
                        </div>
                    </div>

                                                        <!-- Combined Top Section - 50/50 Split -->
                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                                <!-- Quick Actions - Left Side (Collapsible) -->
                                <div class="bg-white rounded-xl shadow-sm border border-gray-200">
                                    <button onclick="toggleQuickActions()" class="w-full px-6 py-4 flex items-center justify-between text-left hover:bg-gray-50 transition-colors">
                                        <div class="flex items-center space-x-3">
                                            <div class="w-10 h-10 bg-gradient-to-r from-orange-500 to-red-600 rounded-lg flex items-center justify-center">
                                                <span class="text-white text-lg font-bold">⚡</span>
                                            </div>
                                            <div>
                                                <h3 class="text-lg font-semibold text-gray-900">Quick Actions</h3>
                                                <p class="text-sm text-gray-600">Approvals, updates & new POs</p>
                                            </div>
                                        </div>
                                        <div class="flex items-center space-x-4">
                                            <div class="text-right">
                                                <div class="text-lg font-bold text-red-600">5</div>
                                                <div class="text-xs text-gray-500">Pending Approvals</div>
                                            </div>
                                            <div class="text-right">
                                                <div class="text-lg font-bold text-orange-600">3</div>
                                                <div class="text-xs text-gray-500">Supplier Updates</div>
                                            </div>
                                            <svg id="quick-actions-chevron" class="w-5 h-5 text-gray-400 transition-transform transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                            </svg>
                                        </div>
                                    </button>
                                    
                                    <div id="quick-actions-content" class="hidden border-t border-gray-200">
                                        <div class="p-4">
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                                <button onclick="switchPOTab('approvals')" class="bg-red-50 hover:bg-red-100 border border-red-200 rounded-lg p-3 text-left transition-colors">
                                                    <div class="text-red-600 text-xl mb-1">⚠️</div>
                                                    <div class="text-sm font-medium text-red-800">5 Pending Approvals</div>
                                                    <div class="text-xs text-red-600">2 high priority</div>
                                                </button>
                                                <button onclick="switchPOTab('supplier-updates')" class="bg-orange-50 hover:bg-orange-100 border border-orange-200 rounded-lg p-3 text-left transition-colors">
                                                    <div class="text-orange-600 text-xl mb-1">📝</div>
                                                    <div class="text-sm font-medium text-orange-800">3 Supplier Updates</div>
                                                    <div class="text-xs text-orange-600">Requests pending review</div>
                                                </button>
                                                <button onclick="showCreatePOWizard()" class="bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded-lg p-3 text-left transition-colors">
                                                    <div class="text-blue-600 text-xl mb-1">➕</div>
                                                    <div class="text-sm font-medium text-blue-800">Create New PO</div>
                                                    <div class="text-xs text-blue-600">Start purchase process</div>
                                                </button>
                                                <button onclick="exportPOs()" class="bg-gray-50 hover:bg-gray-100 border border-gray-200 rounded-lg p-3 text-left transition-colors">
                                                    <div class="text-gray-600 text-xl mb-1">📊</div>
                                                    <div class="text-sm font-medium text-gray-800">Export Reports</div>
                                                    <div class="text-xs text-gray-600">Download CSV data</div>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Sync'd Impact - Right Side (Collapsible) -->
                                <div class="bg-white rounded-xl shadow-sm border border-gray-200">
                                <button onclick="toggleSyncdImpact()" class="w-full px-6 py-4 flex items-center justify-between text-left hover:bg-gray-50 transition-colors">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg flex items-center justify-center">
                                            <span class="text-white text-lg font-bold">✨</span>
                                        </div>
                                        <div>
                                            <h3 class="text-lg font-semibold text-gray-900">Sync'd Platform Impact</h3>
                                            <p class="text-sm text-gray-600">View performance improvements & savings achieved</p>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-4">
                                        <div class="text-right">
                                            <div class="text-lg font-bold text-green-600" id="po-impact-savings">$12,395</div>
                                            <div class="text-xs text-gray-500">YTD Savings</div>
                                        </div>
                                        <div class="text-right">
                                            <div class="text-lg font-bold text-blue-600">94%</div>
                                            <div class="text-xs text-gray-500">On-Time Delivery</div>
                                        </div>
                                        <svg id="syncd-impact-chevron" class="w-5 h-5 text-gray-400 transition-transform transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                        </svg>
                                    </div>
                                </button>
                                
                                <div id="syncd-impact-content" class="hidden border-t border-gray-200">
                                    <div class="p-6">
                                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                                            <div class="bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-xl p-4">
                                                <div class="flex items-center justify-between mb-3">
                                                    <h4 class="text-md font-medium text-green-800">On-Time Delivery</h4>
                                                    <span class="text-green-600 text-xl">🎯</span>
                                                </div>
                                                <div class="space-y-2">
                                                    <div class="flex justify-between items-center text-sm">
                                                        <span class="text-green-700">Before Sync'd</span>
                                                        <span class="font-medium text-green-900">78%</span>
                                                    </div>
                                                    <div class="w-full bg-green-200 rounded-full h-2">
                                                        <div class="bg-green-400 h-2 rounded-full" style="width: 78%"></div>
                                                    </div>
                                                    <div class="flex justify-between items-center text-sm">
                                                        <span class="text-green-700">With Sync'd</span>
                                                        <span class="font-medium text-green-900">94%</span>
                                                    </div>
                                                    <div class="w-full bg-green-200 rounded-full h-2">
                                                        <div class="bg-green-600 h-2 rounded-full" style="width: 94%"></div>
                                                    </div>
                                                    <div class="text-center">
                                                        <span class="text-green-800 font-bold">+16% Improvement</span>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-200 rounded-xl p-4">
                                                <div class="flex items-center justify-between mb-3">
                                                    <h4 class="text-md font-medium text-blue-800">Platform Savings</h4>
                                                    <span class="text-blue-600 text-xl">💰</span>
                                                </div>
                                                <div class="space-y-2">
                                                    <div class="text-center">
                                                        <div class="text-xl font-bold text-blue-900" id="po-detailed-savings">$12,395</div>
                                                        <div class="text-sm text-blue-700">Total Savings YTD</div>
                                                    </div>
                                                    <div class="grid grid-cols-2 gap-2 text-xs">
                                                        <div class="bg-blue-100 rounded p-2 text-center">
                                                            <div class="font-medium text-blue-800" id="po-process-auto">$6,200</div>
                                                            <div class="text-blue-600">Process Auto</div>
                                                        </div>
                                                        <div class="bg-blue-100 rounded p-2 text-center">
                                                            <div class="font-medium text-blue-800" id="po-supplier-mgmt">$3,725</div>
                                                            <div class="text-blue-600">Supplier Mgmt</div>
                                                        </div>
                                                        <div class="bg-blue-100 rounded p-2 text-center">
                                                            <div class="font-medium text-blue-800" id="po-contract-opt">$1,680</div>
                                                            <div class="text-blue-600">Contract Opt</div>
                                                        </div>
                                                        <div class="bg-blue-100 rounded p-2 text-center">
                                                            <div class="font-medium text-blue-800" id="po-data-analytics">$790</div>
                                                            <div class="text-blue-600">Data Analytics</div>
                                                        </div>
                                                    </div>
                                                    <div class="text-center">
                                                        <span class="text-blue-800 font-medium text-sm" id="po-daily-avg">+$18/day avg</span>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="bg-gradient-to-r from-purple-50 to-indigo-50 border border-purple-200 rounded-xl p-4">
                                                <div class="flex items-center justify-between mb-3">
                                                    <h4 class="text-md font-medium text-purple-800">Automation Impact</h4>
                                                    <span class="text-purple-600 text-xl">🔄</span>
                                                </div>
                                                <div class="space-y-2">
                                                    <div class="text-center">
                                                        <div class="text-xl font-bold text-purple-900">87%</div>
                                                        <div class="text-sm text-purple-700">Automation Rate</div>
                                                    </div>
                                                    <div class="grid grid-cols-2 gap-2 text-xs">
                                                        <div class="bg-purple-100 rounded p-2 text-center">
                                                            <div class="font-medium text-purple-800">Before: 23</div>
                                                            <div class="text-purple-600">touchpoints/PO</div>
                                                        </div>
                                                        <div class="bg-purple-100 rounded p-2 text-center">
                                                            <div class="font-medium text-purple-800">Now: 3</div>
                                                            <div class="text-purple-600">touchpoints/PO</div>
                                                        </div>
                                                    </div>
                                                    <div class="text-center">
                                                        <span class="text-purple-800 font-bold text-sm">87% Reduction</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="mt-4 pt-4 border-t border-gray-200">
                                            <div class="flex items-center justify-between text-sm text-gray-600">
                                                <span>🚀 Real-time supplier responsiveness: 2.3 hours avg (vs 2.8 days before)</span>
                                                <span>⚡ 29x faster communication with automated notifications</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                </div>
                            </div>

                            <!-- Filters and Search -->
                            <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-4 mb-6">
                                <div class="flex flex-wrap gap-4 items-center">
                                    <div class="flex-1 min-w-64">
                                        <input type="text" id="po-search" placeholder="Search PO numbers, suppliers, items, or part numbers..." 
                                               onkeyup="applyAllPOFilters()" 
                                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <select id="po-open-closed-filter" onchange="applyAllPOFilters()" class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                        <option value="open">Open POs</option>
                                        <option value="closed">Closed POs</option>
                                        <option value="all">All POs</option>
                                    </select>
                                    <select id="po-status-filter" onchange="applyAllPOFilters()" class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                        <option value="">All Statuses</option>
                                        <option value="draft">Draft</option>
                                        <option value="pending-approval">Pending Approval</option>
                                        <option value="approved">Approved</option>
                                        <option value="in-fulfillment">In Fulfillment</option>
                                        <option value="shipped">Shipped</option>
                                        <option value="delivered">Delivered</option>
                                        <option value="completed">Completed</option>
                                    </select>
                                    <select id="po-supplier-filter" onchange="applyAllPOFilters()" class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                        <option value="">All Suppliers</option>
                                        <option value="Industrial Solutions Inc">Industrial Solutions Inc</option>
                                        <option value="TechSource Global">TechSource Global</option>
                                        <option value="European Logistics Ltd">European Logistics Ltd</option>
                                        <option value="Nordic Energy Systems">Nordic Energy Systems</option>
                                        <option value="MedEquip Solutions">MedEquip Solutions</option>
                                        <option value="Alpine Manufacturing">Alpine Manufacturing</option>
                                        <option value="Global Office Supplies">Global Office Supplies</option>
                                        <option value="Pacific Components">Pacific Components</option>
                                        <option value="Sunshine Chemicals">Sunshine Chemicals</option>
                                        <option value="Eastern Transport Co">Eastern Transport Co</option>
                                    </select>
                                    <select id="po-priority-filter" onchange="applyAllPOFilters()" class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                        <option value="">All Priorities</option>
                                        <option value="urgent">Urgent</option>
                                        <option value="high">High</option>
                                        <option value="standard">Standard</option>
                                        <option value="low">Low</option>
                                    </select>
                                    <button onclick="resetAllPOFilters()" class="bg-gray-100 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-200 transition-colors">
                                        🔄 Reset
                                    </button>
                                    <button onclick="exportFilteredPOs()" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors">
                                        📊 Export Filtered
                                    </button>
                                </div>
                            </div>

                            <!-- Purchase Orders Table -->
                            <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
                                <div class="px-6 py-4 border-b border-gray-200">
                                    <div class="flex items-center justify-between">
                                        <h3 class="text-lg font-medium text-gray-900">Purchase Orders</h3>
                                        <div class="flex items-center space-x-2">
                                            <span id="po-count-display" class="text-sm text-gray-600">Showing 335 purchase orders</span>
                                            <button onclick="togglePOTableView()" class="text-gray-400 hover:text-gray-600">
                                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Live Subtotals Section -->
                                <div class="px-6 py-4 bg-gray-50 border-b border-gray-200">
                                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                        <div class="flex items-center space-x-3">
                                            <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                                                <span class="text-blue-600 text-lg font-bold">#</span>
                                            </div>
                                            <div>
                                                <p class="text-sm font-medium text-gray-500">Total POs</p>
                                                <p class="text-xl font-bold text-gray-900" id="total-po-count">335</p>
                                            </div>
                                        </div>
                                        <div class="flex items-center space-x-3">
                                            <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center">
                                                <span class="text-green-600 text-lg font-bold">$</span>
                                            </div>
                                            <div>
                                                <p class="text-sm font-medium text-gray-500">Total Value</p>
                                                <p class="text-xl font-bold text-gray-900" id="total-po-value">$2.4M</p>
                                            </div>
                                        </div>
                                        <div class="flex items-center space-x-3">
                                            <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center">
                                                <span class="text-purple-600 text-lg font-bold">📊</span>
                                            </div>
                                            <div>
                                                <p class="text-sm font-medium text-gray-500">Avg PO Value</p>
                                                <p class="text-xl font-bold text-gray-900" id="avg-po-value">$7,164</p>
                                            </div>
                                        </div>
                                        <div class="flex items-center space-x-3">
                                            <div class="w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center">
                                                <span class="text-orange-600 text-lg font-bold">💰</span>
                                            </div>
                                            <div>
                                                <p class="text-sm font-medium text-gray-500">Total Savings</p>
                                                <p class="text-xl font-bold text-gray-900" id="total-savings-display">$12,395</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="overflow-x-auto">
                                    <table class="min-w-full divide-y divide-gray-200">
                                        <thead class="bg-gray-50">
                                            <tr>
                                                <th class="w-8 px-3 py-3 text-left">
                                                    <input type="checkbox" id="select-all-pos" onchange="toggleAllPOs()" class="rounded border-gray-300">
                                                </th>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Flags</th>
                                                <th onclick="sortPOTable('poNumber')" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100">
                                                    PO Number <span id="sort-poNumber" class="text-gray-400">↕</span>
                                                </th>
                                                <th onclick="sortPOTable('vendor')" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100">
                                                    Vendor <span id="sort-vendor" class="text-gray-400">↕</span>
                                                </th>
                                                <th onclick="sortPOTable('partNumber')" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100">
                                                    Part Number <span id="sort-partNumber" class="text-gray-400">↕</span>
                                                </th>
                                                <th onclick="sortPOTable('total')" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100">
                                                    Total <span id="sort-total" class="text-gray-400">↕</span>
                                                </th>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                                <th onclick="sortPOTable('dueDate')" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100">
                                                    Due Date <span id="sort-dueDate" class="text-gray-400">↕</span>
                                                </th>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ERP Sync</th>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="po-table-body" class="bg-white divide-y divide-gray-200">
                                            <!-- Dynamic content will be populated by JavaScript -->
                                        </tbody>
                                    </table>
                                </div>
                                
                                <!-- Pagination Controls -->
                                <div class="px-6 py-4 border-t border-gray-200 bg-white">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center space-x-4">
                                            <span class="text-sm text-gray-700">
                                                Showing <span id="pagination-start">1</span> to <span id="pagination-end">50</span> of <span id="pagination-total">335</span> results
                                            </span>
                                            <div class="flex items-center space-x-2">
                                                <label class="text-sm text-gray-600">Show:</label>
                                                <select id="page-size-selector" onchange="changePageSize()" class="px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                                    <option value="25">25 per page</option>
                                                    <option value="50" selected>50 per page</option>
                                                    <option value="100">100 per page</option>
                                                    <option value="250">250 per page</option>
                                                    <option value="all">Show all</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="flex items-center space-x-2">
                                            <button id="prev-page" onclick="previousPage()" class="px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed">
                                                Previous
                                            </button>
                                            <div id="page-numbers" class="flex items-center space-x-1">
                                                <!-- Page numbers will be generated by JavaScript -->
                                            </div>
                                            <button id="next-page" onclick="nextPage()" class="px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed">
                                                Next
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- PO Profile Modal -->
                        <div id="po-profile-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
                            <div class="bg-white rounded-xl shadow-xl max-w-6xl w-full max-h-full overflow-y-auto">
                                <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between">
                                    <div>
                                        <h3 id="po-modal-title" class="text-lg font-semibold text-gray-900">Purchase Order Details</h3>
                                        <p id="po-modal-subtitle" class="text-sm text-gray-600">Loading...</p>
                                    </div>
                                    <button onclick="closePOModal()" class="text-gray-400 hover:text-gray-600">
                                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                        </svg>
                                    </button>
                                </div>
                                <div id="po-modal-content" class="p-6">
                                    <!-- Dynamic content will be populated here -->
                                </div>
                            </div>
                        </div>

                        <!-- Change Request Modal -->
                        <div id="change-request-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
                            <div class="bg-white rounded-xl shadow-xl max-w-4xl w-full max-h-full overflow-y-auto">
                                <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between">
                                    <div>
                                        <h3 class="text-lg font-semibold text-gray-900">Request Change to Supplier</h3>
                                        <p id="change-request-subtitle" class="text-sm text-gray-600">Submit a change request</p>
                                    </div>
                                    <button onclick="closeChangeRequestModal()" class="text-gray-400 hover:text-gray-600">
                                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                        </svg>
                                    </button>
                                </div>
                                <div id="change-request-content" class="p-6">
                                    <!-- Dynamic content will be populated here -->
                                </div>
                            </div>
                        </div>

                        <!-- Approvals Tab -->
                        <div id="po-tab-approvals" class="po-tab-content hidden">
                            <!-- Approval Queue Summary -->
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                                <div class="bg-red-50 border border-red-200 rounded-xl p-6">
                                    <div class="flex items-center">
                                        <div class="w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center">
                                            <span class="text-red-600 text-xl">🚨</span>
                                        </div>
                                        <div class="ml-4">
                                            <p class="text-sm font-medium text-red-700">Urgent Approvals</p>
                                            <p class="text-2xl font-semibold text-red-900">2</p>
                                            <p class="text-xs text-red-600">Overdue by 1+ days</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="bg-yellow-50 border border-yellow-200 rounded-xl p-6">
                                    <div class="flex items-center">
                                        <div class="w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center">
                                            <span class="text-yellow-600 text-xl">⏰</span>
                                        </div>
                                        <div class="ml-4">
                                            <p class="text-sm font-medium text-yellow-700">High Priority</p>
                                            <p class="text-2xl font-semibold text-yellow-900">3</p>
                                            <p class="text-xs text-yellow-600">Due within 24hrs</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="bg-blue-50 border border-blue-200 rounded-xl p-6">
                                    <div class="flex items-center">
                                        <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                            <span class="text-blue-600 text-xl">📋</span>
                                        </div>
                                        <div class="ml-4">
                                            <p class="text-sm font-medium text-blue-700">Standard Queue</p>
                                            <p class="text-2xl font-semibold text-blue-900">0</p>
                                            <p class="text-xs text-blue-600">Normal processing</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="bg-green-50 border border-green-200 rounded-xl p-6">
                                    <div class="flex items-center">
                                        <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                                            <span class="text-green-600 text-xl">✅</span>
                                        </div>
                                        <div class="ml-4">
                                            <p class="text-sm font-medium text-green-700">Approved Today</p>
                                            <p class="text-2xl font-semibold text-green-900">8</p>
                                            <p class="text-xs text-green-600">Average time: 2.1hrs</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Approval Categories -->
                            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                                <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                                    <h4 class="text-lg font-medium text-gray-900 mb-4">Budget Approvals</h4>
                                    <div class="space-y-3">
                                        <div class="flex justify-between items-center p-3 bg-red-50 rounded-lg border border-red-200">
                                            <div>
                                                <div class="font-medium text-red-800">PO-2024-058</div>
                                                <div class="text-sm text-red-600">$127,500 - Budget Exceeded</div>
                                            </div>
                                            <span class="bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full">Urgent</span>
                                        </div>
                                        <div class="flex justify-between items-center p-3 bg-yellow-50 rounded-lg border border-yellow-200">
                                            <div>
                                                <div class="font-medium text-yellow-800">PO-2024-054</div>
                                                <div class="text-sm text-yellow-600">$89,200 - Requires CFO</div>
                                            </div>
                                            <span class="bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded-full">High</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                                    <h4 class="text-lg font-medium text-gray-900 mb-4">Compliance Reviews</h4>
                                    <div class="space-y-3">
                                        <div class="flex justify-between items-center p-3 bg-purple-50 rounded-lg border border-purple-200">
                                            <div>
                                                <div class="font-medium text-purple-800">PO-2024-055</div>
                                                <div class="text-sm text-purple-600">New Supplier Vetting</div>
                                            </div>
                                            <span class="bg-purple-100 text-purple-800 text-xs px-2 py-1 rounded-full">Review</span>
                                        </div>
                                        <div class="flex justify-between items-center p-3 bg-orange-50 rounded-lg border border-orange-200">
                                            <div>
                                                <div class="font-medium text-orange-800">PO-2024-052</div>
                                                <div class="text-sm text-orange-600">Contract Terms Modified</div>
                                            </div>
                                            <span class="bg-orange-100 text-orange-800 text-xs px-2 py-1 rounded-full">High</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                                    <h4 class="text-lg font-medium text-gray-900 mb-4">Emergency Orders</h4>
                                    <div class="space-y-3">
                                        <div class="flex justify-between items-center p-3 bg-red-50 rounded-lg border border-red-200">
                                            <div>
                                                <div class="font-medium text-red-800">PO-2024-059</div>
                                                <div class="text-sm text-red-600">Production Line Down</div>
                                            </div>
                                            <span class="bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full">ASAP</span>
                                        </div>
                                        <div class="text-center p-4 text-gray-500">
                                            <div class="text-sm">No other emergency orders</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Detailed Approval Queue -->
                            <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
                                <div class="px-6 py-4 border-b border-gray-200">
                                    <div class="flex items-center justify-between">
                                        <h3 class="text-lg font-medium text-gray-900">Approval Queue</h3>
                                        <div class="flex items-center space-x-2">
                                            <button onclick="bulkApproveSelected()" id="bulk-approve-btn" disabled class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
                                                ✅ Bulk Approve
                                            </button>
                                            <button onclick="exportApprovalQueue()" class="bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 font-medium transition-colors">
                                                📊 Export Queue
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="divide-y divide-gray-200" id="approval-queue">
                                    <!-- Dynamic approval items will be populated here -->
                                </div>
                            </div>
                        </div>

                                                <!-- Supplier Updates Tab -->
                        <div id="po-tab-supplier-updates" class="po-tab-content hidden">
                            <div class="space-y-6">
                                <!-- Update Request Summary -->
                                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                                    <div class="bg-blue-50 border border-blue-200 rounded-xl p-6">
                                        <div class="flex items-center">
                                            <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                                <span class="text-blue-600 text-xl">📅</span>
                                            </div>
                                            <div class="ml-4">
                                                <p class="text-sm font-medium text-blue-700">Date Changes</p>
                                                <p class="text-2xl font-semibold text-blue-900">2</p>
                                                <p class="text-xs text-blue-600">Avg delay: 5 days</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-green-50 border border-green-200 rounded-xl p-6">
                                        <div class="flex items-center">
                                            <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                                                <span class="text-green-600 text-xl">💰</span>
                                            </div>
                                            <div class="ml-4">
                                                <p class="text-sm font-medium text-green-700">Price Adjustments</p>
                                                <p class="text-2xl font-semibold text-green-900">1</p>
                                                <p class="text-xs text-green-600">+2.3% increase</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-purple-50 border border-purple-200 rounded-xl p-6">
                                        <div class="flex items-center">
                                            <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                                                <span class="text-purple-600 text-xl">📦</span>
                                            </div>
                                            <div class="ml-4">
                                                <p class="text-sm font-medium text-purple-700">Quantity Splits</p>
                                                <p class="text-2xl font-semibold text-purple-900">0</p>
                                                <p class="text-xs text-purple-600">No pending</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-orange-50 border border-orange-200 rounded-xl p-6">
                                        <div class="flex items-center">
                                            <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center">
                                                <span class="text-orange-600 text-xl">🔄</span>
                                            </div>
                                            <div class="ml-4">
                                                <p class="text-sm font-medium text-orange-700">Other Changes</p>
                                                <p class="text-2xl font-semibold text-orange-900">0</p>
                                                <p class="text-xs text-orange-600">Shipping, terms, etc.</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Update Requests -->
                                <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
                                    <div class="px-6 py-4 border-b border-gray-200">
                                        <div class="flex items-center justify-between">
                                            <h3 class="text-lg font-medium text-gray-900">Supplier Update Requests</h3>
                                            <div class="flex items-center space-x-2">
                                                <button onclick="bulkApproveUpdates()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 font-medium transition-colors">
                                                    ✅ Bulk Approve
                                                </button>
                                                <button onclick="exportUpdateRequests()" class="bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 font-medium transition-colors">
                                                    📊 Export
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="divide-y divide-gray-200">
                                        <!-- Date Change Request -->
                                        <div class="p-6">
                                            <div class="flex items-start justify-between">
                                                <div class="flex-1">
                                                    <div class="flex items-center space-x-3 mb-3">
                                                        <span class="text-blue-600 text-xl">📅</span>
                                                        <div>
                                                            <h4 class="text-lg font-medium text-gray-900">Delivery Date Change Request</h4>
                                                            <p class="text-sm text-gray-600">PO-2024-048 • TechSource Global</p>
                                                        </div>
                                                        <span class="bg-yellow-100 text-yellow-800 text-xs font-medium px-2 py-1 rounded-full">High Priority</span>
                                                    </div>
                                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                                        <div class="bg-red-50 border border-red-200 rounded-lg p-3">
                                                            <div class="text-sm font-medium text-red-800">Current Delivery</div>
                                                            <div class="text-red-900">March 25, 2024</div>
                                                            <div class="text-xs text-red-600">Committed date</div>
                                                        </div>
                                                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-3">
                                                            <div class="text-sm font-medium text-blue-800">Requested Change</div>
                                                            <div class="text-blue-900">April 2, 2024</div>
                                                            <div class="text-xs text-blue-600">+8 days delay</div>
                                                        </div>
                                                    </div>
                                                    <div class="bg-gray-50 rounded-lg p-3 mb-4">
                                                        <div class="text-sm font-medium text-gray-800 mb-1">Supplier Reason:</div>
                                                        <div class="text-sm text-gray-700">"Supply chain disruption due to raw material shortage. New shipment arriving March 28th, allowing us to complete production by April 1st."</div>
                                                    </div>
                                                    <div class="flex items-center space-x-4 text-xs text-gray-500">
                                                        <span>Requested: 2 hours ago</span>
                                                        <span>Impact: Low - Buffer time available</span>
                                                        <span>Auto-approval: Not eligible (>5 days)</span>
                                                    </div>
                                                </div>
                                                <div class="flex flex-col space-y-2 ml-4">
                                                    <button onclick="approveSupplierUpdate('PO-2024-048', 'date-change')" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 font-medium transition-colors text-sm">
                                                        ✅ Approve
                                                    </button>
                                                    <button onclick="rejectSupplierUpdate('PO-2024-048', 'date-change')" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 font-medium transition-colors text-sm">
                                                        ❌ Reject
                                                    </button>
                                                    <button onclick="negotiateSupplierUpdate('PO-2024-048', 'date-change')" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 font-medium transition-colors text-sm">
                                                        💬 Negotiate
                                                    </button>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Price Adjustment Request -->
                                        <div class="p-6">
                                            <div class="flex items-start justify-between">
                                                <div class="flex-1">
                                                    <div class="flex items-center space-x-3 mb-3">
                                                        <span class="text-green-600 text-xl">💰</span>
                                                        <div>
                                                            <h4 class="text-lg font-medium text-gray-900">Price Adjustment Request</h4>
                                                            <p class="text-sm text-gray-600">PO-2024-051 • Nordic Energy Systems</p>
                                                        </div>
                                                        <span class="bg-orange-100 text-orange-800 text-xs font-medium px-2 py-1 rounded-full">Standard</span>
                                                    </div>
                                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                                        <div class="bg-gray-50 border border-gray-200 rounded-lg p-3">
                                                            <div class="text-sm font-medium text-gray-800">Current Price</div>
                                                            <div class="text-gray-900">$125,000.00</div>
                                                            <div class="text-xs text-gray-600">Contracted rate</div>
                                                        </div>
                                                        <div class="bg-orange-50 border border-orange-200 rounded-lg p-3">
                                                            <div class="text-sm font-medium text-orange-800">Requested Price</div>
                                                            <div class="text-orange-900">$127,850.00</div>
                                                            <div class="text-xs text-orange-600">+2.3% increase</div>
                                                        </div>
                                                    </div>
                                                    <div class="bg-gray-50 rounded-lg p-3 mb-4">
                                                        <div class="text-sm font-medium text-gray-800 mb-1">Supplier Justification:</div>
                                                        <div class="text-sm text-gray-700">"Raw material costs increased 3.1% due to market volatility. We're absorbing what we can but need to pass through $2,850 to maintain margins per contract terms Section 4.2."</div>
                                                    </div>
                                                    <div class="flex items-center space-x-4 text-xs text-gray-500">
                                                        <span>Requested: 1 day ago</span>
                                                        <span>Budget impact: Within tolerance (+0.3%)</span>
                                                        <span>Contract allows: Price escalation clause applies</span>
                                                    </div>
                                                </div>
                                                <div class="flex flex-col space-y-2 ml-4">
                                                    <button onclick="approveSupplierUpdate('PO-2024-051', 'price-change')" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 font-medium transition-colors text-sm">
                                                        ✅ Approve
                                                    </button>
                                                    <button onclick="rejectSupplierUpdate('PO-2024-051', 'price-change')" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 font-medium transition-colors text-sm">
                                                        ❌ Reject
                                                    </button>
                                                    <button onclick="negotiateSupplierUpdate('PO-2024-051', 'price-change')" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 font-medium transition-colors text-sm">
                                                        💬 Negotiate
                                                    </button>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Another Date Change -->
                                        <div class="p-6">
                                            <div class="flex items-start justify-between">
                                                <div class="flex-1">
                                                    <div class="flex items-center space-x-3 mb-3">
                                                        <span class="text-blue-600 text-xl">📅</span>
                                                        <div>
                                                            <h4 class="text-lg font-medium text-gray-900">Delivery Date Change Request</h4>
                                                            <p class="text-sm text-gray-600">PO-2024-053 • European Logistics Ltd</p>
                                                        </div>
                                                        <span class="bg-green-100 text-green-800 text-xs font-medium px-2 py-1 rounded-full">Low Priority</span>
                                                    </div>
                                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                                        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3">
                                                            <div class="text-sm font-medium text-yellow-800">Current Delivery</div>
                                                            <div class="text-yellow-900">April 15, 2024</div>
                                                            <div class="text-xs text-yellow-600">Scheduled date</div>
                                                        </div>
                                                        <div class="bg-green-50 border border-green-200 rounded-lg p-3">
                                                            <div class="text-sm font-medium text-green-800">Requested Change</div>
                                                            <div class="text-green-900">April 12, 2024</div>
                                                            <div class="text-xs text-green-600">3 days earlier</div>
                                                        </div>
                                                    </div>
                                                    <div class="bg-gray-50 rounded-lg p-3 mb-4">
                                                        <div class="text-sm font-medium text-gray-800 mb-1">Supplier Reason:</div>
                                                        <div class="text-sm text-gray-700">"Production completed ahead of schedule. Can ship 3 days early to help with your project timeline."</div>
                                                    </div>
                                                    <div class="flex items-center space-x-4 text-xs text-gray-500">
                                                        <span>Requested: 3 hours ago</span>
                                                        <span>Impact: Positive - Early delivery</span>
                                                        <span>Auto-approval: Eligible for immediate approval</span>
                                                    </div>
                                                </div>
                                                <div class="flex flex-col space-y-2 ml-4">
                                                    <button onclick="approveSupplierUpdate('PO-2024-053', 'date-change')" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 font-medium transition-colors text-sm">
                                                        ✅ Approve
                                                    </button>
                                                    <button onclick="rejectSupplierUpdate('PO-2024-053', 'date-change')" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 font-medium transition-colors text-sm">
                                                        ❌ Reject
                                                    </button>
                                                    <button onclick="autoApproveUpdate('PO-2024-053')" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 font-medium transition-colors text-sm">
                                                        🤖 Auto-Approve
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Supplier Communication Portal -->
                                <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                                    <div class="flex items-center justify-between mb-4">
                                        <h3 class="text-lg font-medium text-gray-900">Supplier Communication Portal</h3>
                                        <button onclick="openSupplierChat()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 font-medium transition-colors">
                                            💬 Open Chat Portal
                                        </button>
                                    </div>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                        <div>
                                            <h4 class="text-md font-medium text-gray-800 mb-3">Recent Communications</h4>
                                            <div class="space-y-3">
                                                <div class="flex items-center space-x-3 p-3 bg-gray-50 rounded-lg">
                                                    <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                                                    <div class="flex-1">
                                                        <div class="text-sm font-medium text-gray-900">TechSource Global</div>
                                                        <div class="text-xs text-gray-600">Delivery update request - 2 hours ago</div>
                                                    </div>
                                                </div>
                                                <div class="flex items-center space-x-3 p-3 bg-gray-50 rounded-lg">
                                                    <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                                    <div class="flex-1">
                                                        <div class="text-sm font-medium text-gray-900">Nordic Energy Systems</div>
                                                        <div class="text-xs text-gray-600">Price adjustment justification - 1 day ago</div>
                                                    </div>
                                                </div>
                                                <div class="flex items-center space-x-3 p-3 bg-gray-50 rounded-lg">
                                                    <div class="w-2 h-2 bg-purple-500 rounded-full"></div>
                                                    <div class="flex-1">
                                                        <div class="text-sm font-medium text-gray-900">European Logistics Ltd</div>
                                                        <div class="text-xs text-gray-600">Early delivery offer - 3 hours ago</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div>
                                            <h4 class="text-md font-medium text-gray-800 mb-3">Communication Stats</h4>
                                            <div class="space-y-3">
                                                <div class="flex justify-between items-center p-3 bg-blue-50 rounded-lg border border-blue-200">
                                                    <span class="text-sm text-blue-800">Average Response Time</span>
                                                    <span class="font-medium text-blue-900">2.3 hours</span>
                                                </div>
                                                <div class="flex justify-between items-center p-3 bg-green-50 rounded-lg border border-green-200">
                                                    <span class="text-sm text-green-800">Messages Today</span>
                                                    <span class="font-medium text-green-900">12</span>
                                                </div>
                                                <div class="flex justify-between items-center p-3 bg-purple-50 rounded-lg border border-purple-200">
                                                    <span class="text-sm text-purple-800">Open Conversations</span>
                                                    <span class="font-medium text-purple-900">7</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                                                <!-- History Tab -->
                        <div id="po-tab-history" class="po-tab-content hidden">
                            <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                                <h3 class="text-lg font-medium text-gray-900 mb-4">Purchase Order History</h3>
                                <p class="text-gray-600">Complete audit trail and historical data for all purchase orders.</p>
                                <!-- Content will be built in next phase -->
                            </div>
                        </div>

                        <!-- AI & Automation Tab -->
                        <div id="po-tab-ai-automation" class="po-tab-content hidden">
                            <!-- AI Overview Dashboard -->
                            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                                <div class="bg-gradient-to-r from-purple-50 to-indigo-50 border border-purple-200 rounded-xl p-6">
                                    <div class="flex items-center justify-between mb-4">
                                        <h4 class="text-lg font-medium text-purple-800">AI Automation Status</h4>
                                        <span class="text-purple-600 text-2xl">🤖</span>
                                    </div>
                                    <div class="space-y-3">
                                        <div class="text-center">
                                            <div class="text-3xl font-bold text-purple-900">87%</div>
                                            <div class="text-sm text-purple-700">Processes Automated</div>
                                        </div>
                                        <div class="w-full bg-purple-200 rounded-full h-3">
                                            <div class="bg-purple-600 h-3 rounded-full" style="width: 87%"></div>
                                        </div>
                                        <div class="text-center">
                                            <span class="text-purple-800 font-medium">Target: 95% by Q3</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-xl p-6">
                                    <div class="flex items-center justify-between mb-4">
                                        <h4 class="text-lg font-medium text-green-800">AI Decisions Today</h4>
                                        <span class="text-green-600 text-2xl">⚡</span>
                                    </div>
                                    <div class="space-y-3">
                                        <div class="grid grid-cols-2 gap-2 text-center">
                                            <div class="bg-green-100 rounded p-2">
                                                <div class="text-lg font-bold text-green-900">142</div>
                                                <div class="text-xs text-green-600">Auto-Approvals</div>
                                            </div>
                                            <div class="bg-blue-100 rounded p-2">
                                                <div class="text-lg font-bold text-blue-900">89</div>
                                                <div class="text-xs text-blue-600">Route Optimizations</div>
                                            </div>
                                        </div>
                                        <div class="text-center">
                                            <div class="text-green-800 font-medium">98.7% Accuracy</div>
                                            <div class="text-xs text-green-600">Human intervention: 1.3%</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-200 rounded-xl p-6">
                                    <div class="flex items-center justify-between mb-4">
                                        <h4 class="text-lg font-medium text-blue-800">Time Saved</h4>
                                        <span class="text-blue-600 text-2xl">⏱️</span>
                                    </div>
                                    <div class="space-y-3">
                                        <div class="text-center">
                                            <div class="text-2xl font-bold text-blue-900">23.4 hrs</div>
                                            <div class="text-sm text-blue-700">Saved Today</div>
                                        </div>
                                        <div class="text-center">
                                            <div class="text-lg font-semibold text-blue-800">847 hrs/month</div>
                                            <div class="text-sm text-blue-600">Average savings</div>
                                        </div>
                                        <div class="text-center text-xs text-blue-700">
                                            = $84,700 cost reduction
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- AI Configuration Section -->
                            <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6">
                                <div class="flex items-center justify-between mb-6">
                                    <h3 class="text-lg font-medium text-gray-900">AI & Automation Center</h3>
                                    <button onclick="openAIWizard()" class="bg-gradient-to-r from-purple-600 to-blue-600 text-white px-4 py-2 rounded-lg hover:from-purple-700 hover:to-blue-700 font-medium transition-colors">
                                        🧠 Launch AI Wizard
                                    </button>
                                </div>
                                
                                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                    <div>
                                        <h4 class="text-md font-medium text-gray-800 mb-4">Automation Features</h4>
                                        <div class="space-y-3">
                                            <div class="flex justify-between items-center p-3 bg-green-50 rounded-lg border border-green-200">
                                                <span class="text-sm text-green-800">Auto-Approval (< $25K)</span>
                                                <span class="text-sm font-medium text-green-900">100% Active</span>
                                            </div>
                                            <div class="flex justify-between items-center p-3 bg-blue-50 rounded-lg border border-blue-200">
                                                <span class="text-sm text-blue-800">Predictive Analytics</span>
                                                <span class="text-sm font-medium text-blue-900">Learning Mode</span>
                                            </div>
                                            <div class="flex justify-between items-center p-3 bg-purple-50 rounded-lg border border-purple-200">
                                                <span class="text-sm text-purple-800">Smart Contract Analysis</span>
                                                <span class="text-sm font-medium text-purple-900">97% Accuracy</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <h4 class="text-md font-medium text-gray-800 mb-4">Coming Soon</h4>
                                        <div class="space-y-3">
                                            <div class="p-3 bg-gray-50 rounded-lg border border-gray-200">
                                                <div class="text-sm font-medium text-gray-800">🔮 Predictive Ordering</div>
                                                <div class="text-xs text-gray-600">Q3 2024 - AI-generated POs</div>
                                            </div>
                                            <div class="p-3 bg-gray-50 rounded-lg border border-gray-200">
                                                <div class="text-sm font-medium text-gray-800">🌐 Market Intelligence</div>
                                                <div class="text-xs text-gray-600">Q4 2024 - Real-time pricing</div>
                                            </div>
                                            <div class="p-3 bg-gray-50 rounded-lg border border-gray-200">
                                                <div class="text-sm font-medium text-gray-800">🤝 AI Negotiation</div>
                                                <div class="text-xs text-gray-600">Q1 2025 - Contract optimization</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Projects -->
            <div id="projects-content" class="content-page">
                <div class="p-8">
                    <div class="flex items-center justify-between mb-8">
                        <div>
                            <h1 class="text-3xl font-bold text-gray-900">Projects</h1>
                            <p class="text-gray-600">Manage procurement projects and initiatives</p>
                        </div>
                        <div class="flex space-x-3">
                            <button onclick="showNewProjectForm()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 font-medium transition-colors">
                                + New Project
                            </button>
                        </div>
                    </div>

                    <!-- Date Filter -->
                    <div class="mb-6">
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-4">
                            <div class="flex items-center space-x-4">
                                <span class="text-sm font-medium text-gray-700">Date Range:</span>
                                <input type="date" id="projects-start-date" class="border border-gray-300 rounded-lg px-3 py-2 text-sm">
                                <span class="text-gray-500">to</span>
                                <input type="date" id="projects-end-date" class="border border-gray-300 rounded-lg px-3 py-2 text-sm">
                                <button onclick="applyProjectsDateFilter()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 font-medium transition-colors text-sm">Apply</button>
                                <button onclick="resetProjectsDateFilter()" class="text-blue-600 hover:text-blue-800 text-sm font-medium">Reset</button>
                                <span id="date-filter-status" class="text-sm text-gray-500">Showing: Lifetime Data</span>
                            </div>
                        </div>
                    </div>

                    <!-- Project Stats -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow cursor-pointer" onclick="showProjectStatsDetail('active-projects')">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                    <span class="text-blue-600 text-xl">📊</span>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">Active Projects</p>
                                    <p class="text-2xl font-semibold text-gray-900">23</p>
                                    <p class="text-xs text-blue-600">3 ending this week</p>
                                </div>
                            </div>
                            <div class="mt-2">
                                <p class="text-xs text-gray-400">Click for breakdown</p>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow cursor-pointer" onclick="showProjectStatsDetail('total-savings')">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                                    <span class="text-green-600 text-xl">💰</span>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">Total Savings</p>
                                    <p class="text-2xl font-semibold text-gray-900">$2.4M</p>
                                    <p class="text-xs text-green-600">+15% vs target</p>
                                </div>
                            </div>
                            <div class="mt-2">
                                <p class="text-xs text-gray-400">Click for breakdown</p>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow cursor-pointer" onclick="showProjectStatsDetail('avg-timeline')">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                                    <span class="text-purple-600 text-xl">⏱️</span>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">Avg Timeline</p>
                                    <p class="text-2xl font-semibold text-gray-900">12.5</p>
                                    <p class="text-xs text-purple-600">weeks</p>
                                </div>
                            </div>
                            <div class="mt-2">
                                <p class="text-xs text-gray-400">Click for breakdown</p>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow cursor-pointer" onclick="showProjectStatsDetail('success-rate')">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center">
                                    <span class="text-orange-600 text-xl">✅</span>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">Success Rate</p>
                                    <p class="text-2xl font-semibold text-gray-900">94%</p>
                                    <p class="text-xs text-orange-600">On time & budget</p>
                                </div>
                            </div>
                            <div class="mt-2">
                                <p class="text-xs text-gray-400">Click for breakdown</p>
                            </div>
                        </div>
                    </div>

                    <!-- Project Filters -->
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-8">
                        <h3 class="text-lg font-medium text-gray-900 mb-4">Filter Projects</h3>
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Client</label>
                                <select id="client-filter" onchange="filterProjects()" class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm">
                                    <option value="">All Clients</option>
                                    <option value="TechCorp Inc">TechCorp Inc</option>
                                    <option value="Industrial Solutions">Industrial Solutions</option>
                                    <option value="GlobalTrade Ltd">GlobalTrade Ltd</option>
                                    <option value="Healthcare Systems">Healthcare Systems</option>
                                    <option value="Auto Manufacturing">Auto Manufacturing</option>
                                    <option value="Energy Solutions">Energy Solutions</option>
                                    <option value="Financial Services">Financial Services</option>
                                    <option value="RetailMax Corp">RetailMax Corp</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                                <select id="status-filter" onchange="filterProjects()" class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm">
                                    <option value="">All Statuses</option>
                                    <option value="Planning">Planning</option>
                                    <option value="In Progress">In Progress</option>
                                    <option value="Completed">Completed</option>
                                    <option value="On Hold">On Hold</option>
                                    <option value="Cancelled">Cancelled</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Priority</label>
                                <select id="priority-filter" onchange="filterProjects()" class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm">
                                    <option value="">All Priorities</option>
                                    <option value="Critical">Critical</option>
                                    <option value="High">High</option>
                                    <option value="Medium">Medium</option>
                                    <option value="Low">Low</option>
                                </select>
                            </div>
                            <div class="flex items-end">
                                <button onclick="resetProjectFilters()" class="w-full bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 font-medium transition-colors">
                                    Reset Filters
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Project Analytics Charts -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                        <!-- Savings Over Time Chart -->
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-medium text-gray-900">Savings Achieved Over Time</h3>
                                <div class="flex items-center space-x-2">
                                    <span class="text-sm text-green-600 font-medium">Cumulative: $9.8M</span>
                                </div>
                            </div>
                            <div class="relative h-80">
                                <canvas id="savingsChart"></canvas>
                            </div>
                        </div>

                        <!-- Projects Completed Over Time Chart -->
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-medium text-gray-900">Projects Completed Over Time</h3>
                                <div class="flex items-center space-x-2">
                                    <span class="text-sm text-blue-600 font-medium">Total: 23 Projects</span>
                                </div>
                            </div>
                            <div class="relative h-80">
                                <canvas id="projectsChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Projects Table -->
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
                        <div class="px-6 py-4 border-b border-gray-200">
                            <h3 class="text-lg font-medium text-gray-900">Current Projects (<span id="projects-count">23</span>)</h3>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th onclick="sortTable('name')" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors">
                                            <div class="flex items-center">
                                                Project <span id="sort-name" class="ml-1 text-gray-400">↕</span>
                                                </div>
                                        </th>
                                        <th onclick="sortTable('client')" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors">
                                            <div class="flex items-center">
                                                Client <span id="sort-client" class="ml-1 text-gray-400">↕</span>
                                            </div>
                                        </th>
                                        <th onclick="sortTable('priority')" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors">
                                            <div class="flex items-center">
                                                Priority <span id="sort-priority" class="ml-1 text-gray-400">↕</span>
                                                </div>
                                        </th>
                                        <th onclick="sortTable('status')" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors">
                                            <div class="flex items-center">
                                                Status <span id="sort-status" class="ml-1 text-gray-400">↕</span>
                                            </div>
                                        </th>
                                        <th onclick="sortTable('progress')" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors">
                                            <div class="flex items-center">
                                                Progress <span id="sort-progress" class="ml-1 text-gray-400">↕</span>
                                                </div>
                                        </th>
                                        <th onclick="sortTable('savingsTarget')" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors">
                                            <div class="flex items-center">
                                                Savings Target <span id="sort-savingsTarget" class="ml-1 text-gray-400">↕</span>
                                            </div>
                                        </th>
                                        <th onclick="sortTable('dueDate')" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors">
                                            <div class="flex items-center">
                                                Due Date <span id="sort-dueDate" class="ml-1 text-gray-400">↕</span>
                                            </div>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody id="projects-table-body" class="bg-white divide-y divide-gray-200">
                                    <!-- Projects will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Suppliers -->
            <div id="suppliers-content" class="content-page">
                <div class="p-8">
                    <div class="flex items-center justify-between mb-8">
                        <div>
                            <h1 class="text-3xl font-bold text-gray-900">Suppliers</h1>
                            <p class="text-gray-600">Manage your supplier ecosystem and relationships</p>
                        </div>
                        <div class="flex space-x-3">
                            <button onclick="showAddSupplierForm()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 font-medium transition-colors">
                                + Add Supplier
                            </button>
                        </div>
                    </div>

                    <!-- Supplier Stats -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow cursor-pointer" onclick="showSupplierDetails('total')">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                    <span class="text-blue-600 text-xl">🏢</span>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">Total Suppliers</p>
                                    <p class="text-2xl font-semibold text-gray-900">234</p>
                                    <p class="text-xs text-blue-600">12 new this month</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow cursor-pointer" onclick="showSupplierDetails('active')">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                                    <span class="text-green-600 text-xl">✅</span>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">Active</p>
                                    <p class="text-2xl font-semibold text-gray-900">187</p>
                                    <p class="text-xs text-green-600">80% of total</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow cursor-pointer" onclick="showSupplierDetails('rating')">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                                    <span class="text-purple-600 text-xl">⭐</span>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">Avg Rating</p>
                                    <p class="text-2xl font-semibold text-gray-900">4.2</p>
                                    <p class="text-xs text-purple-600">out of 5.0</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow cursor-pointer" onclick="showSupplierDetails('performance')">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center">
                                    <span class="text-orange-600 text-xl">📊</span>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">Performance</p>
                                    <p class="text-2xl font-semibold text-gray-900">92%</p>
                                    <p class="text-xs text-orange-600">On-time delivery</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Supplier Categories -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow cursor-pointer" onclick="showSupplierDetails('categories')">
                            <h3 class="text-lg font-medium text-gray-900 mb-4">Top Categories</h3>
                            <div class="space-y-3">
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-gray-600">Manufacturing</span>
                                    <span class="text-sm font-medium text-gray-900">67 suppliers</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-gray-600">Technology</span>
                                    <span class="text-sm font-medium text-gray-900">45 suppliers</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-gray-600">Services</span>
                                    <span class="text-sm font-medium text-gray-900">38 suppliers</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-gray-600">Logistics</span>
                                    <span class="text-sm font-medium text-gray-900">32 suppliers</span>
                                </div>
                            </div>
                            <div class="mt-4 text-xs text-blue-600 hover:text-blue-800 font-medium text-center">
                                Click to view detailed breakdown →
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow cursor-pointer" onclick="showSupplierDetails('geography')">
                            <h3 class="text-lg font-medium text-gray-900 mb-4">Geographic Distribution</h3>
                            <div class="space-y-3">
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-gray-600">North America</span>
                                    <span class="text-sm font-medium text-gray-900">45%</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-gray-600">Europe</span>
                                    <span class="text-sm font-medium text-gray-900">32%</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-gray-600">Asia Pacific</span>
                                    <span class="text-sm font-medium text-gray-900">18%</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-gray-600">Other</span>
                                    <span class="text-sm font-medium text-gray-900">5%</span>
                                </div>
                            </div>
                            <div class="mt-4 text-xs text-blue-600 hover:text-blue-800 font-medium text-center">
                                Click to view regional analysis →
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <h3 class="text-lg font-medium text-gray-900 mb-4">Risk Assessment Overview</h3>
                            <div class="space-y-3">
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-green-600">Low Risk</span>
                                    <span class="text-sm font-medium text-gray-900">156 suppliers</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-yellow-600">Medium Risk</span>
                                    <span class="text-sm font-medium text-gray-900">67 suppliers</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-red-600">High Risk</span>
                                    <span class="text-sm font-medium text-gray-900">11 suppliers</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-blue-600">Under Review</span>
                                    <span class="text-sm font-medium text-gray-900">8 suppliers</span>
                                </div>
                                <div class="pt-3 border-t border-gray-200">
                                    <button onclick="showRiskDetails()" class="w-full text-xs text-blue-600 hover:text-blue-800 font-medium">
                                        View Detailed Risk Analysis →
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Suppliers Section -->
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
                        <div class="px-6 py-4 border-b border-gray-200">
                            <div class="flex items-center justify-between">
                                <h3 class="text-lg font-medium text-gray-900">Supplier Directory</h3>
                                <div class="flex items-center space-x-4">
                                    <div class="flex items-center space-x-2">
                                        <label for="suppliers-per-page" class="text-sm font-medium text-gray-700">Per Page:</label>
                                        <select id="suppliers-per-page" onchange="changeSuppliersPerPage()" class="border border-gray-300 rounded-lg px-3 py-1 text-sm">
                                            <option value="25">25</option>
                                            <option value="50" selected>50</option>
                                            <option value="100">100</option>
                                            <option value="all">All</option>
                                        </select>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <label for="supplier-status-filter" class="text-sm font-medium text-gray-700">Status:</label>
                                        <select id="supplier-status-filter" onchange="filterSuppliers()" class="border border-gray-300 rounded-lg px-3 py-1 text-sm">
                                            <option value="">All Suppliers</option>
                                            <option value="Active">Active Only</option>
                                            <option value="Inactive">Inactive Only</option>
                                            <option value="Under Review">Under Review</option>
                                            <option value="Suspended">Suspended</option>
                                        </select>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <label for="supplier-risk-filter" class="text-sm font-medium text-gray-700">Risk:</label>
                                        <select id="supplier-risk-filter" onchange="filterSuppliers()" class="border border-gray-300 rounded-lg px-3 py-1 text-sm">
                                            <option value="">All Risk Levels</option>
                                            <option value="Low">Low Risk</option>
                                            <option value="Medium">Medium Risk</option>
                                            <option value="High">High Risk</option>
                                        </select>
                                    </div>
                                    <button onclick="resetSupplierFilters()" class="text-blue-600 hover:text-blue-800 text-sm font-medium">Reset</button>
                                </div>
                            </div>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100" onclick="sortSuppliers('name')">
                                            <div class="flex items-center">
                                                Supplier
                                                <span id="sort-name" class="ml-1 text-gray-400">↕</span>
                                            </div>
                                        </th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100" onclick="sortSuppliers('category')">
                                            <div class="flex items-center">
                                                Category
                                                <span id="sort-category" class="ml-1 text-gray-400">↕</span>
                                            </div>
                                        </th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100" onclick="sortSuppliers('location')">
                                            <div class="flex items-center">
                                                Location
                                                <span id="sort-location" class="ml-1 text-gray-400">↕</span>
                                            </div>
                                        </th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100" onclick="sortSuppliers('rating')">
                                            <div class="flex items-center">
                                                Rating
                                                <span id="sort-rating" class="ml-1 text-gray-400">↕</span>
                                            </div>
                                        </th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100" onclick="sortSuppliers('spend')">
                                            <div class="flex items-center">
                                                Spend (YTD)
                                                <span id="sort-spend" class="ml-1 text-gray-400">↕</span>
                                            </div>
                                        </th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100" onclick="sortSuppliers('risk')">
                                            <div class="flex items-center">
                                                Risk Status
                                                <span id="sort-risk" class="ml-1 text-gray-400">↕</span>
                                            </div>
                                        </th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100" onclick="sortSuppliers('status')">
                                            <div class="flex items-center">
                                                Status
                                                <span id="sort-status" class="ml-1 text-gray-400">↕</span>
                                            </div>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody id="suppliers-table-body" class="bg-white divide-y divide-gray-200">
                                    <!-- Dynamic content will be inserted here -->
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- Pagination Controls -->
                        <div id="pagination-controls" class="px-6 py-4 border-t border-gray-200 bg-gray-50">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center text-sm text-gray-700">
                                    <span>Showing</span>
                                    <span id="showing-start" class="font-medium mx-1">1</span>
                                    <span>to</span>
                                    <span id="showing-end" class="font-medium mx-1">50</span>
                                    <span>of</span>
                                    <span id="total-suppliers" class="font-medium mx-1">234</span>
                                    <span>suppliers</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <button id="prev-page" onclick="changePage(-1)" class="px-3 py-1 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed">
                                        Previous
                                    </button>
                                    <div id="page-numbers" class="flex items-center space-x-1">
                                        <!-- Page numbers will be inserted here -->
                                    </div>
                                    <button id="next-page" onclick="changePage(1)" class="px-3 py-1 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed">
                                        Next
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Advanced Risk Management Section -->
                    <div id="risk-details" class="mt-8 space-y-6 hidden">
                        <div class="flex items-center justify-between">
                            <h2 class="text-2xl font-bold text-gray-900">Advanced Risk Management</h2>
                            <button onclick="hideRiskDetails()" class="text-gray-500 hover:text-gray-700">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>

                        <!-- Market Indicators Dashboard -->
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                            <!-- Market Risk Indicators -->
                            <div class="lg:col-span-2 bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                                <h3 class="text-lg font-medium text-gray-900 mb-6">Market Risk Indicators</h3>
                                
                                <!-- Economic Indicators -->
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-4">Economic Indicators</h4>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                                            <div class="flex items-center justify-between">
                                                <div>
                                                    <p class="text-sm font-medium text-red-800">Inflation Rate</p>
                                                    <p class="text-2xl font-bold text-red-900">6.8%</p>
                                                    <p class="text-xs text-red-600">↑ 0.3% this month</p>
                                                </div>
                                                <div class="w-10 h-10 bg-red-100 rounded-full flex items-center justify-center">
                                                    <span class="text-red-600 text-lg">📈</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                            <div class="flex items-center justify-between">
                                                <div>
                                                    <p class="text-sm font-medium text-yellow-800">Currency Volatility</p>
                                                    <p class="text-2xl font-bold text-yellow-900">Medium</p>
                                                    <p class="text-xs text-yellow-600">USD/EUR fluctuation</p>
                                                </div>
                                                <div class="w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center">
                                                    <span class="text-yellow-600 text-lg">💱</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                            <div class="flex items-center justify-between">
                                                <div>
                                                    <p class="text-sm font-medium text-blue-800">Interest Rates</p>
                                                    <p class="text-2xl font-bold text-blue-900">4.25%</p>
                                                    <p class="text-xs text-blue-600">Federal Reserve</p>
                                                </div>
                                                <div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
                                                    <span class="text-blue-600 text-lg">🏦</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                            <div class="flex items-center justify-between">
                                                <div>
                                                    <p class="text-sm font-medium text-green-800">GDP Growth</p>
                                                    <p class="text-2xl font-bold text-green-900">2.1%</p>
                                                    <p class="text-xs text-green-600">Quarterly rate</p>
                                                </div>
                                                <div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center">
                                                    <span class="text-green-600 text-lg">📊</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Commodity Prices -->
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-4">Commodity Price Trends</h4>
                                    <div class="space-y-3">
                                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                            <div class="flex items-center">
                                                <span class="text-yellow-600 text-lg mr-3">🛢️</span>
                                                <div>
                                                    <p class="text-sm font-medium text-gray-900">Crude Oil</p>
                                                    <p class="text-xs text-gray-500">Brent Crude per barrel</p>
                                                </div>
                                                </div>
                                            <div class="text-right">
                                                <p class="text-sm font-semibold text-gray-900">$87.42</p>
                                                <p class="text-xs text-red-600">↓ 2.1%</p>
                                            </div>
                                        </div>
                                        
                                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                            <div class="flex items-center">
                                                <span class="text-gray-600 text-lg mr-3">⚙️</span>
                                                <div>
                                                    <p class="text-sm font-medium text-gray-900">Steel</p>
                                                    <p class="text-xs text-gray-500">Hot-rolled coil per ton</p>
                                            </div>
                                            </div>
                                            <div class="text-right">
                                                <p class="text-sm font-semibold text-gray-900">$685</p>
                                                <p class="text-xs text-green-600">↑ 1.8%</p>
                                            </div>
                                        </div>
                                        
                                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                            <div class="flex items-center">
                                                <span class="text-orange-600 text-lg mr-3">🔶</span>
                                                <div>
                                                    <p class="text-sm font-medium text-gray-900">Copper</p>
                                                    <p class="text-xs text-gray-500">London Metal Exchange</p>
                                                </div>
                                                </div>
                                            <div class="text-right">
                                                <p class="text-sm font-semibold text-gray-900">$8,234</p>
                                                <p class="text-xs text-red-600">↓ 0.7%</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Supply Chain Disruption Index -->
                                <div>
                                    <h4 class="text-md font-medium text-gray-700 mb-4">Supply Chain Disruption Index</h4>
                                    <div class="bg-gradient-to-r from-green-100 to-red-100 rounded-lg p-4">
                                        <div class="flex items-center justify-between mb-2">
                                            <span class="text-sm font-medium text-gray-700">Global Disruption Level</span>
                                            <span class="text-sm font-bold text-orange-700">Medium-High</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-3">
                                            <div class="bg-gradient-to-r from-yellow-400 to-red-500 h-3 rounded-full" style="width: 68%"></div>
                                        </div>
                                        <div class="flex justify-between text-xs text-gray-600 mt-1">
                                            <span>Low</span>
                                            <span>Medium</span>
                                            <span>High</span>
                                        </div>
                                        <div class="mt-3 grid grid-cols-3 gap-2 text-xs">
                                            <div class="text-center">
                                                <p class="font-medium text-gray-700">🚢 Shipping</p>
                                                <p class="text-red-600">High</p>
                                            </div>
                                            <div class="text-center">
                                                <p class="font-medium text-gray-700">🏭 Manufacturing</p>
                                                <p class="text-yellow-600">Medium</p>
                                            </div>
                                            <div class="text-center">
                                                <p class="font-medium text-gray-700">🛻 Logistics</p>
                                                <p class="text-yellow-600">Medium</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Risk Alerts & Actions -->
                            <div class="space-y-6">
                                <!-- Active Risk Alerts -->
                                <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                                    <h3 class="text-lg font-medium text-gray-900 mb-4">Active Risk Alerts</h3>
                                    <div class="space-y-3">
                                        <div class="p-3 bg-red-50 border border-red-200 rounded-lg">
                                            <div class="flex items-start">
                                                <span class="text-red-600 text-lg mr-2">🚨</span>
                                                <div>
                                                    <p class="text-sm font-medium text-red-800">High Risk</p>
                                                    <p class="text-xs text-red-600">TechSource Global - Geopolitical tensions affecting supply chain</p>
                                                    <p class="text-xs text-gray-500 mt-1">2 hours ago</p>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="p-3 bg-yellow-50 border border-yellow-200 rounded-lg">
                                            <div class="flex items-start">
                                                <span class="text-yellow-600 text-lg mr-2">⚠️</span>
                                                <div>
                                                    <p class="text-sm font-medium text-yellow-800">Medium Risk</p>
                                                    <p class="text-xs text-yellow-600">European Logistics - Currency fluctuation impact</p>
                                                    <p class="text-xs text-gray-500 mt-1">6 hours ago</p>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="p-3 bg-blue-50 border border-blue-200 rounded-lg">
                                            <div class="flex items-start">
                                                <span class="text-blue-600 text-lg mr-2">ℹ️</span>
                                                <div>
                                                    <p class="text-sm font-medium text-blue-800">Info</p>
                                                    <p class="text-xs text-blue-600">Industrial Solutions - ESG compliance review due</p>
                                                    <p class="text-xs text-gray-500 mt-1">1 day ago</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Risk Mitigation Actions -->
                                <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                                    <h3 class="text-lg font-medium text-gray-900 mb-4">Recommended Actions</h3>
                                    <div class="space-y-3">
                                        <div class="flex items-center justify-between p-3 bg-blue-50 rounded-lg">
                                            <div class="flex items-center">
                                                <input type="checkbox" class="rounded border-gray-300 text-blue-600 mr-3">
                                                <div>
                                                    <p class="text-sm font-medium text-gray-900">Diversify supplier base</p>
                                                    <p class="text-xs text-gray-500">Add 2-3 alternative suppliers</p>
                                                </div>
                                            </div>
                                            <span class="text-xs bg-red-100 text-red-800 px-2 py-1 rounded-full">High Priority</span>
                                        </div>
                                        
                                        <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg">
                                            <div class="flex items-center">
                                                <input type="checkbox" class="rounded border-gray-300 text-blue-600 mr-3">
                                                <div>
                                                    <p class="text-sm font-medium text-gray-900">Update contracts</p>
                                                    <p class="text-xs text-gray-500">Include inflation adjustment clauses</p>
                                                </div>
                                            </div>
                                            <span class="text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full">Medium Priority</span>
                                        </div>
                                        
                                        <div class="flex items-center justify-between p-3 bg-purple-50 rounded-lg">
                                            <div class="flex items-center">
                                                <input type="checkbox" class="rounded border-gray-300 text-blue-600 mr-3">
                                                <div>
                                                    <p class="text-sm font-medium text-gray-900">Increase inventory buffer</p>
                                                    <p class="text-xs text-gray-500">For critical components</p>
                                                </div>
                                            </div>
                                            <span class="text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full">Medium Priority</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- ESG Risk Factors -->
                                <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                                    <h3 class="text-lg font-medium text-gray-900 mb-4">ESG Risk Monitoring</h3>
                                    <div class="space-y-4">
                                        <div>
                                            <div class="flex justify-between items-center mb-2">
                                                <span class="text-sm font-medium text-gray-700">Environmental Score</span>
                                                <span class="text-sm font-bold text-green-600">8.2/10</span>
                                            </div>
                                            <div class="w-full bg-gray-200 rounded-full h-2">
                                                <div class="bg-green-500 h-2 rounded-full" style="width: 82%"></div>
                                            </div>
                                        </div>
                                        
                                        <div>
                                            <div class="flex justify-between items-center mb-2">
                                                <span class="text-sm font-medium text-gray-700">Social Score</span>
                                                <span class="text-sm font-bold text-yellow-600">6.8/10</span>
                                            </div>
                                            <div class="w-full bg-gray-200 rounded-full h-2">
                                                <div class="bg-yellow-500 h-2 rounded-full" style="width: 68%"></div>
                                            </div>
                                        </div>
                                        
                                        <div>
                                            <div class="flex justify-between items-center mb-2">
                                                <span class="text-sm font-medium text-gray-700">Governance Score</span>
                                                <span class="text-sm font-bold text-green-600">9.1/10</span>
                                            </div>
                                            <div class="w-full bg-gray-200 rounded-full h-2">
                                                <div class="bg-green-500 h-2 rounded-full" style="width: 91%"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Supplier Risk Matrix -->
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <h3 class="text-lg font-medium text-gray-900 mb-6">Supplier Risk Matrix</h3>
                            <div class="overflow-x-auto">
                                <table class="min-w-full">
                                    <thead>
                                        <tr>
                                            <th class="text-left text-sm font-medium text-gray-500 pb-4">Supplier</th>
                                            <th class="text-center text-sm font-medium text-gray-500 pb-4">Financial Risk</th>
                                            <th class="text-center text-sm font-medium text-gray-500 pb-4">Operational Risk</th>
                                            <th class="text-center text-sm font-medium text-gray-500 pb-4">Geopolitical Risk</th>
                                            <th class="text-center text-sm font-medium text-gray-500 pb-4">ESG Risk</th>
                                            <th class="text-center text-sm font-medium text-gray-500 pb-4">Overall Risk</th>
                                            <th class="text-center text-sm font-medium text-gray-500 pb-4">Trend</th>
                                        </tr>
                                    </thead>
                                    <tbody class="divide-y divide-gray-200">
                                        <tr>
                                            <td class="py-3">
                                                <div class="flex items-center">
                                                    <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mr-3">
                                                        <span class="text-blue-600 font-medium text-xs">IS</span>
                                                    </div>
                                                    <span class="text-sm font-medium text-gray-900">Industrial Solutions Inc</span>
                                            </div>
                                        </td>
                                            <td class="text-center py-3">
                                                <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">Low</span>
                                            </td>
                                            <td class="text-center py-3">
                                                <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800">Medium</span>
                                            </td>
                                            <td class="text-center py-3">
                                                <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">Low</span>
                                            </td>
                                            <td class="text-center py-3">
                                                <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">Low</span>
                                            </td>
                                            <td class="text-center py-3">
                                                <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">Low</span>
                                            </td>
                                            <td class="text-center py-3">
                                                <span class="text-green-600 text-sm">↗ Improving</span>
                                        </td>
                                    </tr>
                                        <tr>
                                            <td class="py-3">
                                            <div class="flex items-center">
                                                    <div class="w-8 h-8 bg-orange-100 rounded-lg flex items-center justify-center mr-3">
                                                        <span class="text-orange-600 font-medium text-xs">TS</span>
                                                </div>
                                                    <span class="text-sm font-medium text-gray-900">TechSource Global</span>
                                            </div>
                                        </td>
                                            <td class="text-center py-3">
                                                <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800">Medium</span>
                                            </td>
                                            <td class="text-center py-3">
                                                <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800">High</span>
                                            </td>
                                            <td class="text-center py-3">
                                                <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800">High</span>
                                            </td>
                                            <td class="text-center py-3">
                                                <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800">Medium</span>
                                            </td>
                                            <td class="text-center py-3">
                                                <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800">High</span>
                                            </td>
                                            <td class="text-center py-3">
                                                <span class="text-red-600 text-sm">↘ Worsening</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="py-3">
                                            <div class="flex items-center">
                                                    <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center mr-3">
                                                        <span class="text-green-600 font-medium text-xs">EL</span>
                                                    </div>
                                                    <span class="text-sm font-medium text-gray-900">European Logistics Ltd</span>
                                            </div>
                                        </td>
                                            <td class="text-center py-3">
                                                <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">Low</span>
                                            </td>
                                            <td class="text-center py-3">
                                                <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800">Medium</span>
                                            </td>
                                            <td class="text-center py-3">
                                                <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800">Medium</span>
                                            </td>
                                            <td class="text-center py-3">
                                                <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">Low</span>
                                            </td>
                                            <td class="text-center py-3">
                                                <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800">Medium</span>
                                            </td>
                                            <td class="text-center py-3">
                                                <span class="text-gray-600 text-sm">→ Stable</span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Supplier Portal -->
            <div id="supplier-portal-content" class="content-page">
                <div class="p-8">
                    <!-- Header -->
                    <div class="flex items-center justify-between mb-8">
                        <div>
                            <h1 class="text-3xl font-bold text-gray-900">Eastern Transport Co. - Supplier Portal</h1>
                            <p class="text-gray-600">Manage incoming purchase orders and customer communications</p>
                        </div>
                        <div class="flex space-x-3">
                            <button onclick="exportSupplierPOs()" class="bg-white text-gray-700 px-4 py-2 rounded-lg border border-gray-300 hover:bg-gray-50 font-medium transition-colors">
                                📊 Export Report
                            </button>
                            <button onclick="showSupplierDashboard()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 font-medium transition-colors">
                                📈 Performance Dashboard
                            </button>
                        </div>
                    </div>

                    <!-- Tabs Navigation -->
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 mb-6">
                        <div class="px-6 py-4 border-b border-gray-200">
                            <nav class="flex space-x-8" aria-label="Tabs">
                                <button onclick="switchSupplierTab('orders')" id="supplier-tab-orders" class="supplier-tab-button active border-b-2 border-blue-500 pb-4 px-1 text-sm font-medium text-blue-600">
                                    📦 Order Management Hub
                                </button>
                                <button onclick="switchSupplierTab('approvals')" id="supplier-tab-approvals" class="supplier-tab-button border-b-2 border-transparent pb-4 px-1 text-sm font-medium text-gray-500 hover:text-gray-700">
                                    ✅ Customer Requests
                                </button>
                                <button onclick="switchSupplierTab('communication')" id="supplier-tab-communication" class="supplier-tab-button border-b-2 border-transparent pb-4 px-1 text-sm font-medium text-gray-500 hover:text-gray-700">
                                    💬 Customer Communication
                                </button>
                                <button onclick="switchSupplierTab('ai')" id="supplier-tab-ai" class="supplier-tab-button border-b-2 border-transparent pb-4 px-1 text-sm font-medium text-gray-500 hover:text-gray-700">
                                    🤖 AI & Automation
                                </button>
                            </nav>
                        </div>

                        <!-- Order Management Hub Tab -->
                        <div id="supplier-tab-orders" class="supplier-tab-content active">
                    <!-- Supplier PO Stats -->
                    <div class="grid grid-cols-1 md:grid-cols-5 gap-6 mb-8">
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <div class="flex items-center">
                                        <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                            <span class="text-blue-600 text-xl">📨</span>
                                        </div>
                                        <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">POs Received</p>
                                    <p class="text-2xl font-semibold text-gray-900" id="supplier-total-pos">63</p>
                                            <p class="text-xs text-blue-600">+4 this week</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <div class="flex items-center">
                                        <div class="w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center">
                                            <span class="text-yellow-600 text-xl">⏳</span>
                                        </div>
                                        <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">Need Response</p>
                                    <p class="text-2xl font-semibold text-gray-900" id="supplier-pending-response">7</p>
                                            <p class="text-xs text-yellow-600">3 urgent</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <div class="flex items-center">
                                        <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                                            <span class="text-purple-600 text-xl">🚚</span>
                                        </div>
                                        <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">In Production</p>
                                    <p class="text-2xl font-semibold text-gray-900" id="supplier-in-production">18</p>
                                            <p class="text-xs text-purple-600">8 shipping this week</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <div class="flex items-center">
                                        <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                                            <span class="text-green-600 text-xl">✅</span>
                                        </div>
                                        <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">Delivered</p>
                                    <p class="text-2xl font-semibold text-gray-900" id="supplier-delivered">35</p>
                                            <p class="text-xs text-green-600">95% on-time</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <div class="flex items-center">
                                        <div class="w-12 h-12 bg-indigo-100 rounded-lg flex items-center justify-center">
                                            <span class="text-indigo-600 text-xl">💰</span>
                                        </div>
                                        <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">Total Value</p>
                                    <p class="text-2xl font-semibold text-gray-900" id="supplier-total-value">$485K</p>
                                            <p class="text-xs text-indigo-600">12% increase YoY</p>
                                </div>
                            </div>
                        </div>
                    </div>

                            <!-- Quick Actions and Performance Impact Section -->
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">PO Number</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Total</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Need By</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Action Required</th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white divide-y divide-gray-200">
                                        <tr class="hover:bg-gray-50">
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-600">PO-2024-001</td>
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                    Needs Acknowledgment
                                                </span>
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">$49,100.00</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Mar 15, 2024</td>
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <button onclick="acknowledgePO('PO-2024-001')" class="bg-green-600 text-white px-3 py-1 rounded text-xs hover:bg-green-700 transition-colors">
                                                    ✅ Acknowledge
                                                </button>
                                            </td>
                                        </tr>
                                        <tr class="hover:bg-gray-50">
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-600">PO-2024-007</td>
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800">
                                                    In Production
                                                </span>
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">$23,750.00</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Mar 28, 2024</td>
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <button onclick="updateShipment('PO-2024-007')" class="bg-blue-600 text-white px-3 py-1 rounded text-xs hover:bg-blue-700 transition-colors">
                                                    🚚 Update Shipment
                                                </button>
                                            </td>
                                        </tr>
                                        <tr class="hover:bg-gray-50">
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-600">PO-2024-012</td>
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">
                                                    Delivered
                                                </span>
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">$67,200.00</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Mar 10, 2024</td>
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <button onclick="submitInvoice('PO-2024-012')" class="bg-purple-600 text-white px-3 py-1 rounded text-xs hover:bg-purple-700 transition-colors">
                                                    📄 Submit Invoice
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Requests Tab -->
                        <div id="portal-requests" class="portal-tab-content p-6 hidden">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-medium text-gray-900">Information Requests & Communications</h3>
                                <button onclick="newRequest()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 font-medium transition-colors">
                                    + New Request
                                </button>
                            </div>
                            <div class="space-y-4">
                                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                    <div class="flex items-start">
                                        <div class="flex-shrink-0">
                                            <span class="w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center">
                                                <span class="text-yellow-600 font-medium text-sm">!</span>
                                            </span>
                                        </div>
                                        <div class="ml-3 flex-1">
                                            <h4 class="text-sm font-medium text-yellow-800">Urgent: Lead Time Update Required</h4>
                                            <p class="text-sm text-yellow-700 mt-1">Please provide updated lead times for steel components due to supply chain disruption. Affects PO-2024-015, PO-2024-018.</p>
                                            <div class="mt-2 flex items-center text-xs text-yellow-600">
                                                <span>From: Sarah Chen • 2 hours ago</span>
                                                <span class="ml-4">Priority: High</span>
                                            </div>
                                            <div class="mt-3 flex space-x-2">
                                                <button onclick="respondToRequest('REQ-001')" class="bg-yellow-600 text-white px-3 py-1 rounded text-xs hover:bg-yellow-700 transition-colors">
                                                    📝 Respond
                                                </button>
                                                <button onclick="viewRequestDetails('REQ-001')" class="bg-gray-100 text-gray-700 px-3 py-1 rounded text-xs hover:bg-gray-200 transition-colors">
                                                    👁️ View Details
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                    <div class="flex items-start">
                                        <div class="flex-shrink-0">
                                            <span class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                                                <span class="text-blue-600 font-medium text-sm">?</span>
                                            </span>
                                        </div>
                                        <div class="ml-3 flex-1">
                                            <h4 class="text-sm font-medium text-blue-800">Quality Specification Clarification</h4>
                                            <p class="text-sm text-blue-700 mt-1">Need clarification on tolerance specifications for Part #MTL-4567. Current specs seem inconsistent with previous orders.</p>
                                            <div class="mt-2 flex items-center text-xs text-blue-600">
                                                <span>From: Mike Rodriguez • 1 day ago</span>
                                                <span class="ml-4">Priority: Medium</span>
                                            </div>
                                            <div class="mt-3 flex space-x-2">
                                                <button onclick="respondToRequest('REQ-002')" class="bg-blue-600 text-white px-3 py-1 rounded text-xs hover:bg-blue-700 transition-colors">
                                                    📝 Respond
                                                </button>
                                                <button onclick="viewRequestDetails('REQ-002')" class="bg-gray-100 text-gray-700 px-3 py-1 rounded text-xs hover:bg-gray-200 transition-colors">
                                                    👁️ View Details
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                    <div class="flex items-start">
                                        <div class="flex-shrink-0">
                                            <span class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center">
                                                <span class="text-green-600 font-medium text-sm">✓</span>
                                            </span>
                                        </div>
                                        <div class="ml-3 flex-1">
                                            <h4 class="text-sm font-medium text-green-800">Delivery Schedule Confirmation - Resolved</h4>
                                            <p class="text-sm text-green-700 mt-1">Confirmed delivery schedule for Q2 orders. All shipments on track for planned delivery dates.</p>
                                            <div class="mt-2 flex items-center text-xs text-green-600">
                                                <span>From: Emma Thompson • 3 days ago</span>
                                                <span class="ml-4">Status: Resolved</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Shipments Tab -->
                        <div id="portal-shipments" class="portal-tab-content p-6 hidden">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-medium text-gray-900">Shipment Tracking & ASNs</h3>
                                <button onclick="createASN()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 font-medium transition-colors">
                                    + Create ASN
                                </button>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="bg-white border border-gray-200 rounded-lg p-4">
                                    <div class="flex items-center justify-between mb-3">
                                        <h4 class="font-medium text-gray-900">Shipment #SH-2024-045</h4>
                                        <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800">
                                            In Transit
                                        </span>
                                    </div>
                                    <div class="space-y-2 text-sm">
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">PO Number:</span>
                                            <span class="text-gray-900">PO-2024-007</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Tracking:</span>
                                            <span class="text-blue-600">TRK-789456123</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">ETA:</span>
                                            <span class="text-gray-900">Mar 20, 2024</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Carrier:</span>
                                            <span class="text-gray-900">FedEx</span>
                                        </div>
                                    </div>
                                    <button onclick="updateShipmentStatus('SH-2024-045')" class="w-full mt-3 bg-blue-50 text-blue-600 px-3 py-2 rounded hover:bg-blue-100 transition-colors">
                                        🔄 Update Status
                                    </button>
                                </div>

                                <div class="bg-white border border-gray-200 rounded-lg p-4">
                                    <div class="flex items-center justify-between mb-3">
                                        <h4 class="font-medium text-gray-900">Shipment #SH-2024-052</h4>
                                        <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">
                                            Delivered
                                        </span>
                                    </div>
                                    <div class="space-y-2 text-sm">
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">PO Number:</span>
                                            <span class="text-gray-900">PO-2024-012</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Delivered:</span>
                                            <span class="text-green-600">Mar 12, 2024</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Received By:</span>
                                            <span class="text-gray-900">Warehouse A</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">POD:</span>
                                            <span class="text-blue-600">Available</span>
                                        </div>
                                    </div>
                                    <button onclick="downloadPOD('SH-2024-052')" class="w-full mt-3 bg-green-50 text-green-600 px-3 py-2 rounded hover:bg-green-100 transition-colors">
                                        📄 Download POD
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Invoices Tab -->
                        <div id="portal-invoices" class="portal-tab-content p-6 hidden">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-medium text-gray-900">Invoice Management</h3>
                                <button onclick="uploadInvoice()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 font-medium transition-colors">
                                    📤 Upload Invoice
                                </button>
                            </div>
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Invoice #</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">PO Number</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Amount</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Due Date</th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white divide-y divide-gray-200">
                                        <tr class="hover:bg-gray-50">
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-600">INV-2024-067</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">PO-2024-012</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">$67,200.00</td>
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">
                                                    Approved
                                                </span>
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Apr 15, 2024</td>
                                        </tr>
                                        <tr class="hover:bg-gray-50">
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-600">INV-2024-058</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">PO-2024-008</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">$34,500.00</td>
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                    Under Review
                                                </span>
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Apr 10, 2024</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Messages Tab -->
                        <div id="portal-messages" class="portal-tab-content p-6 hidden">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-medium text-gray-900">Direct Messages</h3>
                                <button onclick="composeMessage()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 font-medium transition-colors">
                                    ✏️ Compose
                                </button>
                            </div>
                            <div class="space-y-4">
                                <div class="bg-white border border-gray-200 rounded-lg p-4">
                                    <div class="flex items-start space-x-3">
                                        <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                                            <span class="text-blue-600 font-medium text-sm">SC</span>
                                        </div>
                                        <div class="flex-1">
                                            <div class="flex items-center space-x-2">
                                                <h4 class="text-sm font-medium text-gray-900">Sarah Chen</h4>
                                                <span class="text-xs text-gray-500">Procurement Manager</span>
                                                <span class="text-xs text-gray-400">• 30 min ago</span>
                                            </div>
                                            <p class="text-sm text-gray-700 mt-1">Hi! Can you confirm the delivery schedule for the steel components? We need to update our production planning.</p>
                                            <button onclick="replyToMessage('MSG-001')" class="text-blue-600 text-xs hover:text-blue-800 mt-2">
                                                💬 Reply
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                    <div class="flex items-start space-x-3">
                                        <div class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center">
                                            <span class="text-gray-600 font-medium text-sm">You</span>
                                        </div>
                                        <div class="flex-1">
                                            <div class="flex items-center space-x-2">
                                                <h4 class="text-sm font-medium text-gray-900">You</h4>
                                                <span class="text-xs text-gray-400">• 1 hour ago</span>
                                            </div>
                                            <p class="text-sm text-gray-700 mt-1">Thanks for the update on PO-2024-007. We'll have the parts ready for shipment by Friday as discussed.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
            
            <!-- Analytics -->
            <div id="analytics-content" class="content-page">
                <div class="p-8">
                    <div class="flex items-center justify-between mb-8">
                        <div>
                            <h1 class="text-3xl font-bold text-gray-900">Supply Chain Analytics</h1>
                            <p class="text-gray-600">Track performance, costs, and efficiency across your supply chain</p>
                        </div>
                        <div class="flex space-x-3">
                            <select class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                <option value="ytd">Year to Date</option>
                                <option value="q1">Q1 2024</option>
                                <option value="q2">Q2 2024</option>
                                <option value="monthly">Monthly</option>
                            </select>
                            <button onclick="exportAnalytics()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 font-medium transition-colors">
                                📊 Export Report
                            </button>
                        </div>
                    </div>

                    <!-- Key Metrics Overview -->
                    <div class="grid grid-cols-1 md:grid-cols-6 gap-6 mb-8">
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                    <span class="text-blue-600 text-xl">💰</span>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">Total Spend</p>
                                    <p class="text-xl font-semibold text-gray-900">$2.4M</p>
                                    <p class="text-xs text-green-600">+12% YoY</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                                    <span class="text-green-600 text-xl">📊</span>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">Cost Savings</p>
                                    <p class="text-xl font-semibold text-gray-900">$2.1M</p>
                                    <p class="text-xs text-green-600">88% of spend</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                                    <span class="text-purple-600 text-xl">⏱️</span>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">Avg Lead Time</p>
                                    <p class="text-xl font-semibold text-gray-900">14.2</p>
                                    <p class="text-xs text-red-600">+2.1 days</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center">
                                    <span class="text-orange-600 text-xl">🚚</span>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">On-Time Delivery</p>
                                    <p class="text-xl font-semibold text-gray-900">96.8%</p>
                                    <p class="text-xs text-green-600">+4.5%</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center">
                                    <span class="text-red-600 text-xl">📦</span>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">Inventory Turns</p>
                                    <p class="text-xl font-semibold text-gray-900">6.8x</p>
                                    <p class="text-xs text-green-600">+0.4x</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-teal-100 rounded-lg flex items-center justify-center">
                                    <span class="text-teal-600 text-xl">⚡</span>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">Response Time</p>
                                    <p class="text-xl font-semibold text-gray-900">18h</p>
                                    <p class="text-xs text-green-600">-6h improved</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Commodity Analysis -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                        <!-- Spend by Commodity -->
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
                            <div class="px-6 py-4 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-900">Spend by Commodity</h3>
                                <p class="text-sm text-gray-500">YTD breakdown and trends</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-4">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center">
                                            <div class="w-4 h-4 bg-blue-500 rounded mr-3"></div>
                                            <span class="text-sm font-medium text-gray-900">Raw Materials</span>
                                        </div>
                                        <div class="text-right">
                                            <div class="text-sm font-medium text-gray-900">$936K</div>
                                            <div class="text-xs text-gray-500">39.0%</div>
                                        </div>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                        <div class="bg-blue-500 h-2 rounded-full" style="width: 39%"></div>
                                    </div>
                                </div>
                                
                                <div class="space-y-4 mt-6">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center">
                                            <div class="w-4 h-4 bg-green-500 rounded mr-3"></div>
                                            <span class="text-sm font-medium text-gray-900">Technology & IT</span>
                                        </div>
                                        <div class="text-right">
                                            <div class="text-sm font-medium text-gray-900">$614K</div>
                                            <div class="text-xs text-gray-500">25.6%</div>
                                        </div>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                        <div class="bg-green-500 h-2 rounded-full" style="width: 25.6%"></div>
                                    </div>
                                </div>
                                
                                <div class="space-y-4 mt-6">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center">
                                            <div class="w-4 h-4 bg-purple-500 rounded mr-3"></div>
                                            <span class="text-sm font-medium text-gray-900">Logistics & Transport</span>
                                        </div>
                                        <div class="text-right">
                                            <div class="text-sm font-medium text-gray-900">$439K</div>
                                            <div class="text-xs text-gray-500">18.3%</div>
                                        </div>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                        <div class="bg-purple-500 h-2 rounded-full" style="width: 18.3%"></div>
                                    </div>
                                </div>
                                
                                <div class="space-y-4 mt-6">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center">
                                            <div class="w-4 h-4 bg-orange-500 rounded mr-3"></div>
                                            <span class="text-sm font-medium text-gray-900">Professional Services</span>
                                        </div>
                                        <div class="text-right">
                                            <div class="text-sm font-medium text-gray-900">$286K</div>
                                            <div class="text-xs text-gray-500">11.9%</div>
                                        </div>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                        <div class="bg-orange-500 h-2 rounded-full" style="width: 11.9%"></div>
                                    </div>
                                </div>
                                
                                <div class="space-y-4 mt-6">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center">
                                            <div class="w-4 h-4 bg-gray-500 rounded mr-3"></div>
                                            <span class="text-sm font-medium text-gray-900">Other</span>
                                        </div>
                                        <div class="text-right">
                                            <div class="text-sm font-medium text-gray-900">$122K</div>
                                            <div class="text-xs text-gray-500">5.1%</div>
                                        </div>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                        <div class="bg-gray-500 h-2 rounded-full" style="width: 5.1%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Lead Time by Commodity -->
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
                            <div class="px-6 py-4 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-900">Lead Time Analysis</h3>
                                <p class="text-sm text-gray-500">Average days by commodity</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-6">
                                    <div>
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="text-sm font-medium text-gray-900">Raw Materials</span>
                                            <span class="text-sm text-gray-600">21.5 days</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-3">
                                            <div class="bg-red-400 h-3 rounded-full flex items-center justify-end pr-2" style="width: 86%">
                                                <span class="text-xs text-white font-medium">+3.2</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="text-sm font-medium text-gray-900">Technology & IT</span>
                                            <span class="text-sm text-gray-600">12.3 days</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-3">
                                            <div class="bg-yellow-400 h-3 rounded-full flex items-center justify-end pr-2" style="width: 49%">
                                                <span class="text-xs text-gray-800 font-medium">-0.5</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="text-sm font-medium text-gray-900">Logistics & Transport</span>
                                            <span class="text-sm text-gray-600">8.7 days</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-3">
                                            <div class="bg-green-400 h-3 rounded-full flex items-center justify-end pr-2" style="width: 35%">
                                                <span class="text-xs text-white font-medium">-1.2</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="text-sm font-medium text-gray-900">Professional Services</span>
                                            <span class="text-sm text-gray-600">15.8 days</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-3">
                                            <div class="bg-orange-400 h-3 rounded-full flex items-center justify-end pr-2" style="width: 63%">
                                                <span class="text-xs text-white font-medium">+2.1</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="mt-6 text-xs text-gray-500 border-t border-gray-200 pt-4">
                                    <div class="flex items-center space-x-4">
                                        <div class="flex items-center">
                                            <div class="w-3 h-3 bg-green-400 rounded mr-1"></div>
                                            <span>Improved</span>
                                        </div>
                                        <div class="flex items-center">
                                            <div class="w-3 h-3 bg-yellow-400 rounded mr-1"></div>
                                            <span>Stable</span>
                                        </div>
                                        <div class="flex items-center">
                                            <div class="w-3 h-3 bg-red-400 rounded mr-1"></div>
                                            <span>Needs Attention</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Performance Metrics by Commodity -->
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden mb-8">
                        <div class="px-6 py-4 border-b border-gray-200">
                            <h3 class="text-lg font-medium text-gray-900">Commodity Performance Scorecard</h3>
                            <p class="text-sm text-gray-500">Key metrics across commodity categories</p>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Commodity</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Spend</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">On-Time Delivery</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Avg Lead Time</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Inventory Level</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Supplier Response</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Risk Score</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200">
                                    <tr class="hover:bg-gray-50">
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <div class="text-sm font-medium text-gray-900">Raw Materials</div>
                                            <div class="text-sm text-gray-500">Steel, Aluminum, Plastics</div>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">$936K</td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <div class="flex items-center">
                                                <span class="text-sm text-gray-900">87.5%</span>
                                                <span class="ml-2 text-xs text-red-600">▼ 2.3%</span>
                                            </div>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <div class="flex items-center">
                                                <span class="text-sm text-gray-900">21.5 days</span>
                                                <span class="ml-2 text-xs text-red-600">▲ 3.2</span>
                                            </div>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800">
                                                High
                                            </span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <div class="flex items-center">
                                                <span class="text-sm text-gray-900">4.2hrs</span>
                                                <span class="ml-2 text-xs text-green-600">▼ 1.1hrs</span>
                                            </div>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                Medium
                                            </span>
                                        </td>
                                    </tr>
                                    
                                    <tr class="hover:bg-gray-50">
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <div class="text-sm font-medium text-gray-900">Technology & IT</div>
                                            <div class="text-sm text-gray-500">Hardware, Software, Services</div>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">$614K</td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <div class="flex items-center">
                                                <span class="text-sm text-gray-900">95.8%</span>
                                                <span class="ml-2 text-xs text-green-600">▲ 1.2%</span>
                                            </div>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <div class="flex items-center">
                                                <span class="text-sm text-gray-900">12.3 days</span>
                                                <span class="ml-2 text-xs text-green-600">▼ 0.5</span>
                                            </div>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">
                                                Optimal
                                            </span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <div class="flex items-center">
                                                <span class="text-sm text-gray-900">1.8hrs</span>
                                                <span class="ml-2 text-xs text-green-600">▼ 0.3hrs</span>
                                            </div>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">
                                                Low
                                            </span>
                                        </td>
                                    </tr>
                                    
                                    <tr class="hover:bg-gray-50">
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <div class="text-sm font-medium text-gray-900">Logistics & Transport</div>
                                            <div class="text-sm text-gray-500">Shipping, Warehousing</div>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">$439K</td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <div class="flex items-center">
                                                <span class="text-sm text-gray-900">92.1%</span>
                                                <span class="ml-2 text-xs text-green-600">▲ 0.8%</span>
                                            </div>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <div class="flex items-center">
                                                <span class="text-sm text-gray-900">8.7 days</span>
                                                <span class="ml-2 text-xs text-green-600">▼ 1.2</span>
                                            </div>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                Moderate
                                            </span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <div class="flex items-center">
                                                <span class="text-sm text-gray-900">2.1hrs</span>
                                                <span class="ml-2 text-xs text-red-600">▲ 0.4hrs</span>
                                            </div>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">
                                                Low
                                            </span>
                                        </td>
                                    </tr>
                                    
                                    <tr class="hover:bg-gray-50">
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <div class="text-sm font-medium text-gray-900">Professional Services</div>
                                            <div class="text-sm text-gray-500">Consulting, Legal, Finance</div>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">$286K</td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <div class="flex items-center">
                                                <span class="text-sm text-gray-900">89.3%</span>
                                                <span class="ml-2 text-xs text-red-600">▼ 1.7%</span>
                                            </div>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <div class="flex items-center">
                                                <span class="text-sm text-gray-900">15.8 days</span>
                                                <span class="ml-2 text-xs text-red-600">▲ 2.1</span>
                                            </div>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-gray-100 text-gray-800">
                                                N/A
                                            </span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <div class="flex items-center">
                                                <span class="text-sm text-gray-900">3.7hrs</span>
                                                <span class="ml-2 text-xs text-yellow-600">▲ 0.2hrs</span>
                                            </div>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                Medium
                                            </span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Supplier Responsiveness & Inventory Levels -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <!-- Supplier Responsiveness -->
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
                            <div class="px-6 py-4 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-900">Supplier Portal Responsiveness</h3>
                                <p class="text-sm text-gray-500">Average response time to requests</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-4">
                                    <div class="flex items-center justify-between">
                                        <span class="text-sm font-medium text-gray-900">Information Requests</span>
                                        <span class="text-lg font-semibold text-gray-900">2.4 hrs</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                        <div class="bg-green-500 h-2 rounded-full" style="width: 85%"></div>
                                    </div>
                                    
                                    <div class="flex items-center justify-between">
                                        <span class="text-sm font-medium text-gray-900">PO Acknowledgments</span>
                                        <span class="text-lg font-semibold text-gray-900">1.8 hrs</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                        <div class="bg-green-500 h-2 rounded-full" style="width: 92%"></div>
                                    </div>
                                    
                                    <div class="flex items-center justify-between">
                                        <span class="text-sm font-medium text-gray-900">Quote Requests</span>
                                        <span class="text-lg font-semibold text-gray-900">6.2 hrs</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                        <div class="bg-yellow-500 h-2 rounded-full" style="width: 68%"></div>
                                    </div>
                                    
                                    <div class="flex items-center justify-between">
                                        <span class="text-sm font-medium text-gray-900">Issue Escalations</span>
                                        <span class="text-lg font-semibold text-gray-900">4.1 hrs</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                        <div class="bg-orange-500 h-2 rounded-full" style="width: 75%"></div>
                                    </div>
                                </div>
                                
                                <div class="mt-6 p-4 bg-blue-50 rounded-lg">
                                    <div class="flex items-center">
                                        <span class="text-blue-600 text-sm">💡</span>
                                        <div class="ml-2">
                                            <p class="text-sm font-medium text-blue-800">Improvement Opportunity</p>
                                            <p class="text-xs text-blue-600">Quote responses are 15% slower than target SLA</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Inventory Levels -->
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
                            <div class="px-6 py-4 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-900">Inventory Level Analysis</h3>
                                <p class="text-sm text-gray-500">Current stock status by commodity</p>
                            </div>
                            <div class="p-6">
                                <div class="space-y-6">
                                    <div>
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="text-sm font-medium text-gray-900">Raw Materials</span>
                                            <div class="text-right">
                                                <div class="text-sm font-medium text-gray-900">$614K</div>
                                                <div class="text-xs text-red-600">Above target</div>
                                            </div>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-3">
                                            <div class="bg-red-400 h-3 rounded-full" style="width: 85%"></div>
                                        </div>
                                        <div class="text-xs text-gray-500 mt-1">85% of max capacity</div>
                                    </div>
                                    
                                    <div>
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="text-sm font-medium text-gray-900">Technology Components</span>
                                            <div class="text-right">
                                                <div class="text-sm font-medium text-gray-900">$228K</div>
                                                <div class="text-xs text-green-600">Optimal range</div>
                                            </div>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-3">
                                            <div class="bg-green-400 h-3 rounded-full" style="width: 62%"></div>
                                        </div>
                                        <div class="text-xs text-gray-500 mt-1">62% of max capacity</div>
                                    </div>
                                    
                                    <div>
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="text-sm font-medium text-gray-900">Packaging Materials</span>
                                            <div class="text-right">
                                                <div class="text-sm font-medium text-gray-900">$99K</div>
                                                <div class="text-xs text-yellow-600">Moderate level</div>
                                            </div>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-3">
                                            <div class="bg-yellow-400 h-3 rounded-full" style="width: 45%"></div>
                                        </div>
                                        <div class="text-xs text-gray-500 mt-1">45% of max capacity</div>
                                    </div>
                                    
                                    <div>
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="text-sm font-medium text-gray-900">Office Supplies</span>
                                            <div class="text-right">
                                                <div class="text-sm font-medium text-gray-900">$37K</div>
                                                <div class="text-xs text-orange-600">Below target</div>
                                            </div>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-3">
                                            <div class="bg-orange-400 h-3 rounded-full" style="width: 28%"></div>
                                        </div>
                                        <div class="text-xs text-gray-500 mt-1">28% of max capacity</div>
                                    </div>
                                </div>
                                
                                <div class="mt-6 text-xs text-gray-500 border-t border-gray-200 pt-4">
                                    <div class="flex items-center space-x-4">
                                        <div class="flex items-center">
                                            <div class="w-3 h-3 bg-green-400 rounded mr-1"></div>
                                            <span>Optimal (50-70%)</span>
                                        </div>
                                        <div class="flex items-center">
                                            <div class="w-3 h-3 bg-red-400 rounded mr-1"></div>
                                            <span>Excess (>75%)</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            
            <!-- ERP Integration -->
            <div id="erp-integration-content" class="content-page">
                <div class="p-8">
                    <div class="flex items-center justify-between mb-8">
                        <div>
                            <h1 class="text-3xl font-bold text-gray-900">ERP Integration</h1>
                            <p class="text-gray-600">Connect and sync with your enterprise systems</p>
                        </div>
                        <div class="flex space-x-3">
                            <button onclick="testConnection()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 font-medium transition-colors">
                                🔌 Test Connection
                            </button>
                            <button onclick="syncData()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 font-medium transition-colors">
                                🔄 Sync Data
                            </button>
                        </div>
                    </div>

                    <!-- ERP Systems Overview -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                                    <span class="text-green-600 text-xl">✅</span>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">Connected</p>
                                    <p class="text-2xl font-semibold text-gray-900">4</p>
                                    <p class="text-xs text-green-600">Active integrations</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                    <span class="text-blue-600 text-xl">🔄</span>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">Last Sync</p>
                                    <p class="text-lg font-semibold text-gray-900">2 min ago</p>
                                    <p class="text-xs text-blue-600">Automatic</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                                    <span class="text-purple-600 text-xl">📊</span>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">Records Synced</p>
                                    <p class="text-2xl font-semibold text-gray-900">1,247</p>
                                    <p class="text-xs text-purple-600">Today</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center">
                                    <span class="text-orange-600 text-xl">⚡</span>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">API Health</p>
                                    <p class="text-lg font-semibold text-gray-900">99.9%</p>
                                    <p class="text-xs text-orange-600">Uptime</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ERP Systems Grid -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                        <!-- SAP S/4HANA -->
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <div class="flex items-center justify-between mb-4">
                                <div class="flex items-center">
                                    <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                        <span class="text-blue-600 font-bold text-lg">SAP</span>
                                    </div>
                                    <div class="ml-4">
                                        <h3 class="text-lg font-semibold text-gray-900">SAP S/4HANA</h3>
                                        <p class="text-sm text-gray-500">Production Environment</p>
                                    </div>
                                </div>
                                <span class="bg-green-100 text-green-800 text-xs font-medium px-2 py-1 rounded-full">
                                    ✅ Connected
                                </span>
                            </div>
                            <div class="space-y-3">
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-600">Last Sync:</span>
                                    <span class="text-gray-900">2 minutes ago</span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-600">Records:</span>
                                    <span class="text-gray-900">847 POs, 234 Suppliers</span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-600">API Version:</span>
                                    <span class="text-gray-900">OData v4</span>
                                </div>
                                <button onclick="configureERP('sap')" class="w-full bg-blue-50 text-blue-600 px-4 py-2 rounded-lg hover:bg-blue-100 font-medium transition-colors">
                                    ⚙️ Configure Mapping
                                </button>
                            </div>
                        </div>

                        <!-- NetSuite -->
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <div class="flex items-center justify-between mb-4">
                                <div class="flex items-center">
                                    <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center">
                                        <span class="text-orange-600 font-bold text-lg">NS</span>
                                    </div>
                                    <div class="ml-4">
                                        <h3 class="text-lg font-semibold text-gray-900">NetSuite</h3>
                                        <p class="text-sm text-gray-500">SuiteApp Integration</p>
                                    </div>
                                </div>
                                <span class="bg-green-100 text-green-800 text-xs font-medium px-2 py-1 rounded-full">
                                    ✅ Connected
                                </span>
                            </div>
                            <div class="space-y-3">
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-600">Last Sync:</span>
                                    <span class="text-gray-900">5 minutes ago</span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-600">Records:</span>
                                    <span class="text-gray-900">123 POs, 89 Vendors</span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-600">API Version:</span>
                                    <span class="text-gray-900">RESTlets 2.1</span>
                                </div>
                                <button onclick="configureERP('netsuite')" class="w-full bg-orange-50 text-orange-600 px-4 py-2 rounded-lg hover:bg-orange-100 font-medium transition-colors">
                                    ⚙️ Configure Mapping
                                </button>
                            </div>
                        </div>

                        <!-- Epicor -->
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <div class="flex items-center justify-between mb-4">
                                <div class="flex items-center">
                                    <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                                        <span class="text-purple-600 font-bold text-lg">EP</span>
                                    </div>
                                    <div class="ml-4">
                                        <h3 class="text-lg font-semibold text-gray-900">Epicor ERP</h3>
                                        <p class="text-sm text-gray-500">Kinetic Platform</p>
                                    </div>
                                </div>
                                <span class="bg-yellow-100 text-yellow-800 text-xs font-medium px-2 py-1 rounded-full">
                                    ⚙️ Configuring
                                </span>
                            </div>
                            <div class="space-y-3">
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-600">Status:</span>
                                    <span class="text-gray-900">Testing Connection</span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-600">Progress:</span>
                                    <span class="text-gray-900">75% Complete</span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-600">API Version:</span>
                                    <span class="text-gray-900">REST v2</span>
                                </div>
                                <button onclick="configureERP('epicor')" class="w-full bg-purple-50 text-purple-600 px-4 py-2 rounded-lg hover:bg-purple-100 font-medium transition-colors">
                                    🔧 Complete Setup
                                </button>
                            </div>
                        </div>

                        <!-- Microsoft Dynamics -->
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                            <div class="flex items-center justify-between mb-4">
                                <div class="flex items-center">
                                    <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                                        <span class="text-green-600 font-bold text-lg">BC</span>
                                    </div>
                                    <div class="ml-4">
                                        <h3 class="text-lg font-semibold text-gray-900">Dynamics 365 BC</h3>
                                        <p class="text-sm text-gray-500">Business Central</p>
                                    </div>
                                </div>
                                <span class="bg-green-100 text-green-800 text-xs font-medium px-2 py-1 rounded-full">
                                    ✅ Connected
                                </span>
                            </div>
                            <div class="space-y-3">
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-600">Last Sync:</span>
                                    <span class="text-gray-900">1 minute ago</span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-600">Records:</span>
                                    <span class="text-gray-900">277 POs, 156 Vendors</span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-600">API Version:</span>
                                    <span class="text-gray-900">OData v4</span>
                                </div>
                                <button onclick="configureERP('dynamics')" class="w-full bg-green-50 text-green-600 px-4 py-2 rounded-lg hover:bg-green-100 font-medium transition-colors">
                                    ⚙️ Configure Mapping
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Data Mapping Configuration -->
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
                        <div class="px-6 py-4 border-b border-gray-200">
                            <h3 class="text-lg font-medium text-gray-900">Field Mapping Configuration</h3>
                            <p class="text-sm text-gray-600">Configure how data flows between systems</p>
                        </div>
                        <div class="p-6">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                <div class="space-y-4">
                                    <h4 class="font-medium text-gray-900">Purchase Orders</h4>
                                    <div class="space-y-2 text-sm">
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">PO Number:</span>
                                            <span class="text-green-600">✅ Mapped</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Supplier ID:</span>
                                            <span class="text-green-600">✅ Mapped</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Line Items:</span>
                                            <span class="text-green-600">✅ Mapped</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Approval Status:</span>
                                            <span class="text-green-600">✅ Mapped</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="space-y-4">
                                    <h4 class="font-medium text-gray-900">Suppliers</h4>
                                    <div class="space-y-2 text-sm">
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Vendor Code:</span>
                                            <span class="text-green-600">✅ Mapped</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Company Name:</span>
                                            <span class="text-green-600">✅ Mapped</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Contact Info:</span>
                                            <span class="text-green-600">✅ Mapped</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Payment Terms:</span>
                                            <span class="text-yellow-600">⚠️ Partial</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="space-y-4">
                                    <h4 class="font-medium text-gray-900">Invoices</h4>
                                    <div class="space-y-2 text-sm">
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Invoice Number:</span>
                                            <span class="text-green-600">✅ Mapped</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Amount:</span>
                                            <span class="text-green-600">✅ Mapped</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Due Date:</span>
                                            <span class="text-green-600">✅ Mapped</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Tax Information:</span>
                                            <span class="text-red-600">❌ Not Mapped</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mt-6 flex space-x-4">
                                <button onclick="exportMapping()" class="bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 font-medium transition-colors">
                                    📄 Export Mapping
                                </button>
                                <button onclick="importMapping()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 font-medium transition-colors">
                                    📥 Import Mapping
                                </button>
                                <button onclick="resetMapping()" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 font-medium transition-colors">
                                    🔄 Reset to Default
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="settings-content" class="content-page">
                <div class="p-8">
                    <h1 class="text-3xl font-bold text-gray-900 mb-8">Settings</h1>
                    <div class="bg-blue-50 border border-blue-200 rounded-xl p-6">
                        <h3 class="text-lg font-medium text-blue-900 mb-4">Sync'd MVP Demo</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <h4 class="font-semibold text-blue-800 mb-2"> Implemented Features</h4>
                                <ul class="text-sm text-blue-700 space-y-1">
                                    <li> Full-screen login gateway</li>
                                    <li> Updated logo with chain links and gradient</li>
                                    <li> Correct tagline: "Supply Chain. Perfected. Sync'd."</li>
                                    <li> Clean white and blue modern theme</li>
                                    <li> Complete PO management workflow</li>
                                    <li> Approval workflows with notifications</li>
                                    <li> Proper page navigation</li>
                                    <li> Responsive design</li>
                                </ul>
                            </div>
                            <div>
                                <h4 class="font-semibold text-blue-800 mb-2"> Technical Stack</h4>
                                <ul class="text-sm text-blue-700 space-y-1">
                                    <li> Next.js + TypeScript architecture</li>
                                    <li> Tailwind CSS styling</li>
                                    <li> ERP adapter pattern</li>
                                    <li> Zustand state management</li>
                                    <li> Component-based UI</li>
                                    <li> Mock data for demonstration</li>
                                    <li> Production-ready structure</li>
                                </ul>
                            </div>
                        </div>
                        <div class="mt-6 flex space-x-4">
                            <button onclick="resetDemoData()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 font-medium transition-colors">
                                 Reset Demo Data
                            </button>
                            <button onclick="showToast('Ready for first customer! ', 'success')" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 font-medium transition-colors">
                                 Production Ready
                            </button>
                        </div>
                    </div>
                </div>
            </div>

    <!-- Application JavaScript Modules -->
    <script type="module" src="./src/js/app.js"></script>
    <script>
        // Legacy code for backwards compatibility
        const mockPOs = [
            {
                id: 'PO-2024-001',
                supplier: 'Industrial Solutions Inc',
                status: 'acknowledged',
                total: 49100.00,
                needBy: '2024-03-15',
                progress: 65,
                currency: 'USD'
            },
            {
                id: 'PO-2024-002',
                supplier: 'TechSource Global',
                status: 'pending-approval',
                total: 27000.00,
                needBy: '2024-03-20',
                progress: 10,
                currency: 'USD'
            },
            {
                id: 'PO-2024-003',
                supplier: 'European Logistics Ltd',
                status: 'draft',
                total: 16700.00,
                needBy: '2024-04-01',
                progress: 5,
                currency: 'EUR'
            },
            {
                id: 'PO-2024-044',
                supplier: 'Industrial Solutions Inc',
                status: 'delivered',
                total: 85200.00,
                needBy: '2024-03-10',
                progress: 100,
                currency: 'USD'
            },
            {
                id: 'PO-2024-045',
                supplier: 'TechSource Global',
                status: 'shipped',
                total: 32750.00,
                needBy: '2024-03-18',
                progress: 90,
                currency: 'USD'
            }
        ];

        // Authentication functions
        function handleLogin(event) {
            event.preventDefault();
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            if (email === 'demo@demo.com' && password === 'demo') {
                showApp();
                showToast('Welcome to Sync\'d! Ready for your first customer ', 'success');
            } else {
                showToast('Invalid credentials. Use demo@demo.com / demo', 'error');
            }
        }

        function handleDemoLogin() {
            document.getElementById('email').value = 'demo@demo.com';
            document.getElementById('password').value = 'demo';
            showApp();
            showToast('Demo login successful! Platform ready to deploy ', 'success');
        }

        function handleLogout() {
            // Hide app and show login
            const appContainer = document.getElementById('app-container');
            
            // Hide the app container completely
            appContainer.style.display = 'none';
            appContainer.classList.remove('active', 'app-fade-in');
            
            // Completely reset the login container state
            resetLoginContainer();
            
            // Clear any input values and reset
            document.getElementById('email').value = 'demo@demo.com';
            document.getElementById('password').value = 'demo';
            
            showToast('Logged out successfully. See you next time! 👋', 'info');
        }

        function showApp() {
            // Hide login and show app with smooth transition
            const loginContainer = document.getElementById('login-container');
            const appContainer = document.getElementById('app-container');
            
            // Add fade out animation
            loginContainer.classList.add('login-fade-out');
            
            setTimeout(() => {
                // Hide login container completely
                loginContainer.classList.add('hidden');
                loginContainer.style.display = 'none';
                
                // Show app container
                appContainer.style.display = 'block';
                appContainer.classList.add('active', 'app-fade-in');
                
                // Update app state
                updateLastUpdated();
                
                // Initialize all pages to hidden state first
                const allPages = document.querySelectorAll('.content-page');
                allPages.forEach(page => {
                    page.classList.remove('active');
                    page.style.display = 'none';
                    page.style.visibility = 'hidden';
                    page.style.opacity = '0';
                });
                
                // Set initial page to Dashboard
                const dashboardPage = document.getElementById('dashboard-content');
                if (dashboardPage) {
                    dashboardPage.style.display = 'block';
                    dashboardPage.style.visibility = 'visible';
                    dashboardPage.style.opacity = '1';
                    dashboardPage.classList.add('active');
                }
                
                // Initialize horizontal navigation state
                updateHorizontalNavActive('dashboard');
            }, 500);
        }

        // Fixed navigation function
        function showPage(pageId) {
            console.log('showPage called for:', pageId);
            
            // Hide all content pages first
            const allPages = document.querySelectorAll('.content-page');
            console.log('Found pages:', allPages.length);
            
            try {
                allPages.forEach((page, index) => {
                    console.log(`Hiding page ${index}: ${page.id}`);
                    page.classList.remove('active');
                    page.style.display = 'none';
                    page.style.visibility = 'hidden';
                    page.style.opacity = '0';
                    page.style.position = '';
                    page.style.zIndex = '';
                });
                console.log('All pages hidden successfully');
            } catch (error) {
                console.error('Error hiding pages:', error);
            }
            
            // Show target page immediately
            console.log('Looking for target page:', pageId + '-content');
            const targetPage = document.getElementById(pageId + '-content');
            console.log('Target page found:', !!targetPage, targetPage);
            if (targetPage) {
                // Set all display properties directly with force
                targetPage.style.setProperty('display', 'block', 'important');
                targetPage.style.setProperty('visibility', 'visible', 'important');
                targetPage.style.setProperty('opacity', '1', 'important');
                targetPage.style.setProperty('position', 'relative', 'important');
                targetPage.style.setProperty('z-index', '1', 'important');
                targetPage.classList.add('active');
                
                // Force browser reflow multiple times
                targetPage.offsetHeight;
                targetPage.offsetWidth;
                targetPage.scrollTop;
                
                console.log('Page visibility after setting:', {
                    display: getComputedStyle(targetPage).display,
                    visibility: getComputedStyle(targetPage).visibility,
                    opacity: getComputedStyle(targetPage).opacity
                });
                
                // Special handling for pages that need initialization
                if (pageId === 'projects') {
                    setTimeout(() => {
                        initializeChartsIfNeeded();
                    }, 300);
                } else if (pageId === 'analytics') {
                    setTimeout(() => {
                        initializeAnalyticsPage();
                    }, 100);
                } else if (pageId === 'erp-integration') {
                    setTimeout(() => {
                        initializeERPIntegrationPage();
                    }, 100);
                }
            } else {
                console.error('Page not found:', pageId + '-content');
            }
        }

        // OLD PO Management functions REMOVED - Using new renderPOTable() system

        // Approval functions
        function approvePO(poId) {
            showToast(`PO ${poId} approved successfully! `, 'success');
            // Update the badge count
            const badge = document.querySelector('.nav-item span.bg-red-100');
            if (badge) {
                const count = parseInt(badge.textContent) - 1;
                badge.textContent = count;
                if (count === 0) badge.style.display = 'none';
            }
        }

        function rejectPO(poId) {
            const reason = prompt('Please provide a reason for rejection:');
            if (reason) {
                showToast(`PO ${poId} rejected: ${reason} `, 'error');
            }
        }

        function viewPODetails(poId) {
            showToast(`Opening details for ${poId} `, 'info');
        }

        function editPO(poId) {
            showToast(`Opening editor for ${poId} `, 'info');
        }

        function showCreatePOWizard() {
            showToast('PO creation wizard ready! Perfect for first customer demos ', 'info');
        }

        // Utility functions
        function exportPOs() {
            showToast('CSV export ready for production! ', 'info');
        }

        function resetDemoData() {
            showToast('Demo data reset - ready for next customer presentation! 🔄', 'success');
            // Reset PO data and re-render
            currentPOData = [...purchaseOrdersData];
            renderPOTable();
        }

        // ERP Integration functions
        function testConnection() {
            showToast('Testing all ERP connections... ✅ All systems healthy!', 'success');
        }

        function syncData() {
            showToast('Syncing data across all connected ERPs... 🔄 Complete!', 'success');
        }

        // Initialize ERP Integration page when first accessed
        function initializeERPIntegrationPage() {
            console.log('Initializing ERP Integration page...');
            
            // Force refresh of any dynamic content
            const erpPage = document.getElementById('erp-integration-content');
            if (erpPage) {
                // Force browser reflow to ensure proper rendering
                erpPage.offsetHeight;
                erpPage.offsetWidth;
                
                // Ensure all elements are properly visible
                const elements = erpPage.querySelectorAll('*');
                elements.forEach(el => {
                    if (el.style.display === 'none') {
                        el.style.display = '';
                    }
                });
                
                // Update connection status indicators
                updateERPConnectionStatus();
                
                // Small animation to ensure smooth transition
                erpPage.style.opacity = '0.95';
                setTimeout(() => {
                    erpPage.style.opacity = '1';
                }, 100);
            }
            
            console.log('ERP Integration page initialized successfully');
        }

        // Update ERP connection status displays
        function updateERPConnectionStatus() {
            const statusElements = document.querySelectorAll('#erp-integration-content .text-green-600, #erp-integration-content .text-blue-600');
            statusElements.forEach(element => {
                // Force a refresh of any dynamic status content
                if (element.textContent.includes('min ago')) {
                    element.textContent = Math.floor(Math.random() * 5) + ' min ago';
                }
            });
        }

        function configureERP(erpSystem) {
            const systemNames = {
                'sap': 'SAP S/4HANA',
                'netsuite': 'NetSuite',
                'epicor': 'Epicor ERP',
                'dynamics': 'Dynamics 365 BC'
            };
            showToast(`Opening ${systemNames[erpSystem]} configuration... ⚙️`, 'info');
        }

        function exportMapping() {
            showToast('Exporting field mapping configuration... 📄 Downloaded!', 'success');
        }

        function importMapping() {
            showToast('Import mapping configuration... 📥 Ready for upload!', 'info');
        }

        function resetMapping() {
            if (confirm('Are you sure you want to reset all field mappings to default?')) {
                showToast('Field mappings reset to default configuration! 🔄', 'success');
            }
        }

        // Supplier Portal functions
        function showPortalTab(tabId) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.portal-tab-content');
            tabContents.forEach(content => content.classList.add('hidden'));
            
            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.portal-tab');
            tabs.forEach(tab => {
                tab.classList.remove('active', 'border-blue-500', 'text-blue-600');
                tab.classList.add('border-transparent', 'text-gray-500');
            });
            
            // Show selected tab content
            const selectedContent = document.getElementById(`portal-${tabId}`);
            if (selectedContent) {
                selectedContent.classList.remove('hidden');
            }
            
            // Add active class to selected tab
            const selectedTab = document.getElementById(`tab-${tabId}`);
            if (selectedTab) {
                selectedTab.classList.add('active', 'border-blue-500', 'text-blue-600');
                selectedTab.classList.remove('border-transparent', 'text-gray-500');
            }
        }

        function acknowledgePO(poId) {
            showToast(`PO ${poId} acknowledged successfully! ✅`, 'success');
        }

        function updateShipment(poId) {
            showToast(`Opening shipment update for ${poId}... 🚚`, 'info');
        }

        function submitInvoice(poId) {
            showToast(`Opening invoice submission for ${poId}... 📄`, 'info');
        }

        function exportSupplierPOs() {
            showToast('Exporting supplier POs to CSV... 📊 Downloaded!', 'success');
        }

        function newRequest() {
            showToast('Opening new request form... 💬', 'info');
        }

        function respondToRequest(reqId) {
            showToast(`Opening response form for ${reqId}... 📝`, 'info');
        }

        function viewRequestDetails(reqId) {
            showToast(`Opening details for ${reqId}... 👁️`, 'info');
        }

        function createASN() {
            showToast('Opening ASN creation form... 📋', 'info');
        }

        function updateShipmentStatus(shipmentId) {
            showToast(`Updating status for ${shipmentId}... 🔄`, 'info');
        }

        function downloadPOD(shipmentId) {
            showToast(`Downloading POD for ${shipmentId}... 📄`, 'success');
        }

        function uploadInvoice() {
            showToast('Opening invoice upload dialog... 📤', 'info');
        }

        function composeMessage() {
            showToast('Opening message composer... ✏️', 'info');
        }

        function replyToMessage(msgId) {
            showToast(`Replying to message ${msgId}... 💬`, 'info');
        }

        // Analytics functions
        function exportAnalytics() {
            showToast('Exporting analytics report... 📊 Downloaded!', 'success');
        }

        // Initialize Analytics page when first accessed
        function initializeAnalyticsPage() {
            console.log('Initializing Analytics page...');
            
            // Force refresh of any dynamic content
            const analyticsPage = document.getElementById('analytics-content');
            if (analyticsPage) {
                // Force browser reflow to ensure proper rendering
                analyticsPage.offsetHeight;
                analyticsPage.offsetWidth;
                
                // Ensure all elements are properly visible
                const elements = analyticsPage.querySelectorAll('*');
                elements.forEach(el => {
                    if (el.style.display === 'none') {
                        el.style.display = '';
                    }
                });
                
                // Update any time-sensitive data
                updateLastUpdated();
                
                // Small animation to ensure smooth transition
                analyticsPage.style.opacity = '0.95';
                setTimeout(() => {
                    analyticsPage.style.opacity = '1';
                }, 100);
            }
            
            console.log('Analytics page initialized successfully');
        }

        function updateLastUpdated() {
            const element = document.getElementById('last-updated');
            if (element) {
                element.textContent = new Date().toLocaleTimeString();
            }
        }

        function showToast(message, type = 'info') {
            // Simple toast implementation
            const toast = document.createElement('div');
            const bgColor = {
                success: 'bg-green-500',
                error: 'bg-red-500',
                info: 'bg-blue-500',
                warning: 'bg-yellow-500'
            }[type] || 'bg-blue-500';
            
            toast.className = `fixed top-4 right-4 ${bgColor} text-white px-6 py-3 rounded-lg shadow-lg z-50 transform transition-transform duration-300 translate-x-full max-w-sm`;
            toast.textContent = message;
            
            document.body.appendChild(toast);
            
            // Animate in
            setTimeout(() => toast.classList.remove('translate-x-full'), 100);
            
            // Remove after 4 seconds
            setTimeout(() => {
                toast.classList.add('translate-x-full');
                setTimeout(() => {
                    if (document.body.contains(toast)) {
                        document.body.removeChild(toast);
                    }
                }, 300);
            }, 4000);
        }

        // Savings Tracker Configuration and Functions - Based on Actual PO Data
        const savingsConfig = {
            // Based on 335 POs with $2.4M total spend
            totalPOsProcessed: 335,
            totalSpend: 2400000,
            avgPOTotal: 7164,        // $2.4M / 335 POs
            avgLinesPerPO: 6.2,      // Average from our generated data
            
            // Realistic monthly volumes (335 POs over ~14 months from Jan 2023)
            posPerMonth: 24,         // 335 POs / 14 months = ~24 POs/month
            monthlySpend: 171428,    // $2.4M / 14 months
            
            // Time and cost savings per PO (realistic for procurement automation)
            beforeTimeMinutes: 48,
            afterTimeMinutes: 16,
            timeSavingsMinutes: 32,
            laborRatePerHour: 55,
            
            // Cost breakdown per PO
            beforeLaborCost: 44,      // (48/60) * 55
            afterLaborCost: 14.67,    // (16/60) * 55
            beforeOverhead: 12,       // Manual process overhead
            afterOverhead: 4,         // Automated process overhead
            beforeTotalCost: 56,
            afterTotalCost: 19,
            savingsPerPO: 37,         // $37 savings per PO processed
            
            // Actual total savings from all 335 POs
            totalSavingsAchieved: 12395,  // 335 POs * $37 = $12,395 (matches dashboard)
            
            // Implementation timeline (since Jan 2023)
            implementationStartDate: '2023-01-02',
            daysSinceImplementation: Math.floor((new Date() - new Date('2023-01-02')) / (1000 * 60 * 60 * 24))
        };

        function calculateSavings() {
            const config = savingsConfig;
            
            // Use actual processed POs (335) for accurate calculations
            const posProcessed = config.totalPOsProcessed;
            const daysActive = config.daysSinceImplementation;
            
            return {
                // Primary metrics based on actual data
                totalSavings: config.totalSavingsAchieved,
                posProcessed: posProcessed,
                
                // Spend metrics
                totalSpend: config.totalSpend,
                avgPOValue: config.avgPOTotal,
                
                // Time-based projections
                monthlySavings: config.totalSavingsAchieved / (daysActive / 30.44), // Actual monthly rate
                weeklySavings: config.totalSavingsAchieved / (daysActive / 7), // Actual weekly rate
                dailySavings: config.totalSavingsAchieved / daysActive, // Actual daily rate
                dailyAverage: config.totalSavingsAchieved / daysActive,
                
                // Detailed breakdown
                laborSavings: posProcessed * (config.beforeLaborCost - config.afterLaborCost),
                overheadSavings: posProcessed * (config.beforeOverhead - config.afterOverhead),
                timeSavedHours: posProcessed * (config.timeSavingsMinutes / 60),
                
                // Process efficiency metrics
                processingRatePerMonth: posProcessed / (daysActive / 30.44),
                savingsRatePercentage: (config.totalSavingsAchieved / config.totalSpend * 100),
                
                // Future projections (if volume continues)
                projectedMonthlySavings: config.posPerMonth * config.savingsPerPO,
                projectedAnnualSavings: config.posPerMonth * 12 * config.savingsPerPO
            };
        }

        function updateSavingsDisplay() {
            const timeframeEl = document.getElementById('savingsTimeframe');
            const timeframe = timeframeEl ? timeframeEl.value : 'total';
            const savings = calculateSavings();
            const totalSavingsEl = document.getElementById('totalSavings');
            const savingsRateEl = document.getElementById('savingsRate');
            
            let displayValue, rateText;
            
            switch(timeframe) {
                case 'monthly':
                    displayValue = `$${Math.round(savings.monthlySavings).toLocaleString()}`;
                    rateText = '+$' + Math.round(savings.dailySavings).toLocaleString() + '/day';
                    break;
                case 'weekly':
                    displayValue = `$${Math.round(savings.weeklySavings).toLocaleString()}`;
                    rateText = '+$' + Math.round(savings.dailySavings).toLocaleString() + '/day';
                    break;
                case 'daily':
                    displayValue = `$${Math.round(savings.dailySavings).toLocaleString()}`;
                    rateText = '+$' + Math.round(savings.dailySavings / 24).toLocaleString() + '/hour';
                    break;
                default: // total
                    displayValue = `$${Math.round(savings.totalSavings).toLocaleString()}`;
                    rateText = '+$' + Math.round(savings.dailyAverage).toLocaleString() + '/day avg';
            }
            
            if (totalSavingsEl) totalSavingsEl.textContent = displayValue;
            if (savingsRateEl) savingsRateEl.textContent = rateText;
            
            // Also update PO Management section savings displays
            updatePOSavingsDisplays(savings);
            
            // Update other savings displays throughout the application
            updateAllSavingsDisplays(savings);
        }

        function updatePOSavingsDisplays(savings) {
            // Update PO Management Sync'd Impact section with calculated values
            const poImpactSavings = document.getElementById('po-impact-savings');
            const poDetailedSavings = document.getElementById('po-detailed-savings');
            const poDailyAvg = document.getElementById('po-daily-avg');
            
            // Update main impact display
            if (poImpactSavings) {
                poImpactSavings.textContent = `$${Math.round(savings.totalSavings).toLocaleString()}`;
            }
            
            // Update detailed breakdown
            if (poDetailedSavings) {
                poDetailedSavings.textContent = `$${Math.round(savings.totalSavings).toLocaleString()}`;
            }
            
            if (poDailyAvg) {
                poDailyAvg.textContent = `+$${Math.round(savings.dailyAverage).toLocaleString()}/day avg`;
            }
            
            // Update breakdown by category (based on our calculated total)
            const totalSavings = savings.totalSavings;
            const processAutoEl = document.getElementById('po-process-auto');
            const supplierMgmtEl = document.getElementById('po-supplier-mgmt');
            const contractOptEl = document.getElementById('po-contract-opt');
            const dataAnalyticsEl = document.getElementById('po-data-analytics');
            
            // Distribute savings proportionally (50% process auto, 30% supplier mgmt, 13.5% contract opt, 6.5% data analytics)
            if (processAutoEl) processAutoEl.textContent = `$${Math.round(totalSavings * 0.50).toLocaleString()}`;
            if (supplierMgmtEl) supplierMgmtEl.textContent = `$${Math.round(totalSavings * 0.30).toLocaleString()}`;
            if (contractOptEl) contractOptEl.textContent = `$${Math.round(totalSavings * 0.135).toLocaleString()}`;
            if (dataAnalyticsEl) dataAnalyticsEl.textContent = `$${Math.round(totalSavings * 0.065).toLocaleString()}`;
        }

        function updateAllSavingsDisplays(savings) {
            // Update all other platform savings displays throughout the app
            const platformSavingsBreakdown = document.getElementById('platform-savings-breakdown');
            const platformAutomationSavings = document.getElementById('platform-automation-savings');
            
            if (platformSavingsBreakdown) {
                platformSavingsBreakdown.textContent = `$${Math.round(savings.totalSavings).toLocaleString()}`;
            }
            
            if (platformAutomationSavings) {
                platformAutomationSavings.textContent = `$${Math.round(savings.totalSavings).toLocaleString()}`;
            }
        }

        function openApprovalDetails(poId, supplier, amount, description, requestedBy, priority) {
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.innerHTML = `
                <div class="bg-white rounded-xl shadow-xl max-w-5xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                    <div class="p-6 border-b border-gray-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <h2 class="text-2xl font-bold text-gray-900">Purchase Order ${poId}</h2>
                                <p class="text-gray-600 mt-1">${supplier} • ${amount} • Priority: ${priority}</p>
                            </div>
                            <button onclick="this.closest('.modal').remove()" class="text-gray-400 hover:text-gray-600">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    
                    <div class="p-6">
                        <!-- Approval Actions -->
                        <div class="bg-gray-50 rounded-lg p-4 mb-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h3 class="text-lg font-semibold text-gray-900">Approval Decision</h3>
                                    <p class="text-sm text-gray-600">Review the purchase order and make your decision</p>
                                </div>
                                <div class="flex space-x-3">
                                    <button onclick="processApproval('${poId}', 'approved')" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 font-medium transition-colors">
                                        ✓ Approve
                                    </button>
                                    <button onclick="processApproval('${poId}', 'rejected')" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700 font-medium transition-colors">
                                        ✗ Reject
                                    </button>
                                    <button onclick="processApproval('${poId}', 'request_info')" class="bg-yellow-600 text-white px-6 py-2 rounded-lg hover:bg-yellow-700 font-medium transition-colors">
                                        ? Request Info
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- PO Details -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                            <div class="bg-white border border-gray-200 rounded-lg p-4">
                                <h4 class="font-semibold text-gray-900 mb-3">Order Information</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">PO Number:</span>
                                        <span class="font-medium">${poId}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Supplier:</span>
                                        <span class="font-medium">${supplier}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Total Amount:</span>
                                        <span class="font-medium text-green-600">${amount}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Requested by:</span>
                                        <span class="font-medium">${requestedBy}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Priority:</span>
                                        <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full ${priority === 'High Priority' ? 'bg-red-100 text-red-800' : priority === 'Rush Order' ? 'bg-purple-100 text-purple-800' : 'bg-blue-100 text-blue-800'}">${priority}</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white border border-gray-200 rounded-lg p-4">
                                <h4 class="font-semibold text-gray-900 mb-3">Budget & Compliance</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Budget Remaining:</span>
                                        <span class="font-medium text-green-600">$485,250</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Approval Level:</span>
                                        <span class="font-medium">Department Manager</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Contract Status:</span>
                                        <span class="font-medium text-green-600">✓ Active</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Compliance:</span>
                                        <span class="font-medium text-green-600">✓ Passed</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Line Items -->
                        <div class="bg-white border border-gray-200 rounded-lg p-4 mb-6">
                            <h4 class="font-semibold text-gray-900 mb-3">Line Items</h4>
                            <div class="overflow-x-auto">
                                <table class="min-w-full">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500">Item</th>
                                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500">Qty</th>
                                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500">Unit Price</th>
                                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500">Total</th>
                                        </tr>
                                    </thead>
                                    <tbody class="divide-y divide-gray-200">
                                        <tr>
                                            <td class="px-4 py-2 text-sm">${description}</td>
                                            <td class="px-4 py-2 text-sm">1</td>
                                            <td class="px-4 py-2 text-sm">${amount}</td>
                                            <td class="px-4 py-2 text-sm font-medium">${amount}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <!-- Approval History -->
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h4 class="font-semibold text-gray-900 mb-3">Approval History</h4>
                            <div class="space-y-3">
                                <div class="flex items-start space-x-3">
                                    <div class="w-2 h-2 bg-blue-500 rounded-full mt-2"></div>
                                    <div>
                                        <div class="text-sm font-medium text-gray-900">Request submitted</div>
                                        <div class="text-xs text-gray-500">By ${requestedBy} • 2 hours ago</div>
                                    </div>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-2 h-2 bg-green-500 rounded-full mt-2"></div>
                                    <div>
                                        <div class="text-sm font-medium text-gray-900">Budget validation passed</div>
                                        <div class="text-xs text-gray-500">Automated check • 2 hours ago</div>
                                    </div>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-2 h-2 bg-yellow-500 rounded-full mt-2"></div>
                                    <div>
                                        <div class="text-sm font-medium text-gray-900">Pending your approval</div>
                                        <div class="text-xs text-gray-500">Assigned to you • Now</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Comments Section -->
                        <div class="mt-6 bg-white border border-gray-200 rounded-lg p-4">
                            <h4 class="font-semibold text-gray-900 mb-3">Comments</h4>
                            <textarea id="approvalComments" placeholder="Add comments for your approval decision..." class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm h-20"></textarea>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        function processApproval(poId, decision) {
            const comments = document.getElementById('approvalComments')?.value || '';
            let message = '';
            let type = 'success';
            
            switch(decision) {
                case 'approved':
                    message = `PO ${poId} approved successfully! ✓ Moving to procurement queue.`;
                    break;
                case 'rejected':
                    message = `PO ${poId} rejected. ✗ Notification sent to requester.`;
                    type = 'error';
                    break;
                case 'request_info':
                    message = `PO ${poId} - Additional information requested. ? Notification sent to requester.`;
                    type = 'warning';
                    break;
            }
            
            // Close the modal
            document.querySelector('.modal')?.remove();
            
            // Show toast
            showToast(message, type);
            
            // Update the approvals page (remove the approved/rejected item)
            if (decision === 'approved' || decision === 'rejected') {
                setTimeout(() => {
                    showToast('Approvals queue updated! Refreshing view...', 'info');
                    // In a real app, this would refresh the data
                }, 2000);
            }
        }

        function openProjectDetails(projectId, projectName, client) {
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.innerHTML = `
                <div class="bg-white rounded-xl shadow-xl max-w-6xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                    <div class="p-6 border-b border-gray-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <h2 class="text-2xl font-bold text-gray-900">${projectName}</h2>
                                <p class="text-gray-600 mt-1">Client: ${client} • Project ID: ${projectId}</p>
                            </div>
                            <button onclick="this.closest('.modal').remove()" class="text-gray-400 hover:text-gray-600">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    
                    <div class="p-6">
                        <!-- Project Overview -->
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
                            <div class="bg-blue-50 rounded-lg p-4 border border-blue-200">
                                <div class="text-blue-600 text-sm font-medium">Project Status</div>
                                <div class="text-2xl font-bold text-blue-900">In Progress</div>
                                <div class="text-blue-600 text-xs">75% Complete</div>
                            </div>
                            <div class="bg-green-50 rounded-lg p-4 border border-green-200">
                                <div class="text-green-600 text-sm font-medium">Baseline Costs</div>
                                <div class="text-2xl font-bold text-green-900">$2.4M</div>
                                <div class="text-green-600 text-xs">Annual procurement</div>
                            </div>
                            <div class="bg-purple-50 rounded-lg p-4 border border-purple-200">
                                <div class="text-purple-600 text-sm font-medium">Target Savings</div>
                                <div class="text-2xl font-bold text-purple-900">$485K</div>
                                <div class="text-purple-600 text-xs">20% reduction</div>
                            </div>
                            <div class="bg-orange-50 rounded-lg p-4 border border-orange-200">
                                <div class="text-orange-600 text-sm font-medium">Time to Value</div>
                                <div class="text-2xl font-bold text-orange-900">12 weeks</div>
                                <div class="text-orange-600 text-xs">Due Apr 15, 2024</div>
                            </div>
                        </div>
                        
                        <!-- Project Timeline -->
                        <div class="bg-gray-50 rounded-lg p-6 mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-4">Project Timeline & Milestones</h3>
                            <div class="space-y-4">
                                <div class="flex items-center">
                                    <div class="w-4 h-4 bg-green-500 rounded-full mr-4"></div>
                                    <div class="flex-1">
                                        <div class="flex justify-between items-center">
                                            <span class="font-medium text-gray-900">Discovery & Assessment</span>
                                            <span class="text-sm text-green-600">Completed</span>
                                        </div>
                                        <div class="text-sm text-gray-500">Current state analysis, baseline establishment</div>
                                    </div>
                                </div>
                                <div class="flex items-center">
                                    <div class="w-4 h-4 bg-green-500 rounded-full mr-4"></div>
                                    <div class="flex-1">
                                        <div class="flex justify-between items-center">
                                            <span class="font-medium text-gray-900">Supplier Analysis</span>
                                            <span class="text-sm text-green-600">Completed</span>
                                        </div>
                                        <div class="text-sm text-gray-500">Vendor evaluation, contract review</div>
                                    </div>
                                </div>
                                <div class="flex items-center">
                                    <div class="w-4 h-4 bg-blue-500 rounded-full mr-4"></div>
                                    <div class="flex-1">
                                        <div class="flex justify-between items-center">
                                            <span class="font-medium text-gray-900">Procurement Strategy</span>
                                            <span class="text-sm text-blue-600">In Progress</span>
                                        </div>
                                        <div class="text-sm text-gray-500">Sourcing strategy, negotiation planning</div>
                                    </div>
                                </div>
                                <div class="flex items-center">
                                    <div class="w-4 h-4 bg-gray-300 rounded-full mr-4"></div>
                                    <div class="flex-1">
                                        <div class="flex justify-between items-center">
                                            <span class="font-medium text-gray-900">Implementation</span>
                                            <span class="text-sm text-gray-500">Pending</span>
                                        </div>
                                        <div class="text-sm text-gray-500">Contract execution, process rollout</div>
                                    </div>
                                </div>
                                <div class="flex items-center">
                                    <div class="w-4 h-4 bg-gray-300 rounded-full mr-4"></div>
                                    <div class="flex-1">
                                        <div class="flex justify-between items-center">
                                            <span class="font-medium text-gray-900">Measurement & Optimization</span>
                                            <span class="text-sm text-gray-500">Pending</span>
                                        </div>
                                        <div class="text-sm text-gray-500">Savings tracking, continuous improvement</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Savings Tracker Configuration -->
                        <div class="bg-white border border-gray-200 rounded-lg p-6 mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-4">Baseline Configuration</h3>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Current Annual Spend</label>
                                    <input type="text" value="$2,400,000" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">POs per Month</label>
                                    <input type="number" value="650" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Current Process Time</label>
                                    <input type="text" value="48 min/PO" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Labor Rate</label>
                                    <input type="text" value="$55/hour" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Error Rate</label>
                                    <input type="text" value="12%" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Target Reduction</label>
                                    <input type="text" value="20%" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm">
                                </div>
                            </div>
                            <div class="mt-4 flex space-x-3">
                                <button onclick="showToast('Baseline configuration saved! 💾', 'success')" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 text-sm">
                                    Save Configuration
                                </button>
                                <button onclick="showToast('Recalculating savings projections... 📊', 'info')" class="bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 text-sm">
                                    Recalculate Projections
                                </button>
                            </div>
                        </div>
                        
                        <!-- Recent Activity -->
                        <div class="bg-gray-50 rounded-lg p-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-4">Recent Project Activity</h3>
                            <div class="space-y-3">
                                <div class="flex items-start space-x-3">
                                    <div class="w-2 h-2 bg-blue-500 rounded-full mt-2"></div>
                                    <div>
                                        <div class="text-sm font-medium text-gray-900">Supplier assessment completed</div>
                                        <div class="text-xs text-gray-500">3 potential vendors identified • 2 hours ago</div>
                                    </div>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-2 h-2 bg-green-500 rounded-full mt-2"></div>
                                    <div>
                                        <div class="text-sm font-medium text-gray-900">Contract negotiation milestone reached</div>
                                        <div class="text-xs text-gray-500">15% cost reduction secured • 1 day ago</div>
                                    </div>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-2 h-2 bg-purple-500 rounded-full mt-2"></div>
                                    <div>
                                        <div class="text-sm font-medium text-gray-900">Stakeholder review scheduled</div>
                                        <div class="text-xs text-gray-500">Progress presentation on Mar 22 • 2 days ago</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        function openSavingsTracker() {
            const savings = calculateSavings();
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.innerHTML = `
                <div class="bg-white rounded-xl shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                    <div class="p-6 border-b border-gray-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <h2 class="text-2xl font-bold text-gray-900">Platform Savings Tracker</h2>
                                <p class="text-gray-600 mt-1">Real-time savings from Sync'd automation</p>
                            </div>
                            <button onclick="this.closest('.modal').remove()" class="text-gray-400 hover:text-gray-600">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    
                    <div class="p-6">
                        <!-- Summary Cards -->
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
                            <div class="bg-green-50 rounded-lg p-4 border border-green-200">
                                <div class="text-green-600 text-sm font-medium">Total Savings</div>
                                <div class="text-2xl font-bold text-green-900">$${Math.round(savings.totalSavings).toLocaleString()}</div>
                                <div class="text-green-600 text-xs">${savings.posProcessed} POs processed</div>
                            </div>
                            <div class="bg-blue-50 rounded-lg p-4 border border-blue-200">
                                <div class="text-blue-600 text-sm font-medium">Monthly Rate</div>
                                <div class="text-2xl font-bold text-blue-900">$${Math.round(savings.monthlySavings).toLocaleString()}</div>
                                <div class="text-blue-600 text-xs">Current average</div>
                            </div>
                            <div class="bg-purple-50 rounded-lg p-4 border border-purple-200">
                                <div class="text-purple-600 text-sm font-medium">Time Saved</div>
                                <div class="text-2xl font-bold text-purple-900">${Math.round(savings.timeSavedHours)}h</div>
                                <div class="text-purple-600 text-xs">32 min/PO saved</div>
                            </div>
                            <div class="bg-orange-50 rounded-lg p-4 border border-orange-200">
                                <div class="text-orange-600 text-sm font-medium">Daily Average</div>
                                <div class="text-2xl font-bold text-orange-900">$${Math.round(savings.dailyAverage).toLocaleString()}</div>
                                <div class="text-orange-600 text-xs">Per business day</div>
                            </div>
                        </div>
                        
                        <!-- Spend Analysis -->
                        <div class="bg-blue-50 rounded-lg p-6 mb-8">
                            <h3 class="text-lg font-semibold text-blue-900 mb-4">Spend Analysis</h3>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div>
                                    <div class="text-blue-600 text-sm font-medium">Total Spend Processed</div>
                                    <div class="text-2xl font-bold text-blue-900">$${(savings.totalSpend / 1000000).toFixed(1)}M</div>
                                    <div class="text-blue-600 text-xs">Across ${savings.posProcessed} POs</div>
                                </div>
                                <div>
                                    <div class="text-blue-600 text-sm font-medium">Average PO Value</div>
                                    <div class="text-2xl font-bold text-blue-900">$${Math.round(savings.avgPOValue).toLocaleString()}</div>
                                    <div class="text-blue-600 text-xs">Per purchase order</div>
                                </div>
                                <div>
                                    <div class="text-blue-600 text-sm font-medium">Savings Rate</div>
                                    <div class="text-2xl font-bold text-blue-900">${savings.savingsRatePercentage.toFixed(2)}%</div>
                                    <div class="text-blue-600 text-xs">Of total spend</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Detailed Breakdown -->
                        <div class="bg-gray-50 rounded-lg p-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-4">Savings Breakdown</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h4 class="font-medium text-gray-900 mb-3">Cost Reduction per PO</h4>
                                    <div class="space-y-2 text-sm">
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Labor cost reduction:</span>
                                            <span class="font-medium">$${(savingsConfig.beforeLaborCost - savingsConfig.afterLaborCost).toFixed(2)}</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Overhead reduction:</span>
                                            <span class="font-medium">$${(savingsConfig.beforeOverhead - savingsConfig.afterOverhead).toFixed(2)}</span>
                                        </div>
                                        <div class="flex justify-between border-t pt-2 font-semibold">
                                            <span>Total per PO:</span>
                                            <span class="text-green-600">$${savingsConfig.savingsPerPO}</span>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <h4 class="font-medium text-gray-900 mb-3">Process Efficiency</h4>
                                    <div class="space-y-2 text-sm">
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Before (manual):</span>
                                            <span class="font-medium">${savingsConfig.beforeTimeMinutes} min/PO</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">After (SynqChain):</span>
                                            <span class="font-medium">${savingsConfig.afterTimeMinutes} min/PO</span>
                                        </div>
                                        <div class="flex justify-between border-t pt-2 font-semibold">
                                            <span>Time saved:</span>
                                            <span class="text-green-600">${savingsConfig.timeSavingsMinutes} min/PO</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Implementation Timeline -->
                        <div class="mt-6 bg-white border border-gray-200 rounded-lg p-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-4">Implementation Timeline</h3>
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 text-sm">
                                <div>
                                    <label class="block text-gray-600 mb-1">Implementation Start:</label>
                                    <input type="text" value="${savingsConfig.implementationStartDate}" class="w-full border border-gray-300 rounded px-3 py-2" readonly>
                                </div>
                                <div>
                                    <label class="block text-gray-600 mb-1">Days Active:</label>
                                    <input type="number" value="${savingsConfig.daysSinceImplementation}" class="w-full border border-gray-300 rounded px-3 py-2" readonly>
                                </div>
                                <div>
                                    <label class="block text-gray-600 mb-1">Total POs Processed:</label>
                                    <input type="number" value="${savingsConfig.totalPOsProcessed}" class="w-full border border-gray-300 rounded px-3 py-2" readonly>
                                </div>
                                <div>
                                    <label class="block text-gray-600 mb-1">Processing Rate:</label>
                                    <input type="text" value="${Math.round(savings.processingRatePerMonth)} POs/month" class="w-full border border-gray-300 rounded px-3 py-2" readonly>
                                </div>
                            </div>
                            
                            <!-- Projections -->
                            <div class="mt-6 pt-6 border-t border-gray-200">
                                <h4 class="font-medium text-gray-900 mb-3">Future Projections</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                                    <div class="bg-green-50 p-3 rounded">
                                        <div class="text-green-700 font-medium">Projected Annual Savings</div>
                                        <div class="text-xl font-bold text-green-900">$${Math.round(savings.projectedAnnualSavings).toLocaleString()}</div>
                                        <div class="text-xs text-green-600">Based on current efficiency</div>
                                    </div>
                                    <div class="bg-blue-50 p-3 rounded">
                                        <div class="text-blue-700 font-medium">ROI Achievement</div>
                                        <div class="text-xl font-bold text-blue-900">${((savings.totalSavings / 50000) * 100).toFixed(0)}%</div>
                                        <div class="text-xs text-blue-600">Against $50K implementation cost</div>
                                    </div>
                                </div>
                            </div>
                            
                            <p class="text-xs text-gray-500 mt-3">
                                * Calculations based on actual processed POs and measured time savings of 32 minutes per PO
                            </p>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        // PO Management Functions
        const purchaseOrders = [
            {
                id: 'PO-2024-045',
                supplier: 'Industrial Solutions Inc',
                status: 'approved',
                total: '$49,100.00',
                needBy: 'Mar 28, 2024',
                progress: 85,
                items: [
                    { description: 'Manufacturing Equipment Set A', qty: 2, unitPrice: '$15,500.00', total: '$31,000.00' },
                    { description: 'Industrial Safety Equipment', qty: 1, unitPrice: '$18,100.00', total: '$18,100.00' }
                ],
                requestedBy: 'Mike Rodriguez',
                department: 'Manufacturing',
                priority: 'Standard'
            },
            {
                id: 'PO-2024-046',
                supplier: 'TechSource Global',
                status: 'in-fulfillment',
                total: '$27,500.00',
                needBy: 'Apr 2, 2024',
                progress: 60,
                items: [
                    { description: 'Office Software Licenses', qty: 50, unitPrice: '$450.00', total: '$22,500.00' },
                    { description: 'Hardware Support Package', qty: 1, unitPrice: '$5,000.00', total: '$5,000.00' }
                ],
                requestedBy: 'Sarah Chen',
                department: 'IT Operations',
                priority: 'High Priority'
            },
            {
                id: 'PO-2024-047',
                supplier: 'European Logistics Ltd',
                status: 'delivered',
                total: '$15,800.00',
                needBy: 'Mar 15, 2024',
                progress: 100,
                items: [
                    { description: 'Shipping Containers', qty: 3, unitPrice: '$5,266.67', total: '$15,800.00' }
                ],
                requestedBy: 'Emma Thompson',
                department: 'Logistics',
                priority: 'Rush Order'
            },
            {
                id: 'PO-2024-051',
                supplier: 'Office Solutions Ltd',
                status: 'draft',
                total: '$8,450.00',
                needBy: 'Apr 10, 2024',
                progress: 0,
                items: [
                    { description: 'Office Furniture Package', qty: 1, unitPrice: '$8,450.00', total: '$8,450.00' }
                ],
                requestedBy: 'David Kim',
                department: 'Administration',
                priority: 'Standard'
            }
        ];

        // OLD FUNCTION REMOVED - Using new renderPOTable() instead

        function getStatusColor(status) {
            const colors = {
                'draft': 'bg-gray-100 text-gray-800',
                'pending-approval': 'bg-yellow-100 text-yellow-800',
                'approved': 'bg-green-100 text-green-800',
                'acknowledged': 'bg-blue-100 text-blue-800',
                'in-fulfillment': 'bg-purple-100 text-purple-800',
                'shipped': 'bg-orange-100 text-orange-800',
                'delivered': 'bg-emerald-100 text-emerald-800',
                'invoiced': 'bg-red-100 text-red-800',
                'paid': 'bg-green-100 text-green-800',
                'closed': 'bg-gray-100 text-gray-800'
            };
            return colors[status] || 'bg-gray-100 text-gray-800';
        }

        function getStatusText(status) {
            const texts = {
                'draft': 'Draft',
                'pending-approval': 'Pending Approval',
                'approved': 'Approved',
                'acknowledged': 'Acknowledged',
                'in-fulfillment': 'In Fulfillment',
                'shipped': 'Shipped',
                'delivered': 'Delivered',
                'invoiced': 'Invoiced',
                'paid': 'Paid',
                'closed': 'Closed'
            };
            return texts[status] || 'Unknown';
        }

        function openPODetails(poId) {
            const po = purchaseOrders.find(p => p.id === poId);
            if (!po) return;

            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.innerHTML = `
                <div class="bg-white rounded-xl shadow-xl max-w-6xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                    <div class="p-6 border-b border-gray-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <h2 class="text-2xl font-bold text-gray-900">Purchase Order ${po.id}</h2>
                                <p class="text-gray-600 mt-1">${po.supplier} • ${po.total} • ${getStatusText(po.status)}</p>
                            </div>
                            <button onclick="this.closest('.modal').remove()" class="text-gray-400 hover:text-gray-600">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    
                    <div class="p-6">
                        <!-- PO Status Timeline -->
                        <div class="bg-gray-50 rounded-lg p-6 mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-4">Order Status & Timeline</h3>
                            <div class="flex items-center space-x-4 overflow-x-auto">
                                ${generateStatusTimeline(po.status)}
                            </div>
                            <div class="mt-4">
                                <div class="flex justify-between text-sm text-gray-600 mb-1">
                                    <span>Progress</span>
                                    <span>${po.progress}% Complete</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-blue-600 h-2 rounded-full" style="width: ${po.progress}%"></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- PO Details Grid -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                            <div class="bg-white border border-gray-200 rounded-lg p-4">
                                <h4 class="font-semibold text-gray-900 mb-3">Order Information</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">PO Number:</span>
                                        <span class="font-medium">${po.id}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Supplier:</span>
                                        <span class="font-medium">${po.supplier}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Total Amount:</span>
                                        <span class="font-medium text-green-600">${po.total}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Requested by:</span>
                                        <span class="font-medium">${po.requestedBy}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Department:</span>
                                        <span class="font-medium">${po.department}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Need by:</span>
                                        <span class="font-medium">${po.needBy}</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white border border-gray-200 rounded-lg p-4">
                                <h4 class="font-semibold text-gray-900 mb-3">Delivery & Actions</h4>
                                <div class="space-y-3">
                                    <button onclick="trackShipment('${po.id}')" class="w-full bg-blue-50 hover:bg-blue-100 text-blue-700 px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                                        📦 Track Shipment
                                    </button>
                                    <button onclick="downloadPO('${po.id}')" class="w-full bg-green-50 hover:bg-green-100 text-green-700 px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                                        📄 Download PO
                                    </button>
                                    <button onclick="contactSupplier('${po.supplier}')" class="w-full bg-purple-50 hover:bg-purple-100 text-purple-700 px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                                        💬 Contact Supplier
                                    </button>
                                    <button onclick="createChangeOrder('${po.id}')" class="w-full bg-orange-50 hover:bg-orange-100 text-orange-700 px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                                        📝 Change Order
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Line Items -->
                        <div class="bg-white border border-gray-200 rounded-lg p-4 mb-6">
                            <h4 class="font-semibold text-gray-900 mb-3">Line Items</h4>
                            <div class="overflow-x-auto">
                                <table class="min-w-full">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500">Description</th>
                                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500">Qty</th>
                                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500">Unit Price</th>
                                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500">Total</th>
                                        </tr>
                                    </thead>
                                    <tbody class="divide-y divide-gray-200">
                                        ${po.items.map(item => `
                                            <tr>
                                                <td class="px-4 py-2 text-sm">${item.description}</td>
                                                <td class="px-4 py-2 text-sm">${item.qty}</td>
                                                <td class="px-4 py-2 text-sm">${item.unitPrice}</td>
                                                <td class="px-4 py-2 text-sm font-medium">${item.total}</td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <!-- Recent Activity -->
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h4 class="font-semibold text-gray-900 mb-3">Recent Activity</h4>
                            <div class="space-y-3">
                                <div class="flex items-start space-x-3">
                                    <div class="w-2 h-2 bg-green-500 rounded-full mt-2"></div>
                                    <div>
                                        <div class="text-sm font-medium text-gray-900">PO approved by manager</div>
                                        <div class="text-xs text-gray-500">Status updated to approved • 4 hours ago</div>
                                    </div>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-2 h-2 bg-blue-500 rounded-full mt-2"></div>
                                    <div>
                                        <div class="text-sm font-medium text-gray-900">Supplier acknowledged order</div>
                                        <div class="text-xs text-gray-500">Estimated delivery: ${po.needBy} • 6 hours ago</div>
                                    </div>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-2 h-2 bg-purple-500 rounded-full mt-2"></div>
                                    <div>
                                        <div class="text-sm font-medium text-gray-900">PO created and submitted</div>
                                        <div class="text-xs text-gray-500">By ${po.requestedBy} • 1 day ago</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        function generateStatusTimeline(currentStatus) {
            const statuses = [
                { key: 'draft', label: 'Draft', icon: '📝' },
                { key: 'pending-approval', label: 'Pending', icon: '⏳' },
                { key: 'approved', label: 'Approved', icon: '✅' },
                { key: 'acknowledged', label: 'Acknowledged', icon: '👍' },
                { key: 'in-fulfillment', label: 'Fulfillment', icon: '📦' },
                { key: 'delivered', label: 'Delivered', icon: '🚚' }
            ];
            
            const currentIndex = statuses.findIndex(s => s.key === currentStatus);
            
            return statuses.map((status, index) => {
                const isCompleted = index <= currentIndex;
                const isCurrent = index === currentIndex;
                
                return `
                    <div class="flex items-center ${index < statuses.length - 1 ? 'flex-1' : ''}">
                        <div class="flex flex-col items-center">
                            <div class="w-8 h-8 rounded-full flex items-center justify-center text-sm ${
                                isCompleted ? 'bg-green-100 text-green-600' : 'bg-gray-100 text-gray-400'
                            } ${isCurrent ? 'ring-2 ring-blue-500' : ''}">
                                ${status.icon}
                            </div>
                            <span class="text-xs mt-1 ${isCompleted ? 'text-green-600' : 'text-gray-400'}">${status.label}</span>
                        </div>
                        ${index < statuses.length - 1 ? `
                            <div class="flex-1 h-0.5 mx-2 ${index < currentIndex ? 'bg-green-500' : 'bg-gray-200'}"></div>
                        ` : ''}
                    </div>
                `;
            }).join('');
        }

        function trackShipment(poId) {
            showToast(`Opening shipment tracking for ${poId}... 📦`, 'info');
        }

        function downloadPO(poId) {
            showToast(`Downloading PO ${poId} as PDF... 📄`, 'success');
        }

        function contactSupplier(supplier) {
            showToast(`Opening communication with ${supplier}... 💬`, 'info');
        }

        function createChangeOrder(poId) {
            showToast(`Creating change order for ${poId}... 📝`, 'info');
        }

        function editPO(poId) {
            showToast(`Opening ${poId} for editing... ✏️`, 'info');
        }

        function clonePO(poId) {
            showToast(`Creating new PO based on ${poId}... 📋`, 'info');
        }

        // Risk Management Functions
        function showRiskDetails() {
            const riskSection = document.getElementById('risk-details');
            if (riskSection) {
                riskSection.classList.remove('hidden');
                riskSection.scrollIntoView({ behavior: 'smooth' });
                showToast('Opening advanced risk management dashboard... 📊', 'info');
            }
        }

        function hideRiskDetails() {
            const riskSection = document.getElementById('risk-details');
            if (riskSection) {
                riskSection.classList.add('hidden');
                showToast('Risk management dashboard closed 📊', 'success');
            }
        }

        // Dashboard Navigation Functions




        // Modal Functions
        function closeModal(modalId) {
            if (modalId) {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.classList.add('hidden');
                }
            } else {
                // Legacy closeModal() for supplier modal
                const modal = document.getElementById('modal');
                if (modal) {
                    modal.classList.remove('active');
                }
            }
        }

        // KPI Details Functions
        function showKPIDetails(kpiType) {
            const modal = document.getElementById('kpi-modal');
            const title = document.getElementById('kpi-modal-title');
            const content = document.getElementById('kpi-modal-content');
            
            const kpiData = {
                'program-savings': {
                    title: 'Program Savings Analysis',
                    content: `
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="bg-green-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-green-800 mb-2">Current Performance</h4>
                                    <p class="text-2xl font-bold text-green-900">$1.5M</p>
                                    <p class="text-sm text-green-600">50% of $3.0M target</p>
                                </div>
                                <div class="bg-blue-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-blue-800 mb-2">Opportunity Remaining</h4>
                                    <p class="text-2xl font-bold text-blue-900">$1.5M</p>
                                    <p class="text-sm text-blue-600">50% improvement potential</p>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 mb-3">Savings Breakdown</h4>
                                <div class="space-y-3">
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Platform Automation</span>
                                        <span class="text-sm font-semibold text-gray-900" id="platform-automation-savings">$12,395</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Project Sourcing</span>
                                        <span class="text-sm font-semibold text-gray-900">$1,470,000</span>
                                    </div>
                                    <div class="pt-2 border-t border-gray-200">
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm font-medium text-gray-900">Total</span>
                                            <span class="text-lg font-bold text-green-600">$1,498,562</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 mb-3">Key Improvement Areas</h4>
                                <div class="space-y-2">
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 bg-red-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">Expand supplier competitive bidding</span>
                                    </div>
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 bg-red-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">Implement demand consolidation</span>
                                    </div>
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 bg-red-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">Optimize contract terms</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `
                },
                'otd-rate': {
                    title: 'On-Time Delivery Analysis',
                    content: `
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="bg-red-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-red-800 mb-2">Current Performance</h4>
                                    <p class="text-2xl font-bold text-red-900">78.2%</p>
                                    <p class="text-sm text-red-600">Below 95% target</p>
                                </div>
                                <div class="bg-orange-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-orange-800 mb-2">Gap to Target</h4>
                                    <p class="text-2xl font-bold text-orange-900">16.8%</p>
                                    <p class="text-sm text-orange-600">Improvement needed</p>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 mb-3">Supplier Performance Breakdown</h4>
                                <div class="space-y-3">
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Industrial Solutions Inc</span>
                                        <span class="text-sm font-semibold text-red-600">72.4%</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">TechSource Global</span>
                                        <span class="text-sm font-semibold text-red-600">68.1%</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">European Logistics Ltd</span>
                                        <span class="text-sm font-semibold text-yellow-600">89.3%</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Global Manufacturing Co</span>
                                        <span class="text-sm font-semibold text-green-600">94.7%</span>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 mb-3">Root Causes</h4>
                                <div class="space-y-2">
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 bg-red-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">Supply chain disruptions (42% of delays)</span>
                                    </div>
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 bg-red-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">Quality issues requiring rework (28%)</span>
                                    </div>
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 bg-red-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">Capacity constraints (30%)</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `
                },
                'ppv-variance': {
                    title: 'Purchase Price Variance Analysis',
                    content: `
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="bg-green-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-green-800 mb-2">Current Performance</h4>
                                    <p class="text-2xl font-bold text-green-900">-3.2%</p>
                                    <p class="text-sm text-green-600">Favorable variance</p>
                                </div>
                                <div class="bg-blue-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-blue-800 mb-2">Target Achievement</h4>
                                    <p class="text-2xl font-bold text-blue-900">64%</p>
                                    <p class="text-sm text-blue-600">Of -5.0% target</p>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 mb-3">Variance by Category</h4>
                                <div class="space-y-3">
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Raw Materials</span>
                                        <span class="text-sm font-semibold text-green-600">-4.8%</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Technology & IT</span>
                                        <span class="text-sm font-semibold text-green-600">-2.1%</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Professional Services</span>
                                        <span class="text-sm font-semibold text-red-600">+1.7%</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Logistics</span>
                                        <span class="text-sm font-semibold text-green-600">-5.2%</span>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 mb-3">Key Drivers</h4>
                                <div class="space-y-2">
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">Competitive bidding processes</span>
                                    </div>
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">Volume discounts negotiated</span>
                                    </div>
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 bg-red-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">Market price increases in services</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `
                },
                'quality-ppm': {
                    title: 'Quality (PPM) Analysis',
                    content: `
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="bg-red-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-red-800 mb-2">Current Performance</h4>
                                    <p class="text-2xl font-bold text-red-900">485 PPM</p>
                                    <p class="text-sm text-red-600">Above 100 PPM target</p>
                                </div>
                                <div class="bg-orange-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-orange-800 mb-2">Gap to Target</h4>
                                    <p class="text-2xl font-bold text-orange-900">385 PPM</p>
                                    <p class="text-sm text-orange-600">Improvement needed</p>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 mb-3">Quality Issues by Supplier</h4>
                                <div class="space-y-3">
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Industrial Solutions Inc</span>
                                        <span class="text-sm font-semibold text-red-600">750 PPM</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">TechSource Global</span>
                                        <span class="text-sm font-semibold text-red-600">420 PPM</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">European Logistics Ltd</span>
                                        <span class="text-sm font-semibold text-yellow-600">285 PPM</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Global Manufacturing Co</span>
                                        <span class="text-sm font-semibold text-green-600">65 PPM</span>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 mb-3">Quality Issue Types</h4>
                                <div class="space-y-2">
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 bg-red-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">Dimensional defects (35% of issues)</span>
                                    </div>
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 bg-red-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">Material composition (28%)</span>
                                    </div>
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 bg-red-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">Cosmetic defects (37%)</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `
                },
                'response-time': {
                    title: 'Supplier Response Time Analysis',
                    content: `
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="bg-green-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-green-800 mb-2">Current Performance</h4>
                                    <p class="text-2xl font-bold text-green-900">12h</p>
                                    <p class="text-sm text-green-600">Under 24h target</p>
                                </div>
                                <div class="bg-blue-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-blue-800 mb-2">Target Achievement</h4>
                                    <p class="text-2xl font-bold text-blue-900">50%</p>
                                    <p class="text-sm text-blue-600">Better than target</p>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 mb-3">Response Time by Supplier</h4>
                                <div class="space-y-3">
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Industrial Solutions Inc</span>
                                        <span class="text-sm font-semibold text-green-600">8.5h</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">TechSource Global</span>
                                        <span class="text-sm font-semibold text-green-600">6.2h</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">European Logistics Ltd</span>
                                        <span class="text-sm font-semibold text-green-600">18.4h</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Global Manufacturing Co</span>
                                        <span class="text-sm font-semibold text-green-600">14.1h</span>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 mb-3">Communication Channels</h4>
                                <div class="space-y-2">
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">Email notifications (avg 4.2h)</span>
                                    </div>
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">SynqChain portal (avg 2.1h)</span>
                                    </div>
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 bg-yellow-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">Phone calls (avg 16.8h)</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `
                }
            };
            
            if (kpiData[kpiType]) {
                title.textContent = kpiData[kpiType].title;
                content.innerHTML = kpiData[kpiType].content;
                modal.classList.remove('hidden');
                showToast('Opening detailed KPI analysis... 📊', 'info');
            }
        }

        // Platform Savings Details Functions
        function showPlatformSavingsDetails(savingsType) {
            const modal = document.getElementById('platform-savings-modal');
            const title = document.getElementById('platform-modal-title');
            const content = document.getElementById('platform-modal-content');
            
            const savingsData = {
                'process-automation': {
                    title: 'Process Automation Savings - $12,450',
                    content: `
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="bg-green-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-green-800 mb-2">Total Savings</h4>
                                    <p class="text-2xl font-bold text-green-900">$12,450</p>
                                    <p class="text-sm text-green-600">43.6% of platform savings</p>
                                </div>
                                <div class="bg-blue-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-blue-800 mb-2">Time Saved</h4>
                                    <p class="text-2xl font-bold text-blue-900">247 hrs</p>
                                    <p class="text-sm text-blue-600">per month</p>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 mb-3">Automation Breakdown</h4>
                                <div class="space-y-3">
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">PO Approval Workflows</span>
                                        <span class="text-sm font-semibold text-gray-900">$4,820</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Invoice Processing</span>
                                        <span class="text-sm font-semibold text-gray-900">$3,650</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Supplier Onboarding</span>
                                        <span class="text-sm font-semibold text-gray-900">$2,180</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Report Generation</span>
                                        <span class="text-sm font-semibold text-gray-900">$1,800</span>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 mb-3">Key Benefits</h4>
                                <div class="space-y-2">
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">85% reduction in manual data entry</span>
                                    </div>
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">98% accuracy in automated processes</span>
                                    </div>
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">72% faster approval cycles</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `
                },
                'supplier-management': {
                    title: 'Supplier Management Savings - $8,920',
                    content: `
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="bg-green-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-green-800 mb-2">Total Savings</h4>
                                    <p class="text-2xl font-bold text-green-900">$8,920</p>
                                    <p class="text-sm text-green-600">31.2% of platform savings</p>
                                </div>
                                <div class="bg-purple-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-purple-800 mb-2">Supplier Relationships</h4>
                                    <p class="text-2xl font-bold text-purple-900">234</p>
                                    <p class="text-sm text-purple-600">active suppliers</p>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 mb-3">Management Savings</h4>
                                <div class="space-y-3">
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Supplier Performance Monitoring</span>
                                        <span class="text-sm font-semibold text-gray-900">$3,240</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Contract Management</span>
                                        <span class="text-sm font-semibold text-gray-900">$2,850</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Risk Assessment</span>
                                        <span class="text-sm font-semibold text-gray-900">$1,920</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Portal Communication</span>
                                        <span class="text-sm font-semibold text-gray-900">$910</span>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 mb-3">Efficiency Gains</h4>
                                <div class="space-y-2">
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 bg-blue-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">60% faster supplier onboarding</span>
                                    </div>
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 bg-blue-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">45% improvement in supplier responsiveness</span>
                                    </div>
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 bg-blue-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">Real-time performance tracking</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `
                },
                'contract-optimization': {
                    title: 'Contract Optimization Savings - $4,850',
                    content: `
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="bg-green-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-green-800 mb-2">Total Savings</h4>
                                    <p class="text-2xl font-bold text-green-900">$4,850</p>
                                    <p class="text-sm text-green-600">17.0% of platform savings</p>
                                </div>
                                <div class="bg-orange-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-orange-800 mb-2">Contracts Optimized</h4>
                                    <p class="text-2xl font-bold text-orange-900">47</p>
                                    <p class="text-sm text-orange-600">this quarter</p>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 mb-3">Optimization Areas</h4>
                                <div class="space-y-3">
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Terms & Conditions</span>
                                        <span class="text-sm font-semibold text-gray-900">$1,940</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Payment Terms</span>
                                        <span class="text-sm font-semibold text-gray-900">$1,520</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Volume Discounts</span>
                                        <span class="text-sm font-semibold text-gray-900">$850</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Risk Clauses</span>
                                        <span class="text-sm font-semibold text-gray-900">$540</span>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 mb-3">Value Drivers</h4>
                                <div class="space-y-2">
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 bg-purple-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">Better payment terms negotiation</span>
                                    </div>
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 bg-purple-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">Standardized contract templates</span>
                                    </div>
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 bg-purple-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">Automated renewal management</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `
                },
                'data-analytics': {
                    title: 'Data Analytics Savings - $2,342',
                    content: `
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="bg-green-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-green-800 mb-2">Total Savings</h4>
                                    <p class="text-2xl font-bold text-green-900">$2,342</p>
                                    <p class="text-sm text-green-600">8.2% of platform savings</p>
                                </div>
                                <div class="bg-teal-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-teal-800 mb-2">Data Points</h4>
                                    <p class="text-2xl font-bold text-teal-900">24.7K</p>
                                    <p class="text-sm text-teal-600">analyzed daily</p>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 mb-3">Analytics Savings</h4>
                                <div class="space-y-3">
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Spend Analysis</span>
                                        <span class="text-sm font-semibold text-gray-900">$980</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Predictive Insights</span>
                                        <span class="text-sm font-semibold text-gray-900">$720</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Performance Monitoring</span>
                                        <span class="text-sm font-semibold text-gray-900">$426</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Automated Reporting</span>
                                        <span class="text-sm font-semibold text-gray-900">$216</span>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 mb-3">Insights Generated</h4>
                                <div class="space-y-2">
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 bg-yellow-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">Spend pattern optimization recommendations</span>
                                    </div>
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 bg-yellow-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">Supplier risk early warning alerts</span>
                                    </div>
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 bg-yellow-500 rounded-full mr-3"></div>
                                        <span class="text-sm text-gray-600">Market trend analysis and forecasting</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `
                }
            };
            
            if (savingsData[savingsType]) {
                title.textContent = savingsData[savingsType].title;
                content.innerHTML = savingsData[savingsType].content;
                modal.classList.remove('hidden');
                showToast('Opening platform savings breakdown... 💰', 'info');
            }
        }

        // Project Details Functions
        function showProjectDetails(projectType) {
            const modal = document.getElementById('project-modal');
            const title = document.getElementById('project-modal-title');
            const content = document.getElementById('project-modal-content');
            
            const projectData = {
                'manufacturing-equipment': {
                    title: 'Manufacturing Equipment RFQ Project',
                    content: `
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="bg-green-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-green-800 mb-2">Total Savings</h4>
                                    <p class="text-2xl font-bold text-green-900">$1.2M</p>
                                    <p class="text-sm text-green-600">+41% vs $850K target</p>
                                </div>
                                <div class="bg-blue-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-blue-800 mb-2">Project Status</h4>
                                    <p class="text-xl font-bold text-blue-900">Completed</p>
                                    <p class="text-sm text-blue-600">Dec 15, 2023</p>
                                </div>
                                <div class="bg-purple-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-purple-800 mb-2">Suppliers</h4>
                                    <p class="text-xl font-bold text-purple-900">12</p>
                                    <p class="text-sm text-purple-600">participated</p>
                                </div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h4 class="font-medium text-gray-900 mb-3">Project Timeline</h4>
                                    <div class="space-y-3">
                                        <div class="flex items-center">
                                            <div class="w-3 h-3 bg-green-500 rounded-full mr-3"></div>
                                            <div>
                                                <p class="text-sm font-medium text-gray-900">RFQ Published</p>
                                                <p class="text-xs text-gray-500">Oct 1, 2023</p>
                                            </div>
                                        </div>
                                        <div class="flex items-center">
                                            <div class="w-3 h-3 bg-green-500 rounded-full mr-3"></div>
                                            <div>
                                                <p class="text-sm font-medium text-gray-900">Proposals Received</p>
                                                <p class="text-xs text-gray-500">Oct 30, 2023</p>
                                            </div>
                                        </div>
                                        <div class="flex items-center">
                                            <div class="w-3 h-3 bg-green-500 rounded-full mr-3"></div>
                                            <div>
                                                <p class="text-sm font-medium text-gray-900">Supplier Selected</p>
                                                <p class="text-xs text-gray-500">Nov 20, 2023</p>
                                            </div>
                                        </div>
                                        <div class="flex items-center">
                                            <div class="w-3 h-3 bg-green-500 rounded-full mr-3"></div>
                                            <div>
                                                <p class="text-sm font-medium text-gray-900">Contract Signed</p>
                                                <p class="text-xs text-gray-500">Dec 15, 2023</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <h4 class="font-medium text-gray-900 mb-3">Key Results</h4>
                                    <div class="space-y-2">
                                        <div class="flex items-center">
                                            <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                                            <span class="text-sm text-gray-600">35% cost reduction achieved</span>
                                        </div>
                                        <div class="flex items-center">
                                            <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                                            <span class="text-sm text-gray-600">Delivery time improved by 22 days</span>
                                        </div>
                                        <div class="flex items-center">
                                            <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                                            <span class="text-sm text-gray-600">Quality specifications exceeded</span>
                                        </div>
                                        <div class="flex items-center">
                                            <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                                            <span class="text-sm text-gray-600">3-year warranty included</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `
                },
                'it-services': {
                    title: 'IT Services Consolidation Project',
                    content: `
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="bg-green-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-green-800 mb-2">Total Savings</h4>
                                    <p class="text-2xl font-bold text-green-900">$485K</p>
                                    <p class="text-sm text-green-600">+43% vs $340K target</p>
                                </div>
                                <div class="bg-yellow-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-yellow-800 mb-2">Project Status</h4>
                                    <p class="text-xl font-bold text-yellow-900">In Progress</p>
                                    <p class="text-sm text-yellow-600">75% complete</p>
                                </div>
                                <div class="bg-blue-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-blue-800 mb-2">Services</h4>
                                    <p class="text-xl font-bold text-blue-900">8</p>
                                    <p class="text-sm text-blue-600">consolidated</p>
                                </div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h4 class="font-medium text-gray-900 mb-3">Services Consolidated</h4>
                                    <div class="space-y-2">
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Cloud Infrastructure</span>
                                            <span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded">✓ Done</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Security Services</span>
                                            <span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded">✓ Done</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Help Desk Support</span>
                                            <span class="text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded">⏳ In Progress</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Data Analytics</span>
                                            <span class="text-xs bg-gray-100 text-gray-800 px-2 py-1 rounded">Pending</span>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <h4 class="font-medium text-gray-900 mb-3">Expected Benefits</h4>
                                    <div class="space-y-2">
                                        <div class="flex items-center">
                                            <div class="w-2 h-2 bg-blue-500 rounded-full mr-3"></div>
                                            <span class="text-sm text-gray-600">Single vendor relationship</span>
                                        </div>
                                        <div class="flex items-center">
                                            <div class="w-2 h-2 bg-blue-500 rounded-full mr-3"></div>
                                            <span class="text-sm text-gray-600">24/7 integrated support</span>
                                        </div>
                                        <div class="flex items-center">
                                            <div class="w-2 h-2 bg-blue-500 rounded-full mr-3"></div>
                                            <span class="text-sm text-gray-600">Standardized SLAs</span>
                                        </div>
                                        <div class="flex items-center">
                                            <div class="w-2 h-2 bg-blue-500 rounded-full mr-3"></div>
                                            <span class="text-sm text-gray-600">Reduced complexity</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `
                },
                'logistics-optimization': {
                    title: 'Logistics Optimization Project',
                    content: `
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="bg-green-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-green-800 mb-2">Total Savings</h4>
                                    <p class="text-2xl font-bold text-green-900">$295K</p>
                                    <p class="text-sm text-green-600">+34% vs $220K target</p>
                                </div>
                                <div class="bg-blue-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-blue-800 mb-2">Project Status</h4>
                                    <p class="text-xl font-bold text-blue-900">Completed</p>
                                    <p class="text-sm text-blue-600">Nov 30, 2023</p>
                                </div>
                                <div class="bg-purple-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-purple-800 mb-2">Routes</h4>
                                    <p class="text-xl font-bold text-purple-900">15</p>
                                    <p class="text-sm text-purple-600">optimized</p>
                                </div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h4 class="font-medium text-gray-900 mb-3">Optimization Areas</h4>
                                    <div class="space-y-3">
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Route Planning</span>
                                            <span class="text-sm font-semibold text-gray-900">$125K</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Carrier Consolidation</span>
                                            <span class="text-sm font-semibold text-gray-900">$98K</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Warehouse Efficiency</span>
                                            <span class="text-sm font-semibold text-gray-900">$72K</span>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <h4 class="font-medium text-gray-900 mb-3">Performance Gains</h4>
                                    <div class="space-y-2">
                                        <div class="flex items-center">
                                            <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                                            <span class="text-sm text-gray-600">28% reduction in shipping costs</span>
                                        </div>
                                        <div class="flex items-center">
                                            <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                                            <span class="text-sm text-gray-600">15% faster delivery times</span>
                                        </div>
                                        <div class="flex items-center">
                                            <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                                            <span class="text-sm text-gray-600">95% on-time delivery rate</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `
                },
                'office-supplies': {
                    title: 'Office Supplies Sourcing Project',
                    content: `
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="bg-green-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-green-800 mb-2">Total Savings</h4>
                                    <p class="text-2xl font-bold text-green-900">$92K</p>
                                    <p class="text-sm text-green-600">+8% vs $85K target</p>
                                </div>
                                <div class="bg-yellow-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-yellow-800 mb-2">Project Status</h4>
                                    <p class="text-xl font-bold text-yellow-900">In Progress</p>
                                    <p class="text-sm text-yellow-600">90% complete</p>
                                </div>
                                <div class="bg-blue-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-blue-800 mb-2">SKUs</h4>
                                    <p class="text-xl font-bold text-blue-900">1,250</p>
                                    <p class="text-sm text-blue-600">standardized</p>
                                </div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h4 class="font-medium text-gray-900 mb-3">Sourcing Strategy</h4>
                                    <div class="space-y-2">
                                        <div class="flex items-center">
                                            <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                                            <span class="text-sm text-gray-600">Catalog standardization</span>
                                        </div>
                                        <div class="flex items-center">
                                            <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                                            <span class="text-sm text-gray-600">Volume aggregation</span>
                                        </div>
                                        <div class="flex items-center">
                                            <div class="w-2 h-2 bg-yellow-500 rounded-full mr-3"></div>
                                            <span class="text-sm text-gray-600">Supplier consolidation</span>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <h4 class="font-medium text-gray-900 mb-3">Benefits Achieved</h4>
                                    <div class="space-y-2">
                                        <div class="flex items-center">
                                            <div class="w-2 h-2 bg-blue-500 rounded-full mr-3"></div>
                                            <span class="text-sm text-gray-600">12% cost reduction</span>
                                        </div>
                                        <div class="flex items-center">
                                            <div class="w-2 h-2 bg-blue-500 rounded-full mr-3"></div>
                                            <span class="text-sm text-gray-600">Simplified ordering process</span>
                                        </div>
                                        <div class="flex items-center">
                                            <div class="w-2 h-2 bg-blue-500 rounded-full mr-3"></div>
                                            <span class="text-sm text-gray-600">Better inventory management</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `
                }
            };
            
            if (projectData[projectType]) {
                title.textContent = projectData[projectType].title;
                content.innerHTML = projectData[projectType].content;
                modal.classList.remove('hidden');
                showToast('Opening project details... 📋', 'info');
            }
        }

        // Projects Data and Functions (Jan 2023 - Aug 2025)
        const projectsData = [
            {
                id: 'proj-001',
                name: 'Q2 IT Procurement',
                description: 'Technology refresh initiative',
                client: 'TechCorp Inc',
                priority: 'High',
                status: 'In Progress',
                progress: 75,
                savingsTarget: 485000,
                dueDate: '2025-06-15',
                startDate: '2025-03-15',
                completedDate: null,
                category: 'Technology',
                actualSavings: 485000
            },
            {
                id: 'proj-002',
                name: 'Manufacturing Cost Reduction',
                description: 'Supply chain optimization',
                client: 'Industrial Solutions',
                priority: 'Critical',
                status: 'Planning',
                progress: 25,
                savingsTarget: 1200000,
                dueDate: '2024-06-30',
                startDate: '2024-02-01',
                completedDate: null,
                category: 'Manufacturing',
                actualSavings: 0
            },
            {
                id: 'proj-003',
                name: 'European Supplier Consolidation',
                description: 'Vendor rationalization',
                client: 'GlobalTrade Ltd',
                priority: 'Medium',
                status: 'Completed',
                progress: 100,
                savingsTarget: 720000,
                dueDate: '2024-03-01',
                startDate: '2023-12-01',
                completedDate: '2024-02-28',
                category: 'Strategic',
                actualSavings: 720000
            },
            {
                id: 'proj-004',
                name: 'Healthcare Equipment Sourcing',
                description: 'Medical device procurement optimization',
                client: 'Healthcare Systems',
                priority: 'Critical',
                status: 'In Progress',
                progress: 90,
                savingsTarget: 850000,
                dueDate: '2024-04-30',
                startDate: '2024-01-01',
                completedDate: null,
                category: 'Healthcare',
                actualSavings: 765000
            },
            {
                id: 'proj-005',
                name: 'Automotive Parts Rationalization',
                description: 'Component standardization initiative',
                client: 'Auto Manufacturing',
                priority: 'High',
                status: 'In Progress',
                progress: 60,
                savingsTarget: 2100000,
                dueDate: '2024-07-15',
                startDate: '2024-02-15',
                completedDate: null,
                category: 'Automotive',
                actualSavings: 1260000
            },
            {
                id: 'proj-006',
                name: 'Green Energy Procurement',
                description: 'Sustainable energy sourcing',
                client: 'Energy Solutions',
                priority: 'Medium',
                status: 'Planning',
                progress: 15,
                savingsTarget: 950000,
                dueDate: '2024-09-30',
                startDate: '2024-03-01',
                completedDate: null,
                category: 'Energy',
                actualSavings: 0
            },
            {
                id: 'proj-007',
                name: 'Cloud Services Optimization',
                description: 'IT infrastructure cost reduction',
                client: 'TechCorp Inc',
                priority: 'High',
                status: 'Completed',
                progress: 100,
                savingsTarget: 340000,
                dueDate: '2024-05-15',
                startDate: '2024-01-30',
                completedDate: '2024-03-15',
                category: 'Technology',
                actualSavings: 340000
            },
            {
                id: 'proj-008',
                name: 'Financial Services Audit',
                description: 'Professional services optimization',
                client: 'Financial Services',
                priority: 'Medium',
                status: 'Completed',
                progress: 100,
                savingsTarget: 420000,
                dueDate: '2024-02-28',
                startDate: '2023-11-15',
                completedDate: '2024-02-26',
                category: 'Services',
                actualSavings: 467000
            },
            {
                id: 'proj-009',
                name: 'Retail Supply Chain Enhancement',
                description: 'Logistics and distribution optimization',
                client: 'RetailMax Corp',
                priority: 'High',
                status: 'In Progress',
                progress: 45,
                savingsTarget: 1800000,
                dueDate: '2024-08-31',
                startDate: '2024-03-15',
                category: 'Retail',
                actualSavings: 810000
            },
            {
                id: 'proj-010',
                name: 'Office Supplies Consolidation',
                description: 'Corporate procurement standardization',
                client: 'TechCorp Inc',
                priority: 'Low',
                status: 'In Progress',
                progress: 95,
                savingsTarget: 85000,
                dueDate: '2024-04-10',
                startDate: '2024-01-10',
                category: 'Office',
                actualSavings: 92000
            },
            {
                id: 'proj-011',
                name: 'Heavy Machinery Procurement',
                description: 'Industrial equipment sourcing',
                client: 'Industrial Solutions',
                priority: 'Critical',
                status: 'Planning',
                progress: 20,
                savingsTarget: 3200000,
                dueDate: '2024-10-15',
                startDate: '2024-04-01',
                category: 'Manufacturing',
                actualSavings: 0
            },
            {
                id: 'proj-012',
                name: 'Pharmaceutical Raw Materials',
                description: 'API and excipient sourcing optimization',
                client: 'Healthcare Systems',
                priority: 'High',
                status: 'In Progress',
                progress: 65,
                savingsTarget: 1500000,
                dueDate: '2024-06-15',
                startDate: '2024-02-20',
                category: 'Healthcare',
                actualSavings: 975000
            },
            {
                id: 'proj-013',
                name: 'Global Logistics Network',
                description: 'International shipping optimization',
                client: 'GlobalTrade Ltd',
                priority: 'Medium',
                status: 'In Progress',
                progress: 55,
                savingsTarget: 890000,
                dueDate: '2024-07-30',
                startDate: '2024-03-10',
                category: 'Logistics',
                actualSavings: 489500
            },
            {
                id: 'proj-014',
                name: 'Electric Vehicle Components',
                description: 'EV battery and electronics sourcing',
                client: 'Auto Manufacturing',
                priority: 'Critical',
                status: 'Planning',
                progress: 30,
                savingsTarget: 2800000,
                dueDate: '2024-11-30',
                startDate: '2024-04-15',
                category: 'Automotive',
                actualSavings: 0
            },
            {
                id: 'proj-015',
                name: 'Renewable Energy Infrastructure',
                description: 'Solar and wind equipment procurement',
                client: 'Energy Solutions',
                priority: 'High',
                status: 'In Progress',
                progress: 40,
                savingsTarget: 4500000,
                dueDate: '2024-12-31',
                startDate: '2024-05-01',
                category: 'Energy',
                actualSavings: 1800000
            },
            {
                id: 'proj-016',
                name: 'Digital Banking Platform',
                description: 'Fintech solutions procurement',
                client: 'Financial Services',
                priority: 'High',
                status: 'In Progress',
                progress: 70,
                savingsTarget: 650000,
                dueDate: '2024-06-01',
                startDate: '2024-02-01',
                category: 'Technology',
                actualSavings: 455000
            },
            {
                id: 'proj-017',
                name: 'E-commerce Platform Upgrade',
                description: 'Online retail technology enhancement',
                client: 'RetailMax Corp',
                priority: 'Medium',
                status: 'On Hold',
                progress: 35,
                savingsTarget: 320000,
                dueDate: '2024-08-15',
                startDate: '2024-02-28',
                category: 'Technology',
                actualSavings: 112000
            },
            {
                id: 'proj-018',
                name: 'Quality Control Systems',
                description: 'Manufacturing quality assurance upgrade',
                client: 'Industrial Solutions',
                priority: 'Medium',
                status: 'Completed',
                progress: 100,
                savingsTarget: 380000,
                dueDate: '2024-03-15',
                startDate: '2023-12-15',
                category: 'Manufacturing',
                actualSavings: 425000
            },
            {
                id: 'proj-019',
                name: 'Telemedicine Equipment',
                description: 'Remote healthcare technology procurement',
                client: 'Healthcare Systems',
                priority: 'Low',
                status: 'Planning',
                progress: 10,
                savingsTarget: 280000,
                dueDate: '2024-09-15',
                startDate: '2024-05-15',
                category: 'Healthcare',
                actualSavings: 0
            },
            {
                id: 'proj-020',
                name: 'Autonomous Vehicle Testing',
                description: 'AV technology and equipment sourcing',
                client: 'Auto Manufacturing',
                priority: 'Low',
                status: 'Planning',
                progress: 5,
                savingsTarget: 1900000,
                dueDate: '2025-01-31',
                startDate: '2024-06-01',
                category: 'Automotive',
                actualSavings: 0
            },
            {
                id: 'proj-021',
                name: 'Smart Grid Components',
                description: 'Electrical grid modernization procurement',
                client: 'Energy Solutions',
                priority: 'Critical',
                status: 'In Progress',
                progress: 85,
                savingsTarget: 3100000,
                dueDate: '2024-05-30',
                startDate: '2024-01-05',
                category: 'Energy',
                actualSavings: 2635000
            },
            {
                id: 'proj-022',
                name: 'Mobile Payment Solutions',
                description: 'Payment processing technology upgrade',
                client: 'Financial Services',
                priority: 'Medium',
                status: 'Cancelled',
                progress: 0,
                savingsTarget: 150000,
                dueDate: '2024-07-01',
                startDate: '2024-03-01',
                category: 'Technology',
                actualSavings: 0
            },
            {
                id: 'proj-023',
                name: 'Omnichannel Integration',
                description: 'Unified retail experience platform',
                client: 'RetailMax Corp',
                priority: 'High',
                status: 'In Progress',
                progress: 50,
                savingsTarget: 580000,
                dueDate: '2024-09-01',
                startDate: '2024-04-01',
                category: 'Retail',
                actualSavings: 290000
            }
        ];

        // Add completion dates and update timeline for chart data (Jan 2023 - Aug 2025)
        projectsData.forEach(project => {
            if (project.status === 'Completed' && !project.completedDate) {
                // Add completion dates to existing completed projects (updated timeline)
                if (project.id === 'proj-008') project.completedDate = '2024-12-26';
                if (project.id === 'proj-018') project.completedDate = '2024-11-28';
            }
            
            // Add completion dates spread across timeline for chart visualization
            if (project.id === 'proj-009') {
                project.status = 'Completed';
                project.progress = 100;
                project.completedDate = '2023-12-15';
                project.actualSavings = project.savingsTarget;
                project.startDate = '2023-09-01';
                project.dueDate = '2023-12-31';
            }
            if (project.id === 'proj-011') {
                project.status = 'Completed';
                project.progress = 100;
                project.completedDate = '2024-01-20';
                project.actualSavings = project.savingsTarget;
                project.startDate = '2023-10-15';
                project.dueDate = '2024-02-15';
            }
            if (project.id === 'proj-014') {
                project.status = 'Completed';
                project.progress = 100;
                project.completedDate = '2023-11-30';
                project.actualSavings = project.savingsTarget;
                project.startDate = '2023-08-01';
                project.dueDate = '2023-12-01';
            }
            if (project.id === 'proj-016') {
                project.status = 'Completed';
                project.progress = 100;
                project.completedDate = '2024-03-25';
                project.actualSavings = project.savingsTarget;
                project.startDate = '2023-12-01';
                project.dueDate = '2024-04-01';
            }
            if (project.id === 'proj-003') {
                project.completedDate = '2024-10-28';
                project.startDate = '2024-07-01';
                project.dueDate = '2024-11-01';
            }
            if (project.id === 'proj-007') {
                project.completedDate = '2024-09-15';
                project.startDate = '2024-06-30';
                project.dueDate = '2024-10-15';
            }
        });

        let filteredProjects = [...projectsData];
        let currentSort = { column: null, direction: null };

        function sortTable(column) {
            // Toggle sort direction
            if (currentSort.column === column) {
                currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
            } else {
                currentSort.column = column;
                currentSort.direction = 'asc';
            }

            // Sort the filtered projects
            filteredProjects.sort((a, b) => {
                let aVal = a[column];
                let bVal = b[column];

                // Handle different data types
                if (column === 'dueDate' || column === 'startDate') {
                    aVal = new Date(aVal);
                    bVal = new Date(bVal);
                } else if (column === 'savingsTarget' || column === 'progress') {
                    aVal = Number(aVal);
                    bVal = Number(bVal);
                } else if (column === 'priority') {
                    // Custom priority order
                    const priorityOrder = { 'Critical': 4, 'High': 3, 'Medium': 2, 'Low': 1 };
                    aVal = priorityOrder[aVal] || 0;
                    bVal = priorityOrder[bVal] || 0;
                } else {
                    // String comparison
                    aVal = String(aVal).toLowerCase();
                    bVal = String(bVal).toLowerCase();
                }

                if (aVal < bVal) return currentSort.direction === 'asc' ? -1 : 1;
                if (aVal > bVal) return currentSort.direction === 'asc' ? 1 : -1;
                return 0;
            });

            // Update sort indicators
            updateSortIndicators();
            
            // Re-render table
            renderProjectsTable();
            
            showToast(`Sorted by ${column} (${currentSort.direction === 'asc' ? 'ascending' : 'descending'}) 📊`, 'info');
        }

        function updateSortIndicators() {
            // Reset all indicators
            document.querySelectorAll('[id^="sort-"]').forEach(indicator => {
                indicator.textContent = '↕';
                indicator.className = 'ml-1 text-gray-400';
            });

            // Set active indicator
            if (currentSort.column) {
                const indicator = document.getElementById(`sort-${currentSort.column}`);
                if (indicator) {
                    indicator.textContent = currentSort.direction === 'asc' ? '↑' : '↓';
                    indicator.className = 'ml-1 text-blue-600';
                }
            }
        }

        function renderProjectsTable() {
            const tableBody = document.getElementById('projects-table-body');
            const projectsCount = document.getElementById('projects-count');
            
            if (!tableBody) return;
            
            tableBody.innerHTML = '';
            projectsCount.textContent = filteredProjects.length;
            
            filteredProjects.forEach(project => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50 project-row';
                row.setAttribute('data-client', project.client);
                row.setAttribute('data-status', project.status);
                row.setAttribute('data-priority', project.priority);
                row.setAttribute('data-due-date', project.dueDate);
                
                const priorityColors = {
                    'Critical': 'bg-red-100 text-red-800',
                    'High': 'bg-orange-100 text-orange-800',
                    'Medium': 'bg-yellow-100 text-yellow-800',
                    'Low': 'bg-green-100 text-green-800'
                };
                
                const statusColors = {
                    'Planning': 'bg-gray-100 text-gray-800',
                    'In Progress': 'bg-blue-100 text-blue-800',
                    'Completed': 'bg-green-100 text-green-800',
                    'On Hold': 'bg-yellow-100 text-yellow-800',
                    'Cancelled': 'bg-red-100 text-red-800'
                };
                
                const progressColors = {
                    'Planning': 'bg-gray-600',
                    'In Progress': 'bg-blue-600',
                    'Completed': 'bg-green-600',
                    'On Hold': 'bg-yellow-600',
                    'Cancelled': 'bg-red-600'
                };
                
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-blue-600 cursor-pointer hover:text-blue-800" onclick="openProjectModal('${project.id}')">${project.name}</div>
                        <div class="text-sm text-gray-500">${project.description}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${project.client}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full ${priorityColors[project.priority]}">
                            ${project.priority}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full ${statusColors[project.status]}">
                            ${project.status}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <div class="w-16 bg-gray-200 rounded-full h-2 mr-2">
                                <div class="${progressColors[project.status]} h-2 rounded-full" style="width: ${project.progress}%"></div>
                            </div>
                            <span class="text-xs text-gray-500">${project.progress}%</span>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">$${(project.savingsTarget / 1000).toFixed(0)}K</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${new Date(project.dueDate).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}</td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        function filterProjects() {
            const clientFilter = document.getElementById('client-filter').value;
            const statusFilter = document.getElementById('status-filter').value;
            const priorityFilter = document.getElementById('priority-filter').value;
            
            // Start with current filtered projects (which might already be date-filtered)
            const baseProjects = document.getElementById('projects-start-date').value || document.getElementById('projects-end-date').value 
                ? filteredProjects 
                : projectsData;
            
            filteredProjects = baseProjects.filter(project => {
                const clientMatch = !clientFilter || project.client === clientFilter;
                const statusMatch = !statusFilter || project.status === statusFilter;
                const priorityMatch = !priorityFilter || project.priority === priorityFilter;
                
                return clientMatch && statusMatch && priorityMatch;
            });
            
            renderProjectsTable();
            updateChartsWithFilteredData();
        }

        function filterProjectsByDate() {
            const startDate = document.getElementById('projects-start-date').value;
            const endDate = document.getElementById('projects-end-date').value;
            
            if (!startDate && !endDate) {
                filteredProjects = [...projectsData];
            } else {
                filteredProjects = projectsData.filter(project => {
                    const projectDueDate = new Date(project.dueDate);
                    const filterStartDate = startDate ? new Date(startDate) : new Date('1900-01-01');
                    const filterEndDate = endDate ? new Date(endDate) : new Date('2100-12-31');
                    
                    return projectDueDate >= filterStartDate && projectDueDate <= filterEndDate;
                });
            }
            
            // Apply other filters as well
            filterProjects();
        }

        function resetProjectFilters() {
            document.getElementById('client-filter').value = '';
            document.getElementById('status-filter').value = '';
            document.getElementById('priority-filter').value = '';
            filteredProjects = [...projectsData];
            renderProjectsTable();
        }

        function resetProjectsDateFilter() {
            // Reset to show all data from dataset start
            const datasetStartDate = '2023-01-02'; // First Monday of dataset
            const today = new Date();
            const todayString = today.toISOString().split('T')[0];
            
            document.getElementById('projects-start-date').value = datasetStartDate;
            document.getElementById('projects-end-date').value = todayString;
            
            const statusElement = document.getElementById('date-filter-status');
            if (statusElement) statusElement.textContent = 'Showing: Total (All Time) Data';
            
            filterProjectsByDate();
            showToast('Projects filter reset to show all data from Jan 2, 2023 📅', 'success');
        }

        function applyProjectsDateFilter() {
            const startDate = document.getElementById('projects-start-date').value;
            const endDate = document.getElementById('projects-end-date').value;
            const statusElement = document.getElementById('date-filter-status');
            
            if (!startDate && !endDate) {
                filteredProjects = [...projectsData];
                statusElement.textContent = 'Showing: Lifetime Data';
            } else {
                filteredProjects = projectsData.filter(project => {
                    const projectStartDate = new Date(project.startDate);
                    const projectEndDate = project.completedDate ? new Date(project.completedDate) : new Date(project.dueDate);
                    const filterStartDate = startDate ? new Date(startDate) : new Date('1900-01-01');
                    const filterEndDate = endDate ? new Date(endDate) : new Date('2100-12-31');
                    
                    // Project overlaps with date range if it starts before filter end and ends after filter start
                    return projectStartDate <= filterEndDate && projectEndDate >= filterStartDate;
                });
                
                const startText = startDate ? new Date(startDate).toLocaleDateString() : 'Beginning';
                const endText = endDate ? new Date(endDate).toLocaleDateString() : 'Present';
                statusElement.textContent = `Showing: ${startText} to ${endText}`;
            }
            
            // Apply other filters as well
            filterProjects();
            
            // Update charts with filtered data
            updateChartsWithFilteredData();
            
            const filterCount = filteredProjects.length;
            showToast(`Applied date filter: ${filterCount} projects found 📅`, 'info');
        }

        function updateChartsWithFilteredData() {
            // Only update charts if we're on the projects page
            const projectsPage = document.getElementById('projects-content');
            if (!projectsPage || !projectsPage.classList.contains('active')) {
                return;
            }
            
            if (!savingsChart || !projectsChart) {
                // Charts not initialized, try to initialize them
                initializeChartsIfNeeded();
                if (!savingsChart || !projectsChart) {
                    console.log('Charts still not available after initialization attempt');
                    return;
                }
            }
            
            // Filter projects by date range
            const startDate = document.getElementById('projects-start-date').value;
            const endDate = document.getElementById('projects-end-date').value;
            
            // Generate chart data based on filtered projects
            const filteredSavingsData = generateSavingsChartData(filteredProjects, startDate, endDate);
            const filteredProjectsData = generateProjectsChartData(filteredProjects, startDate, endDate);
            
            // Update charts
            savingsChart.data = filteredSavingsData;
            projectsChart.data = filteredProjectsData;
            
            savingsChart.update('active');
            projectsChart.update('active');
            
            // Update cumulative totals
            const totalSavings = filteredProjects.reduce((sum, p) => sum + p.actualSavings, 0);
            const completedProjects = filteredProjects.filter(p => p.status === 'Completed').length;
            
            document.querySelector('#savingsChart').parentElement.querySelector('.text-green-600').textContent = 
                `Cumulative: $${(totalSavings / 1000000).toFixed(1)}M`;
            document.querySelector('#projectsChart').parentElement.querySelector('.text-blue-600').textContent = 
                `Total: ${filteredProjects.length} Projects`;
        }

        function generateSavingsChartData(projects, startDate, endDate) {
            // Generate monthly savings data based on project completion dates
            const months = [];
            const cumulativeSavings = [];
            const monthlySavings = [];
            
            // Create date range for chart (updated timeline Jan 2023 - Aug 2025)
            const chartStart = startDate ? new Date(startDate) : new Date('2023-01-01');
            const chartEnd = endDate ? new Date(endDate) : new Date('2025-08-31');
            
            let currentDate = new Date(chartStart);
            let runningTotal = 0;
            
            while (currentDate <= chartEnd) {
                const monthStr = currentDate.toLocaleDateString('en-US', { month: 'short', year: 'numeric' });
                months.push(monthStr);
                
                // Calculate monthly savings from projects completed in this month
                const monthSavings = projects
                    .filter(p => {
                        if (!p.completedDate) return false;
                        const completedDate = new Date(p.completedDate);
                        return completedDate.getMonth() === currentDate.getMonth() && 
                               completedDate.getFullYear() === currentDate.getFullYear();
                    })
                    .reduce((sum, p) => sum + p.actualSavings, 0) / 1000000;
                
                monthlySavings.push(monthSavings);
                runningTotal += monthSavings;
                cumulativeSavings.push(runningTotal);
                
                currentDate.setMonth(currentDate.getMonth() + 1);
            }
            
            return {
                labels: months,
                datasets: [{
                    label: 'Cumulative Savings ($M)',
                    data: cumulativeSavings,
                    borderColor: '#10B981',
                    backgroundColor: 'rgba(16, 185, 129, 0.1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.4,
                    pointBackgroundColor: '#10B981',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5,
                    pointHoverRadius: 7
                }, {
                    label: 'Monthly Savings ($M)',
                    data: monthlySavings,
                    borderColor: '#3B82F6',
                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                    borderWidth: 2,
                    fill: false,
                    tension: 0.4,
                    pointBackgroundColor: '#3B82F6',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 4,
                    pointHoverRadius: 6
                }]
            };
        }

        function generateProjectsChartData(projects, startDate, endDate) {
            // Generate monthly project completion data
            const months = [];
            const cumulativeProjects = [];
            const monthlyCompletions = [];
            
            // Create date range for chart (updated timeline Jan 2023 - Aug 2025)
            const chartStart = startDate ? new Date(startDate) : new Date('2023-01-01');
            const chartEnd = endDate ? new Date(endDate) : new Date('2025-08-31');
            
            let currentDate = new Date(chartStart);
            let runningTotal = 0;
            
            while (currentDate <= chartEnd) {
                const monthStr = currentDate.toLocaleDateString('en-US', { month: 'short', year: 'numeric' });
                months.push(monthStr);
                
                // Calculate projects completed in this month
                const monthCompletions = projects
                    .filter(p => {
                        if (!p.completedDate) return false;
                        const completedDate = new Date(p.completedDate);
                        return completedDate.getMonth() === currentDate.getMonth() && 
                               completedDate.getFullYear() === currentDate.getFullYear();
                    }).length;
                
                monthlyCompletions.push(monthCompletions);
                runningTotal += monthCompletions;
                cumulativeProjects.push(runningTotal);
                
                currentDate.setMonth(currentDate.getMonth() + 1);
            }
            
            return {
                labels: months,
                datasets: [{
                    label: 'Cumulative Projects',
                    data: cumulativeProjects,
                    borderColor: '#8B5CF6',
                    backgroundColor: 'rgba(139, 92, 246, 0.1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.4,
                    pointBackgroundColor: '#8B5CF6',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5,
                    pointHoverRadius: 7
                }, {
                    label: 'Projects Completed',
                    data: monthlyCompletions,
                    borderColor: '#F59E0B',
                    backgroundColor: 'rgba(245, 158, 11, 0.1)',
                    borderWidth: 2,
                    fill: false,
                    tension: 0.4,
                    pointBackgroundColor: '#F59E0B',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 4,
                    pointHoverRadius: 6
                }]
            };
        }

        function openProjectModal(projectId) {
            const project = projectsData.find(p => p.id === projectId);
            if (!project) return;
            
            const modal = document.getElementById('project-modal');
            const title = document.getElementById('project-modal-title');
            const content = document.getElementById('project-modal-content');
            
            title.textContent = project.name;
            content.innerHTML = `
                <div class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <h4 class="font-medium text-blue-800 mb-2">Client</h4>
                            <p class="text-xl font-bold text-blue-900">${project.client}</p>
                            <p class="text-sm text-blue-600">${project.category}</p>
                        </div>
                        <div class="bg-green-50 p-4 rounded-lg">
                            <h4 class="font-medium text-green-800 mb-2">Savings Target</h4>
                            <p class="text-xl font-bold text-green-900">$${(project.savingsTarget / 1000).toFixed(0)}K</p>
                            <p class="text-sm text-green-600">Actual: $${(project.actualSavings / 1000).toFixed(0)}K</p>
                        </div>
                        <div class="bg-purple-50 p-4 rounded-lg">
                            <h4 class="font-medium text-purple-800 mb-2">Priority & Status</h4>
                            <p class="text-xl font-bold text-purple-900">${project.priority}</p>
                            <p class="text-sm text-purple-600">${project.status}</p>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="font-medium text-gray-900 mb-3">Project Timeline</h4>
                            <div class="space-y-2">
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600">Start Date:</span>
                                    <span class="text-sm font-medium">${new Date(project.startDate).toLocaleDateString()}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600">Due Date:</span>
                                    <span class="text-sm font-medium">${new Date(project.dueDate).toLocaleDateString()}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600">Progress:</span>
                                    <span class="text-sm font-medium">${project.progress}%</span>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h4 class="font-medium text-gray-900 mb-3">Project Description</h4>
                            <p class="text-sm text-gray-600 mb-4">${project.description}</p>
                            <div class="w-full bg-gray-200 rounded-full h-3">
                                <div class="bg-blue-600 h-3 rounded-full" style="width: ${project.progress}%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            modal.classList.remove('hidden');
            showToast('Opening project details... 📋', 'info');
        }

        // Dashboard Date Filtering Functions
        function applyDashboardDateFilter() {
            const startDate = document.getElementById('dashboard-start-date').value;
            const endDate = document.getElementById('dashboard-end-date').value;
            const statusElement = document.getElementById('dashboard-date-filter-status');
            
            if (!startDate && !endDate) {
                statusElement.textContent = 'Showing: Lifetime Data';
                updateDashboardMetrics();
                showToast('Dashboard showing lifetime data 📅', 'info');
                return;
            }
            
            const filterStartDate = startDate ? new Date(startDate) : new Date('1900-01-01');
            const filterEndDate = endDate ? new Date(endDate) : new Date('2100-12-31');
            
            // Filter projects by date range for dashboard metrics
            const filteredProjects = projectsData.filter(project => {
                const projectStartDate = new Date(project.startDate);
                const projectEndDate = project.completedDate ? new Date(project.completedDate) : new Date(project.dueDate);
                
                return projectStartDate <= filterEndDate && projectEndDate >= filterStartDate;
            });
            
            // Filter PO data by placed date
            const filteredPOs = poData.filter(po => {
                const poDate = new Date(po.placedDate);
                return poDate >= filterStartDate && poDate <= filterEndDate;
            });
            
            // Calculate filtered metrics
            const totalSavings = filteredProjects.reduce((sum, p) => sum + p.actualSavings, 0);
            const activeProjects = filteredProjects.filter(p => p.status === 'In Progress' || p.status === 'Planning').length;
            const activePOs = filteredPOs.filter(po => po.status === 'Active').length;
            const totalSpend = filteredPOs.reduce((sum, po) => sum + po.amount, 0);
            
            // Update dashboard display
            updateDashboardDisplay(totalSpend, totalSavings, activeProjects, activePOs);
            
            const startText = startDate ? new Date(startDate).toLocaleDateString() : 'Beginning';
            const endText = endDate ? new Date(endDate).toLocaleDateString() : 'Present';
            statusElement.textContent = `Showing: ${startText} to ${endText}`;
            
            showToast(`Dashboard filtered: $${(totalSpend/1000000).toFixed(1)}M spend, ${activeProjects} projects, ${activePOs} active POs 📅`, 'info');
        }

        // Metrics Time Filter Function
        function applyMetricsTimeFilter() {
            const timeFilter = document.getElementById('metrics-time-filter').value;
            const statusElement = document.getElementById('dashboard-date-filter-status');
            
            let displayText = '';
            let metricsData = {};
            
            switch(timeFilter) {
                case 'total':
                    displayText = 'Showing: Total (All Time) Data';
                    metricsData = {
                        totalSpend: '$2.4M',
                        platformSavings: '$12,395',
                        activeProjects: '23',
                        activePOs: '335',
                        programSavings: '$1.5M',
                        otdRate: '78.2%',
                        qualityPPM: '150',
                        responseTime: '1.2 days',
                        // Secondary metrics
                        spendChange: '+12% vs last month',
                        savingsRate: '+$1,847/day avg',
                        projectsEnding: '3 ending this week',
                        posNeedApproval: '5 need approval'
                    };
                    break;
                case 'monthly':
                    displayText = 'Showing: Monthly Breakdown';
                    metricsData = {
                        totalSpend: '$245K',
                        platformSavings: '$2,385',
                        activeProjects: '8',
                        activePOs: '16',
                        programSavings: '$156K',
                        otdRate: '82.1%',
                        qualityPPM: '145',
                        responseTime: '1.1 days',
                        // Secondary metrics
                        spendChange: '+8% vs last month',
                        savingsRate: '+$79/day avg',
                        projectsEnding: '2 ending this month',
                        posNeedApproval: '3 need approval'
                    };
                    break;
                case 'weekly':
                    displayText = 'Showing: Weekly Breakdown';
                    metricsData = {
                        totalSpend: '$58K',
                        platformSavings: '$580',
                        activeProjects: '3',
                        activePOs: '7',
                        programSavings: '$38K',
                        otdRate: '85.3%',
                        qualityPPM: '142',
                        responseTime: '0.9 days',
                        // Secondary metrics
                        spendChange: '+15% vs last week',
                        savingsRate: '+$83/day avg',
                        projectsEnding: '1 ending this week',
                        posNeedApproval: '2 need approval'
                    };
                    break;
                case 'daily':
                    displayText = 'Showing: Daily Breakdown';
                    metricsData = {
                        totalSpend: '$8.2K',
                        platformSavings: '$84',
                        activeProjects: '1',
                        activePOs: '2',
                        programSavings: '$5.4K',
                        otdRate: '88.7%',
                        qualityPPM: '138',
                        responseTime: '0.8 days',
                        // Secondary metrics
                        spendChange: '+22% vs yesterday',
                        savingsRate: '+$84/day avg',
                        projectsEnding: '0 ending today',
                        posNeedApproval: '1 needs approval'
                    };
                    break;
            }
            
            statusElement.textContent = displayText;
            updateDashboardMetricsDisplay(metricsData);
            showToast(`Dashboard updated to ${timeFilter} view 📊`, 'success');
        }

        function updateDashboardMetricsDisplay(metricsData) {
            // Update Total Spend
            const totalSpendElements = document.querySelectorAll('.total-spend-value');
            totalSpendElements.forEach(el => el.textContent = metricsData.totalSpend);
            
            // Update Platform Savings
            const platformSavingsElements = document.querySelectorAll('.platform-savings-value');
            platformSavingsElements.forEach(el => el.textContent = metricsData.platformSavings);
            
            // Update Active Projects
            const activeProjectsElements = document.querySelectorAll('.active-projects-value');
            activeProjectsElements.forEach(el => el.textContent = metricsData.activeProjects);
            
            // Update Active POs
            const activePOsElements = document.querySelectorAll('.active-pos-value');
            activePOsElements.forEach(el => el.textContent = metricsData.activePOs);
            
            // Update Organizational KPIs if they exist
            const programSavingsEl = document.querySelector('.program-savings-value');
            if (programSavingsEl) programSavingsEl.textContent = metricsData.programSavings;
            
            const otdRateEl = document.querySelector('.otd-rate-value');
            if (otdRateEl) otdRateEl.textContent = metricsData.otdRate;
            
            const qualityPPMEl = document.querySelector('.quality-ppm-value');
            if (qualityPPMEl) qualityPPMEl.textContent = metricsData.qualityPPM;
            
            const responseTimeEl = document.querySelector('.response-time-value');
            if (responseTimeEl) responseTimeEl.textContent = metricsData.responseTime;
            
            // Update ALL secondary metrics using CSS classes
            
            // Update spend change percentage
            const spendChangeEl = document.querySelector('.spend-change-text');
            if (spendChangeEl) spendChangeEl.textContent = metricsData.spendChange;
            
            // Update savings rate (daily average)
            const savingsRateEl = document.getElementById('savingsRate');
            if (savingsRateEl) savingsRateEl.textContent = metricsData.savingsRate;
            
            // Update projects ending text
            const projectsEndingEl = document.querySelector('.projects-ending-text');
            if (projectsEndingEl) projectsEndingEl.textContent = metricsData.projectsEnding;
            
            // Update POs need approval text
            const posApprovalEl = document.querySelector('.pos-approval-text');
            if (posApprovalEl) posApprovalEl.textContent = metricsData.posNeedApproval;
        }

        function updateDashboardDisplay(totalSpend, totalSavings, activeProjects, activePOs) {
            // Update dashboard cards with filtered data
            const totalSpendCard = document.querySelector('.bg-white .text-2xl:contains("$2.4M")');
            const activeProjCard = document.querySelector('.bg-white .text-2xl:contains("23")');
            const activePOCard = document.querySelector('.bg-white .text-2xl:contains("47")');
            
            // Note: This is a simplified approach for demo purposes
            // In a real app, you'd have specific IDs for each metric
        }

        function updateDashboardMetrics() {
            // Reset to lifetime data
            const totalSpend = poData.reduce((sum, po) => sum + po.amount, 0);
            const activePOs = poData.filter(po => po.status === 'Active').length;
            const activeProjects = projectsData.filter(p => p.status === 'In Progress' || p.status === 'Planning').length;
            
            // This would update the actual dashboard display in a real implementation
        }

        function resetDashboardDateFilter() {
            // Reset to show all data from dataset start
            const datasetStartDate = '2023-01-02'; // First Monday of dataset
            const today = new Date();
            const todayString = today.toISOString().split('T')[0];
            
            document.getElementById('dashboard-start-date').value = datasetStartDate;
            document.getElementById('dashboard-end-date').value = todayString;
            
            // Reset time filter dropdown to "total"
            const timeFilter = document.getElementById('metrics-time-filter');
            if (timeFilter) timeFilter.value = 'total';
            
            document.getElementById('dashboard-date-filter-status').textContent = 'Showing: Total (All Time) Data';
            
            // Update metrics to total view
            applyMetricsTimeFilter();
            
            showToast('Dashboard reset to show all data from Jan 2, 2023 📅', 'success');
        }

        // New Project Functions
        function showNewProjectForm() {
            const modal = document.getElementById('new-project-modal');
            modal.classList.remove('hidden');
            
            // Clear form
            document.getElementById('new-project-form').reset();
            document.getElementById('ai-suggestions').innerHTML = '<p class="text-gray-500 text-sm">Click "Generate Suggestions" to get AI-powered project recommendations based on your current KPIs and initiatives.</p>';
            
            showToast('Opening new project form... 📁', 'info');
        }

        function submitNewProject(event) {
            event.preventDefault();
            
            const projectName = document.getElementById('project-name').value;
            const client = document.getElementById('project-client').value;
            const priority = document.getElementById('project-priority').value;
            
            // For demo purposes, just show success message
            showToast(`Project "${projectName}" created successfully! 🎉`, 'success');
            closeModal('new-project-modal');
            
            // In a real app, this would add the project to the data and refresh the table
        }

        function generateAISuggestions() {
            const suggestionsContainer = document.getElementById('ai-suggestions');
            
            // Show loading state
            suggestionsContainer.innerHTML = '<div class="flex items-center text-gray-500"><div class="animate-spin rounded-full h-4 w-4 border-b-2 border-purple-600 mr-2"></div>Analyzing your data to generate suggestions...</div>';
            
            // Simulate AI processing delay
            setTimeout(() => {
                const suggestions = [
                    {
                        title: 'Supplier Consolidation Initiative',
                        reason: 'Current supplier diversity (234 suppliers) suggests opportunity for 15-20% cost reduction through consolidation',
                        category: 'Strategic',
                        estimatedSavings: '$850,000',
                        priority: 'High'
                    },
                    {
                        title: 'Digital Invoice Processing Automation',
                        reason: 'Based on 47 active POs and manual processing patterns, automation could save 72% processing time',
                        category: 'Technology',
                        estimatedSavings: '$320,000',
                        priority: 'Medium'
                    },
                    {
                        title: 'Quality Improvement Program',
                        reason: 'PPM at 485 (vs 100 target) indicates significant quality cost opportunity',
                        category: 'Manufacturing',
                        estimatedSavings: '$1,200,000',
                        priority: 'Critical'
                    },
                    {
                        title: 'On-Time Delivery Enhancement',
                        reason: 'Current 78.2% OTD vs 95% target suggests supply chain optimization potential',
                        category: 'Logistics',
                        estimatedSavings: '$640,000',
                        priority: 'High'
                    }
                ];
                
                suggestionsContainer.innerHTML = suggestions.map(suggestion => `
                    <div class="border border-gray-200 rounded-lg p-4 hover:bg-gray-50 cursor-pointer" onclick="fillProjectForm('${suggestion.title}', '${suggestion.category}', '${suggestion.priority}', '${suggestion.estimatedSavings}')">
                        <div class="flex items-start justify-between">
                            <div class="flex-1">
                                <h4 class="font-medium text-gray-900">${suggestion.title}</h4>
                                <p class="text-sm text-gray-600 mt-1">${suggestion.reason}</p>
                                <div class="flex items-center space-x-4 mt-2">
                                    <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded">${suggestion.category}</span>
                                    <span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded">${suggestion.estimatedSavings}</span>
                                    <span class="text-xs bg-orange-100 text-orange-800 px-2 py-1 rounded">${suggestion.priority}</span>
                                </div>
                            </div>
                            <button class="text-blue-600 hover:text-blue-800 text-sm font-medium ml-4">Use This</button>
                        </div>
                    </div>
                `).join('');
                
                showToast('AI suggestions generated! 🤖', 'success');
            }, 2000);
        }

        function fillProjectForm(title, category, priority, savings) {
            document.getElementById('project-name').value = title;
            document.getElementById('project-category').value = category;
            document.getElementById('project-priority').value = priority;
            document.getElementById('project-savings').value = parseInt(savings.replace(/[$,]/g, ''));
            
            showToast('Project form filled with AI suggestion! ✨', 'success');
        }

        // Project Stats Detail Functions
        function showProjectStatsDetail(statsType) {
            const modal = document.getElementById('project-stats-modal');
            const title = document.getElementById('stats-modal-title');
            const content = document.getElementById('stats-modal-content');
            
            const statsData = {
                'active-projects': {
                    title: 'Active Projects Breakdown',
                    content: `
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="bg-blue-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-blue-800 mb-2">Total Active</h4>
                                    <p class="text-2xl font-bold text-blue-900">23</p>
                                    <p class="text-sm text-blue-600">Projects in progress</p>
                                </div>
                                <div class="bg-orange-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-orange-800 mb-2">Due This Week</h4>
                                    <p class="text-2xl font-bold text-orange-900">3</p>
                                    <p class="text-sm text-orange-600">Require attention</p>
                                </div>
                                <div class="bg-red-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-red-800 mb-2">Critical Priority</h4>
                                    <p class="text-2xl font-bold text-red-900">6</p>
                                    <p class="text-sm text-red-600">High impact projects</p>
                                </div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h4 class="font-medium text-gray-900 mb-3">Projects by Status</h4>
                                    <div class="space-y-2">
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">In Progress</span>
                                            <span class="text-sm font-semibold text-blue-600">11 projects</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Planning</span>
                                            <span class="text-sm font-semibold text-yellow-600">6 projects</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Completed</span>
                                            <span class="text-sm font-semibold text-green-600">4 projects</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">On Hold</span>
                                            <span class="text-sm font-semibold text-orange-600">1 project</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Cancelled</span>
                                            <span class="text-sm font-semibold text-red-600">1 project</span>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <h4 class="font-medium text-gray-900 mb-3">Projects by Client</h4>
                                    <div class="space-y-2">
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">TechCorp Inc</span>
                                            <span class="text-sm font-semibold text-gray-900">3 projects</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Energy Solutions</span>
                                            <span class="text-sm font-semibold text-gray-900">3 projects</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Healthcare Systems</span>
                                            <span class="text-sm font-semibold text-gray-900">3 projects</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Auto Manufacturing</span>
                                            <span class="text-sm font-semibold text-gray-900">3 projects</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Industrial Solutions</span>
                                            <span class="text-sm font-semibold text-gray-900">3 projects</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Others</span>
                                            <span class="text-sm font-semibold text-gray-900">8 projects</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `
                },
                'total-savings': {
                    title: 'Total Savings Analysis',
                    content: `
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="bg-green-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-green-800 mb-2">Total Achieved</h4>
                                    <p class="text-2xl font-bold text-green-900">$2.4M</p>
                                    <p class="text-sm text-green-600">Actual savings</p>
                                </div>
                                <div class="bg-blue-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-blue-800 mb-2">Total Targeted</h4>
                                    <p class="text-2xl font-bold text-blue-900">$32.7M</p>
                                    <p class="text-sm text-blue-600">All projects combined</p>
                                </div>
                                <div class="bg-purple-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-purple-800 mb-2">Achievement Rate</h4>
                                    <p class="text-2xl font-bold text-purple-900">7.3%</p>
                                    <p class="text-sm text-purple-600">Of total targets</p>
                                </div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h4 class="font-medium text-gray-900 mb-3">Savings by Category</h4>
                                    <div class="space-y-3">
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Energy Projects</span>
                                            <span class="text-sm font-semibold text-green-600">$4.435M</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Automotive Projects</span>
                                            <span class="text-sm font-semibold text-green-600">$1.260M</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Healthcare Projects</span>
                                            <span class="text-sm font-semibold text-green-600">$975K</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Retail Projects</span>
                                            <span class="text-sm font-semibold text-green-600">$1.1M</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Technology Projects</span>
                                            <span class="text-sm font-semibold text-green-600">$1.212M</span>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <h4 class="font-medium text-gray-900 mb-3">Top Performing Projects</h4>
                                    <div class="space-y-2">
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Smart Grid Components</span>
                                            <span class="text-sm font-semibold text-green-600">$2.635M</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Renewable Energy Infrastructure</span>
                                            <span class="text-sm font-semibold text-green-600">$1.8M</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Automotive Parts Rationalization</span>
                                            <span class="text-sm font-semibold text-green-600">$1.26M</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Pharmaceutical Raw Materials</span>
                                            <span class="text-sm font-semibold text-green-600">$975K</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `
                },
                'avg-timeline': {
                    title: 'Average Timeline Analysis',
                    content: `
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="bg-purple-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-purple-800 mb-2">Average Duration</h4>
                                    <p class="text-2xl font-bold text-purple-900">12.5</p>
                                    <p class="text-sm text-purple-600">Weeks per project</p>
                                </div>
                                <div class="bg-green-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-green-800 mb-2">Shortest Project</h4>
                                    <p class="text-2xl font-bold text-green-900">4</p>
                                    <p class="text-sm text-green-600">Weeks (Office Supplies)</p>
                                </div>
                                <div class="bg-orange-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-orange-800 mb-2">Longest Project</h4>
                                    <p class="text-2xl font-bold text-orange-900">34</p>
                                    <p class="text-sm text-orange-600">Weeks (Renewable Energy)</p>
                                </div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h4 class="font-medium text-gray-900 mb-3">Timeline by Category</h4>
                                    <div class="space-y-3">
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Technology Projects</span>
                                            <span class="text-sm font-semibold text-gray-900">8.2 weeks avg</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Office Projects</span>
                                            <span class="text-sm font-semibold text-gray-900">4.0 weeks avg</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Healthcare Projects</span>
                                            <span class="text-sm font-semibold text-gray-900">16.5 weeks avg</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Manufacturing Projects</span>
                                            <span class="text-sm font-semibold text-gray-900">18.3 weeks avg</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Energy Projects</span>
                                            <span class="text-sm font-semibold text-gray-900">26.7 weeks avg</span>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <h4 class="font-medium text-gray-900 mb-3">Timeline vs Savings Correlation</h4>
                                    <div class="space-y-2">
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Projects under 10 weeks</span>
                                            <span class="text-sm font-semibold text-gray-900">$285K avg savings</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Projects 10-20 weeks</span>
                                            <span class="text-sm font-semibold text-gray-900">$1.2M avg savings</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Projects over 20 weeks</span>
                                            <span class="text-sm font-semibold text-gray-900">$3.1M avg savings</span>
                                        </div>
                                        <div class="mt-4 p-3 bg-blue-50 rounded-lg">
                                            <p class="text-sm text-blue-800">💡 Insight: Longer projects typically deliver higher savings but require more strategic planning</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `
                },
                'success-rate': {
                    title: 'Success Rate Analysis',
                    content: `
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="bg-green-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-green-800 mb-2">Overall Success Rate</h4>
                                    <p class="text-2xl font-bold text-green-900">94%</p>
                                    <p class="text-sm text-green-600">On time & budget</p>
                                </div>
                                <div class="bg-blue-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-blue-800 mb-2">On-Time Delivery</h4>
                                    <p class="text-2xl font-bold text-blue-900">96%</p>
                                    <p class="text-sm text-blue-600">Projects delivered on time</p>
                                </div>
                                <div class="bg-purple-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-purple-800 mb-2">Budget Adherence</h4>
                                    <p class="text-2xl font-bold text-purple-900">98%</p>
                                    <p class="text-sm text-purple-600">Within budget targets</p>
                                </div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h4 class="font-medium text-gray-900 mb-3">Success Rate by Priority</h4>
                                    <div class="space-y-3">
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Critical Priority</span>
                                            <span class="text-sm font-semibold text-green-600">100% success</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">High Priority</span>
                                            <span class="text-sm font-semibold text-green-600">97% success</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Medium Priority</span>
                                            <span class="text-sm font-semibold text-green-600">92% success</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Low Priority</span>
                                            <span class="text-sm font-semibold text-green-600">85% success</span>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <h4 class="font-medium text-gray-900 mb-3">Success Factors</h4>
                                    <div class="space-y-2">
                                        <div class="flex items-center">
                                            <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                                            <span class="text-sm text-gray-600">Clear project requirements (98% impact)</span>
                                        </div>
                                        <div class="flex items-center">
                                            <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                                            <span class="text-sm text-gray-600">Stakeholder engagement (95% impact)</span>
                                        </div>
                                        <div class="flex items-center">
                                            <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                                            <span class="text-sm text-gray-600">Resource availability (92% impact)</span>
                                        </div>
                                        <div class="flex items-center">
                                            <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                                            <span class="text-sm text-gray-600">Risk mitigation planning (88% impact)</span>
                                        </div>
                                        <div class="mt-4 p-3 bg-green-50 rounded-lg">
                                            <p class="text-sm text-green-800">🎯 Key: Projects with clear requirements and engaged stakeholders show 95%+ success rates</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `
                }
            };
            
            if (statsData[statsType]) {
                title.textContent = statsData[statsType].title;
                content.innerHTML = statsData[statsType].content;
                modal.classList.remove('hidden');
                showToast('Opening detailed statistics... 📊', 'info');
            }
        }

        // Supplier Functions
        function showSupplierDetails(sectionType) {
            const modal = document.getElementById('supplier-details-modal');
            const title = document.getElementById('supplier-modal-title');
            const content = document.getElementById('supplier-modal-content');
            
            const supplierData = {
                'total': {
                    title: 'Total Suppliers Overview - 234 Suppliers',
                    content: `
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                <div class="bg-blue-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-blue-800 mb-2">Total Active</h4>
                                    <p class="text-2xl font-bold text-blue-900">187</p>
                                    <p class="text-sm text-blue-600">80% of total</p>
                                </div>
                                <div class="bg-green-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-green-800 mb-2">New This Month</h4>
                                    <p class="text-2xl font-bold text-green-900">12</p>
                                    <p class="text-sm text-green-600">5.1% growth</p>
                                </div>
                                <div class="bg-yellow-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-yellow-800 mb-2">Under Review</h4>
                                    <p class="text-2xl font-bold text-yellow-900">8</p>
                                    <p class="text-sm text-yellow-600">3.4% of total</p>
                                </div>
                                <div class="bg-red-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-red-800 mb-2">Inactive/Suspended</h4>
                                    <p class="text-2xl font-bold text-red-900">47</p>
                                    <p class="text-sm text-red-600">20.1% of total</p>
                                </div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h4 class="font-medium text-gray-900 mb-3">Supplier Growth Trend</h4>
                                    <div class="space-y-3">
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Q1 2024</span>
                                            <span class="text-sm font-semibold text-gray-900">+18 suppliers</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Q4 2023</span>
                                            <span class="text-sm font-semibold text-gray-900">+22 suppliers</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Q3 2023</span>
                                            <span class="text-sm font-semibold text-gray-900">+15 suppliers</span>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <h4 class="font-medium text-gray-900 mb-3">Onboarding Pipeline</h4>
                                    <div class="space-y-3">
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Initial Contact</span>
                                            <span class="text-sm font-semibold text-gray-900">24 prospects</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Due Diligence</span>
                                            <span class="text-sm font-semibold text-gray-900">16 in progress</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Contract Negotiation</span>
                                            <span class="text-sm font-semibold text-gray-900">8 suppliers</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `
                },
                'active': {
                    title: 'Active Suppliers Analysis - 187 Suppliers',
                    content: `
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="bg-green-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-green-800 mb-2">High Performance</h4>
                                    <p class="text-2xl font-bold text-green-900">142</p>
                                    <p class="text-sm text-green-600">76% of active</p>
                                </div>
                                <div class="bg-yellow-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-yellow-800 mb-2">Standard Performance</h4>
                                    <p class="text-2xl font-bold text-yellow-900">38</p>
                                    <p class="text-sm text-yellow-600">20% of active</p>
                                </div>
                                <div class="bg-orange-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-orange-800 mb-2">Needs Improvement</h4>
                                    <p class="text-2xl font-bold text-orange-900">7</p>
                                    <p class="text-sm text-orange-600">4% of active</p>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 mb-3">Active Supplier Performance Metrics</h4>
                                <div class="space-y-4">
                                    <div>
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="text-sm font-medium text-gray-700">On-Time Delivery Rate</span>
                                            <span class="text-sm font-bold text-green-600">92.3%</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-2">
                                            <div class="bg-green-500 h-2 rounded-full" style="width: 92.3%"></div>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="text-sm font-medium text-gray-700">Quality Score (PPM)</span>
                                            <span class="text-sm font-bold text-blue-600">150 PPM</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-2">
                                            <div class="bg-blue-500 h-2 rounded-full" style="width: 85%"></div>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="text-sm font-medium text-gray-700">Average Response Time</span>
                                            <span class="text-sm font-bold text-purple-600">1.2 days</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-2">
                                            <div class="bg-purple-500 h-2 rounded-full" style="width: 78%"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `
                },
                'rating': {
                    title: 'Supplier Rating Analysis - Avg 4.2/5.0',
                    content: `
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
                                <div class="bg-green-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-green-800 mb-2">5 Stars</h4>
                                    <p class="text-2xl font-bold text-green-900">67</p>
                                    <p class="text-sm text-green-600">28.6% suppliers</p>
                                </div>
                                <div class="bg-blue-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-blue-800 mb-2">4 Stars</h4>
                                    <p class="text-2xl font-bold text-blue-900">89</p>
                                    <p class="text-sm text-blue-600">38.0% suppliers</p>
                                </div>
                                <div class="bg-yellow-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-yellow-800 mb-2">3 Stars</h4>
                                    <p class="text-2xl font-bold text-yellow-900">52</p>
                                    <p class="text-sm text-yellow-600">22.2% suppliers</p>
                                </div>
                                <div class="bg-orange-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-orange-800 mb-2">2 Stars</h4>
                                    <p class="text-2xl font-bold text-orange-900">19</p>
                                    <p class="text-sm text-orange-600">8.1% suppliers</p>
                                </div>
                                <div class="bg-red-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-red-800 mb-2">1 Star</h4>
                                    <p class="text-2xl font-bold text-red-900">7</p>
                                    <p class="text-sm text-red-600">3.0% suppliers</p>
                                </div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h4 class="font-medium text-gray-900 mb-3">Top Rated Suppliers</h4>
                                    <div class="space-y-3">
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">TechSource Global</span>
                                            <span class="text-sm font-semibold text-gray-900">⭐⭐⭐⭐⭐ 4.8</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Industrial Solutions Inc</span>
                                            <span class="text-sm font-semibold text-gray-900">⭐⭐⭐⭐⭐ 4.7</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">MedEquip Solutions</span>
                                            <span class="text-sm font-semibold text-gray-900">⭐⭐⭐⭐⭐ 4.6</span>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <h4 class="font-medium text-gray-900 mb-3">Rating Criteria Breakdown</h4>
                                    <div class="space-y-3">
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Delivery Performance</span>
                                            <span class="text-sm font-semibold text-gray-900">4.3/5.0</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Quality Standards</span>
                                            <span class="text-sm font-semibold text-gray-900">4.2/5.0</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Communication</span>
                                            <span class="text-sm font-semibold text-gray-900">4.1/5.0</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Cost Competitiveness</span>
                                            <span class="text-sm font-semibold text-gray-900">4.0/5.0</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `
                },
                'performance': {
                    title: 'Supplier Performance Analysis - 92% OTD',
                    content: `
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="bg-green-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-green-800 mb-2">On-Time Delivery</h4>
                                    <p class="text-2xl font-bold text-green-900">92%</p>
                                    <p class="text-sm text-green-600">+3% vs last quarter</p>
                                </div>
                                <div class="bg-blue-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-blue-800 mb-2">Quality Rate</h4>
                                    <p class="text-2xl font-bold text-blue-900">97.2%</p>
                                    <p class="text-sm text-blue-600">150 PPM defect rate</p>
                                </div>
                                <div class="bg-purple-50 p-4 rounded-lg">
                                    <h4 class="font-medium text-purple-800 mb-2">Cost Variance</h4>
                                    <p class="text-2xl font-bold text-purple-900">-2.1%</p>
                                    <p class="text-sm text-purple-600">Below budget</p>
                                </div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h4 class="font-medium text-gray-900 mb-3">Performance by Category</h4>
                                    <div class="space-y-3">
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Manufacturing</span>
                                            <span class="text-sm font-semibold text-gray-900">94.2% OTD</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Technology</span>
                                            <span class="text-sm font-semibold text-gray-900">89.7% OTD</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Services</span>
                                            <span class="text-sm font-semibold text-gray-900">96.1% OTD</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Logistics</span>
                                            <span class="text-sm font-semibold text-gray-900">91.8% OTD</span>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <h4 class="font-medium text-gray-900 mb-3">Performance Trends</h4>
                                    <div class="space-y-3">
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">January 2024</span>
                                            <span class="text-sm font-semibold text-gray-900">89.2% OTD</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">February 2024</span>
                                            <span class="text-sm font-semibold text-gray-900">91.5% OTD</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">March 2024</span>
                                            <span class="text-sm font-semibold text-gray-900">92.0% OTD</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `
                },
                'categories': {
                    title: 'Supplier Categories Analysis',
                    content: `
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h4 class="font-medium text-gray-900 mb-4">Category Distribution</h4>
                                    <div class="space-y-4">
                                        <div>
                                            <div class="flex justify-between items-center mb-2">
                                                <span class="text-sm font-medium text-gray-700">Manufacturing (67 suppliers)</span>
                                                <span class="text-sm font-bold text-blue-600">28.6%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 rounded-full h-2">
                                                <div class="bg-blue-500 h-2 rounded-full" style="width: 28.6%"></div>
                                            </div>
                                        </div>
                                        <div>
                                            <div class="flex justify-between items-center mb-2">
                                                <span class="text-sm font-medium text-gray-700">Technology (45 suppliers)</span>
                                                <span class="text-sm font-bold text-green-600">19.2%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 rounded-full h-2">
                                                <div class="bg-green-500 h-2 rounded-full" style="width: 19.2%"></div>
                                            </div>
                                        </div>
                                        <div>
                                            <div class="flex justify-between items-center mb-2">
                                                <span class="text-sm font-medium text-gray-700">Services (38 suppliers)</span>
                                                <span class="text-sm font-bold text-purple-600">16.2%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 rounded-full h-2">
                                                <div class="bg-purple-500 h-2 rounded-full" style="width: 16.2%"></div>
                                            </div>
                                        </div>
                                        <div>
                                            <div class="flex justify-between items-center mb-2">
                                                <span class="text-sm font-medium text-gray-700">Logistics (32 suppliers)</span>
                                                <span class="text-sm font-bold text-orange-600">13.7%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 rounded-full h-2">
                                                <div class="bg-orange-500 h-2 rounded-full" style="width: 13.7%"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <h4 class="font-medium text-gray-900 mb-4">Spend by Category (YTD)</h4>
                                    <div class="space-y-3">
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Manufacturing</span>
                                            <span class="text-sm font-semibold text-gray-900">$1.1M (45.8%)</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Technology</span>
                                            <span class="text-sm font-semibold text-gray-900">$780K (32.5%)</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Services</span>
                                            <span class="text-sm font-semibold text-gray-900">$340K (14.2%)</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Logistics</span>
                                            <span class="text-sm font-semibold text-gray-900">$180K (7.5%)</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 mb-3">Category Performance Comparison</h4>
                                <div class="overflow-x-auto">
                                    <table class="min-w-full">
                                        <thead>
                                            <tr class="bg-gray-50">
                                                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Category</th>
                                                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Avg Rating</th>
                                                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">OTD Rate</th>
                                                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Quality Score</th>
                                                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Cost Variance</th>
                                            </tr>
                                        </thead>
                                        <tbody class="divide-y divide-gray-200">
                                            <tr>
                                                <td class="px-4 py-2 text-sm text-gray-900">Manufacturing</td>
                                                <td class="px-4 py-2 text-sm text-gray-900">4.3/5.0</td>
                                                <td class="px-4 py-2 text-sm text-green-600">94.2%</td>
                                                <td class="px-4 py-2 text-sm text-blue-600">97.8%</td>
                                                <td class="px-4 py-2 text-sm text-green-600">-1.8%</td>
                                            </tr>
                                            <tr>
                                                <td class="px-4 py-2 text-sm text-gray-900">Technology</td>
                                                <td class="px-4 py-2 text-sm text-gray-900">4.1/5.0</td>
                                                <td class="px-4 py-2 text-sm text-yellow-600">89.7%</td>
                                                <td class="px-4 py-2 text-sm text-blue-600">96.2%</td>
                                                <td class="px-4 py-2 text-sm text-red-600">+2.1%</td>
                                            </tr>
                                            <tr>
                                                <td class="px-4 py-2 text-sm text-gray-900">Services</td>
                                                <td class="px-4 py-2 text-sm text-gray-900">4.2/5.0</td>
                                                <td class="px-4 py-2 text-sm text-green-600">96.1%</td>
                                                <td class="px-4 py-2 text-sm text-blue-600">98.1%</td>
                                                <td class="px-4 py-2 text-sm text-green-600">-3.2%</td>
                                            </tr>
                                            <tr>
                                                <td class="px-4 py-2 text-sm text-gray-900">Logistics</td>
                                                <td class="px-4 py-2 text-sm text-gray-900">4.0/5.0</td>
                                                <td class="px-4 py-2 text-sm text-yellow-600">91.8%</td>
                                                <td class="px-4 py-2 text-sm text-blue-600">95.9%</td>
                                                <td class="px-4 py-2 text-sm text-green-600">-0.9%</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    `
                },
                'geography': {
                    title: 'Geographic Distribution Analysis',
                    content: `
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h4 class="font-medium text-gray-900 mb-4">Regional Distribution</h4>
                                    <div class="space-y-4">
                                        <div>
                                            <div class="flex justify-between items-center mb-2">
                                                <span class="text-sm font-medium text-gray-700">North America (105 suppliers)</span>
                                                <span class="text-sm font-bold text-blue-600">45%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 rounded-full h-2">
                                                <div class="bg-blue-500 h-2 rounded-full" style="width: 45%"></div>
                                            </div>
                                        </div>
                                        <div>
                                            <div class="flex justify-between items-center mb-2">
                                                <span class="text-sm font-medium text-gray-700">Europe (75 suppliers)</span>
                                                <span class="text-sm font-bold text-green-600">32%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 rounded-full h-2">
                                                <div class="bg-green-500 h-2 rounded-full" style="width: 32%"></div>
                                            </div>
                                        </div>
                                        <div>
                                            <div class="flex justify-between items-center mb-2">
                                                <span class="text-sm font-medium text-gray-700">Asia Pacific (42 suppliers)</span>
                                                <span class="text-sm font-bold text-purple-600">18%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 rounded-full h-2">
                                                <div class="bg-purple-500 h-2 rounded-full" style="width: 18%"></div>
                                            </div>
                                        </div>
                                        <div>
                                            <div class="flex justify-between items-center mb-2">
                                                <span class="text-sm font-medium text-gray-700">Other Regions (12 suppliers)</span>
                                                <span class="text-sm font-bold text-orange-600">5%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 rounded-full h-2">
                                                <div class="bg-orange-500 h-2 rounded-full" style="width: 5%"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <h4 class="font-medium text-gray-900 mb-4">Regional Performance</h4>
                                    <div class="space-y-3">
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">North America OTD</span>
                                            <span class="text-sm font-semibold text-gray-900">93.2%</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Europe OTD</span>
                                            <span class="text-sm font-semibold text-gray-900">91.8%</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Asia Pacific OTD</span>
                                            <span class="text-sm font-semibold text-gray-900">89.5%</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Other Regions OTD</span>
                                            <span class="text-sm font-semibold text-gray-900">94.1%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-900 mb-3">Key Suppliers by Region</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <h5 class="text-sm font-medium text-gray-700 mb-2">North America</h5>
                                        <div class="space-y-2">
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm text-gray-600">Industrial Solutions Inc (Chicago)</span>
                                                <span class="text-sm font-semibold text-gray-900">$1.2M spend</span>
                                            </div>
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm text-gray-600">TechSource Global (San Francisco)</span>
                                                <span class="text-sm font-semibold text-gray-900">$780K spend</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div>
                                        <h5 class="text-sm font-medium text-gray-700 mb-2">Europe</h5>
                                        <div class="space-y-2">
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm text-gray-600">European Logistics Ltd (London)</span>
                                                <span class="text-sm font-semibold text-gray-900">$550K spend</span>
                                            </div>
                                            <div class="flex justify-between items-center">
                                                <span class="text-sm text-gray-600">Alpine Manufacturing (Munich)</span>
                                                <span class="text-sm font-semibold text-gray-900">$420K spend</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `
                }
            };
            
            if (supplierData[sectionType]) {
                title.textContent = supplierData[sectionType].title;
                content.innerHTML = supplierData[sectionType].content;
                modal.classList.remove('hidden');
                showToast('Opening supplier analysis... 🏢', 'info');
            }
        }

        function showAddSupplierForm() {
            const modal = document.getElementById('add-supplier-modal');
            modal.classList.remove('hidden');
            
            // Clear form
            document.getElementById('add-supplier-form').reset();
            document.getElementById('ai-automation-status').classList.add('hidden');
            document.getElementById('ai-suggestions').innerHTML = '<p class="text-sm text-gray-600">AI will automatically research and populate supplier details based on company name and website.</p>';
            
            showToast('Opening supplier onboarding wizard... 🏢', 'info');
        }

        function submitSupplier(event) {
            event.preventDefault();
            
            const supplierName = document.getElementById('supplier-name').value;
            const category = document.getElementById('supplier-category').value;
            
            // For demo purposes, just show success message
            showToast(`Supplier "${supplierName}" added successfully! Welcome to our network! 🎉`, 'success');
            closeModal('add-supplier-modal');
            
            // In a real app, this would add the supplier to the data and refresh the table
        }

        function automateSupplierInfo() {
            const supplierName = document.getElementById('supplier-name').value;
            const supplierWebsite = document.getElementById('supplier-website').value;
            const statusContainer = document.getElementById('ai-automation-status');
            const suggestionsContainer = document.getElementById('ai-suggestions');
            
            if (!supplierName && !supplierWebsite) {
                showToast('Please enter a company name or website for AI automation', 'error');
                return;
            }
            
            // Show loading state
            statusContainer.classList.remove('hidden');
            
            // Simulate AI processing delay
            setTimeout(() => {
                statusContainer.classList.add('hidden');
                
                // Simulate AI-populated data
                const aiData = {
                    name: supplierName || 'TechCorp Industries',
                    category: 'Technology',
                    location: 'Austin, TX',
                    contact: 'procurement@techcorp.com',
                    phone: '+1 (555) 123-4567',
                    website: supplierWebsite || 'https://techcorp.com',
                    description: 'Leading provider of enterprise technology solutions with 15+ years experience. Specializes in cloud infrastructure, cybersecurity, and digital transformation services.'
                };
                
                // Populate form fields
                if (!document.getElementById('supplier-name').value) {
                    document.getElementById('supplier-name').value = aiData.name;
                }
                document.getElementById('supplier-category').value = aiData.category;
                document.getElementById('supplier-location').value = aiData.location;
                document.getElementById('supplier-contact').value = aiData.contact;
                document.getElementById('supplier-phone').value = aiData.phone;
                if (!document.getElementById('supplier-website').value) {
                    document.getElementById('supplier-website').value = aiData.website;
                }
                document.getElementById('supplier-description').value = aiData.description;
                
                // Show AI suggestions
                suggestionsContainer.innerHTML = `
                    <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                        <h4 class="font-medium text-green-800 mb-2">✨ AI Research Complete!</h4>
                        <p class="text-sm text-green-700 mb-3">SynqBot has automatically filled supplier information based on available data:</p>
                        <ul class="text-sm text-green-600 space-y-1">
                            <li>• Company profile and description populated</li>
                            <li>• Primary contact information verified</li>
                            <li>• Industry category auto-detected</li>
                            <li>• Location and website confirmed</li>
                        </ul>
                        <p class="text-xs text-green-500 mt-2">Review and modify the information as needed before submitting.</p>
                    </div>
                `;
                
                showToast('AI automation complete! Review the populated data ✨', 'success');
            }, 3000);
        }

        // Suppliers Data and Management - 234 Suppliers totaling $2.4M YTD Spend
        function generateSuppliersData() {
            const suppliers = [];
            
            // Top tier suppliers (5-10% of total, high spend)
            const tierOneSuppliers = [
                { name: 'Industrial Solutions Inc', initials: 'IS', category: 'Manufacturing', location: 'Chicago, IL', rating: 4.2, spend: 180000, riskStatus: 'Low', status: 'Active', color: 'blue' },
                { name: 'TechSource Global', initials: 'TS', category: 'Technology', location: 'San Francisco, CA', rating: 4.8, spend: 165000, riskStatus: 'Low', status: 'Active', color: 'orange' },
                { name: 'European Logistics Ltd', initials: 'EL', category: 'Logistics', location: 'Amsterdam, NL', rating: 3.9, spend: 142000, riskStatus: 'Medium', status: 'Under Review', color: 'green' },
                { name: 'Nordic Energy Systems', initials: 'NE', category: 'Energy', location: 'Stockholm, Sweden', rating: 4.4, spend: 125000, riskStatus: 'Low', status: 'Active', color: 'green' },
                { name: 'Brazil Mining Corp', initials: 'BM', category: 'Raw Materials', location: 'São Paulo, Brazil', rating: 3.4, spend: 118000, riskStatus: 'High', status: 'Under Review', color: 'green' },
                { name: 'MedEquip Solutions', initials: 'MS', category: 'Healthcare', location: 'Boston, MA', rating: 4.6, spend: 95000, riskStatus: 'Low', status: 'Active', color: 'purple' },
                { name: 'Alpine Manufacturing', initials: 'AM', category: 'Manufacturing', location: 'Munich, Germany', rating: 4.1, spend: 85000, riskStatus: 'Medium', status: 'Active', color: 'blue' },
                { name: 'Digital Solutions Hub', initials: 'DS', category: 'Technology', location: 'Austin, TX', rating: 4.7, spend: 78000, riskStatus: 'Low', status: 'Active', color: 'blue' },
                { name: 'Pacific Components', initials: 'PC', category: 'Electronics', location: 'Singapore', rating: 3.8, spend: 72000, riskStatus: 'High', status: 'Active', color: 'yellow' },
                { name: 'Global Office Supplies', initials: 'GO', category: 'Services', location: 'New York, NY', rating: 4.3, spend: 68000, riskStatus: 'Low', status: 'Active', color: 'indigo' }
            ];
            
            // Mid-tier suppliers (medium spend)
            const tierTwoSuppliers = [
                { name: 'Sunshine Chemicals', initials: 'SC', category: 'Chemicals', location: 'Houston, TX', rating: 3.5, spend: 55000, riskStatus: 'High', status: 'Suspended', color: 'red' },
                { name: 'Eastern Transport Co', initials: 'ET', category: 'Logistics', location: 'Shanghai, China', rating: 3.7, spend: 52000, riskStatus: 'Medium', status: 'Under Review', color: 'orange' },
                { name: 'Precision Tools Ltd', initials: 'PT', category: 'Manufacturing', location: 'Birmingham, UK', rating: 4.0, spend: 48000, riskStatus: 'Low', status: 'Active', color: 'gray' },
                { name: 'Metro Security Systems', initials: 'MS', category: 'Security', location: 'Toronto, Canada', rating: 4.2, spend: 45000, riskStatus: 'Low', status: 'Active', color: 'red' },
                { name: 'Coastal Packaging', initials: 'CP', category: 'Packaging', location: 'Los Angeles, CA', rating: 3.6, spend: 42000, riskStatus: 'Medium', status: 'Inactive', color: 'yellow' }
            ];
            
            // Generate additional suppliers to reach 234 total
            const companyTypes = ['Corp', 'Inc', 'Ltd', 'LLC', 'Solutions', 'Systems', 'Industries', 'Group', 'International', 'Technologies'];
            const categories = ['Manufacturing', 'Technology', 'Services', 'Logistics', 'Healthcare', 'Electronics', 'Chemicals', 'Energy', 'Security', 'Packaging', 'Raw Materials', 'Office Supplies'];
            const cities = [
                'New York, NY', 'Los Angeles, CA', 'Chicago, IL', 'Houston, TX', 'Phoenix, AZ', 'Philadelphia, PA', 'San Antonio, TX', 'San Diego, CA', 'Dallas, TX', 'San Jose, CA',
                'London, UK', 'Paris, France', 'Berlin, Germany', 'Madrid, Spain', 'Rome, Italy', 'Amsterdam, NL', 'Brussels, Belgium', 'Vienna, Austria', 'Stockholm, Sweden', 'Oslo, Norway',
                'Tokyo, Japan', 'Seoul, South Korea', 'Beijing, China', 'Shanghai, China', 'Mumbai, India', 'Delhi, India', 'Bangkok, Thailand', 'Singapore', 'Manila, Philippines', 'Jakarta, Indonesia',
                'São Paulo, Brazil', 'Rio de Janeiro, Brazil', 'Mexico City, Mexico', 'Buenos Aires, Argentina', 'Lima, Peru', 'Santiago, Chile', 'Bogotá, Colombia'
            ];
            const statuses = ['Active', 'Active', 'Active', 'Active', 'Active', 'Active', 'Active', 'Active', 'Under Review', 'Under Review', 'Under Review', 'Inactive', 'Suspended'];
            const riskStatuses = ['Low', 'Low', 'Low', 'Low', 'Low', 'Low', 'Medium', 'Medium', 'Medium', 'Medium', 'High', 'High', 'High'];
            const colors = ['blue', 'green', 'purple', 'yellow', 'red', 'indigo', 'orange', 'gray'];
            
            let idCounter = 1;
            let totalSpend = 0;
            
            // Add tier one suppliers
            tierOneSuppliers.forEach((supplier, index) => {
                suppliers.push({
                    id: `SUP-${String(idCounter).padStart(3, '0')}`,
                    name: supplier.name,
                    initials: supplier.initials,
                    category: supplier.category,
                    location: supplier.location,
                    rating: supplier.rating,
                    spend: supplier.spend,
                    spendDisplay: supplier.spend >= 100000 ? `$${(supplier.spend/1000).toFixed(0)}K` : `$${supplier.spend.toLocaleString()}`,
                    riskStatus: supplier.riskStatus,
                    status: supplier.status,
                    color: supplier.color
                });
                totalSpend += supplier.spend;
                idCounter++;
            });
            
            // Add tier two suppliers
            tierTwoSuppliers.forEach((supplier, index) => {
                suppliers.push({
                    id: `SUP-${String(idCounter).padStart(3, '0')}`,
                    name: supplier.name,
                    initials: supplier.initials,
                    category: supplier.category,
                    location: supplier.location,
                    rating: supplier.rating,
                    spend: supplier.spend,
                    spendDisplay: supplier.spend >= 100000 ? `$${(supplier.spend/1000).toFixed(0)}K` : `$${supplier.spend.toLocaleString()}`,
                    riskStatus: supplier.riskStatus,
                    status: supplier.status,
                    color: supplier.color
                });
                totalSpend += supplier.spend;
                idCounter++;
            });
            
            // Generate remaining suppliers to reach 234 total and $2.4M spend
            const remainingSuppliers = 234 - suppliers.length;
            const remainingSpend = 2400000 - totalSpend;
            const avgRemainingSpend = remainingSpend / remainingSuppliers;
            
            for (let i = 0; i < remainingSuppliers; i++) {
                // Vary spend around the average (50% to 150% of average)
                const spendVariation = 0.5 + Math.random() * 1.0;
                const spend = Math.round(avgRemainingSpend * spendVariation);
                
                const companyName = `${cities[Math.floor(Math.random() * cities.length)].split(',')[0]} ${companyTypes[Math.floor(Math.random() * companyTypes.length)]}`;
                const initials = companyName.split(' ').map(word => word[0]).join('').substring(0, 2);
                const rating = 2.5 + Math.random() * 2.5; // 2.5 to 5.0 rating
                
                suppliers.push({
                    id: `SUP-${String(idCounter).padStart(3, '0')}`,
                    name: companyName,
                    initials: initials,
                    category: categories[Math.floor(Math.random() * categories.length)],
                    location: cities[Math.floor(Math.random() * cities.length)],
                    rating: Math.round(rating * 10) / 10,
                    spend: spend,
                    spendDisplay: spend >= 100000 ? `$${(spend/1000).toFixed(0)}K` : `$${spend.toLocaleString()}`,
                    riskStatus: riskStatuses[Math.floor(Math.random() * riskStatuses.length)],
                    status: statuses[Math.floor(Math.random() * statuses.length)],
                    color: colors[Math.floor(Math.random() * colors.length)]
                });
                idCounter++;
            }
            
            return suppliers;
        }
        
        const suppliersData = generateSuppliersData();

        let filteredSuppliers = [...suppliersData];
        let currentSupplierSort = { column: null, direction: 'asc' };
        let currentSupplierPage = 1;
        let suppliersPerPage = 50;

        function renderSuppliersTable() {
            const tableBody = document.getElementById('suppliers-table-body');
            if (!tableBody) return;

            tableBody.innerHTML = '';

            // Calculate pagination
            const totalSuppliers = filteredSuppliers.length;
            const totalPages = suppliersPerPage === 'all' ? 1 : Math.ceil(totalSuppliers / suppliersPerPage);
            
            // Get suppliers for current page
            let suppliersToShow;
            if (suppliersPerPage === 'all') {
                suppliersToShow = filteredSuppliers;
            } else {
                const startIndex = (currentSupplierPage - 1) * suppliersPerPage;
                const endIndex = startIndex + suppliersPerPage;
                suppliersToShow = filteredSuppliers.slice(startIndex, endIndex);
            }

            suppliersToShow.forEach(supplier => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50 cursor-pointer';
                row.onclick = () => showSupplierProfile(supplier);
                
                // Generate star rating
                const fullStars = Math.floor(supplier.rating);
                const hasHalfStar = supplier.rating % 1 >= 0.5;
                let starsHtml = '';
                for (let i = 0; i < fullStars; i++) {
                    starsHtml += '★';
                }
                if (hasHalfStar) {
                    starsHtml += '☆';
                }
                for (let i = fullStars + (hasHalfStar ? 1 : 0); i < 5; i++) {
                    starsHtml += '☆';
                }

                // Status badge styling
                let statusClass, statusText;
                switch (supplier.status) {
                    case 'Active':
                        statusClass = 'bg-green-100 text-green-800';
                        statusText = 'Active';
                        break;
                    case 'Inactive':
                        statusClass = 'bg-gray-100 text-gray-800';
                        statusText = 'Inactive';
                        break;
                    case 'Under Review':
                        statusClass = 'bg-yellow-100 text-yellow-800';
                        statusText = 'Under Review';
                        break;
                    case 'Suspended':
                        statusClass = 'bg-red-100 text-red-800';
                        statusText = 'Suspended';
                        break;
                    default:
                        statusClass = 'bg-gray-100 text-gray-800';
                        statusText = supplier.status;
                }

                // Risk status badge styling
                let riskClass, riskText;
                switch (supplier.riskStatus) {
                    case 'Low':
                        riskClass = 'bg-green-100 text-green-800';
                        riskText = 'Low Risk';
                        break;
                    case 'Medium':
                        riskClass = 'bg-yellow-100 text-yellow-800';
                        riskText = 'Medium Risk';
                        break;
                    case 'High':
                        riskClass = 'bg-red-100 text-red-800';
                        riskText = 'High Risk';
                        break;
                    default:
                        riskClass = 'bg-gray-100 text-gray-800';
                        riskText = supplier.riskStatus;
                }

                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <div class="w-10 h-10 bg-${supplier.color}-100 rounded-lg flex items-center justify-center">
                                <span class="text-${supplier.color}-600 font-medium text-sm">${supplier.initials}</span>
                            </div>
                            <div class="ml-4">
                                <div class="text-sm font-medium text-gray-900">${supplier.name}</div>
                                <div class="text-sm text-gray-500">Supplier ID: ${supplier.id}</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${supplier.category}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${supplier.location}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <span class="text-yellow-400">${starsHtml}</span>
                            <span class="ml-1 text-sm text-gray-500">${supplier.rating}</span>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${supplier.spendDisplay}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full ${riskClass}">
                            ${riskText}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full ${statusClass}">
                            ${statusText}
                        </span>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });

            // Update pagination controls
            updatePaginationControls(totalSuppliers, totalPages);
        }

        function updatePaginationControls(totalSuppliers, totalPages) {
            const paginationControls = document.getElementById('pagination-controls');
            if (!paginationControls) return;

            // Hide pagination if showing all
            if (suppliersPerPage === 'all') {
                paginationControls.style.display = 'none';
                return;
            } else {
                paginationControls.style.display = 'block';
            }

            // Update showing text
            const startNum = (currentSupplierPage - 1) * suppliersPerPage + 1;
            const endNum = Math.min(currentSupplierPage * suppliersPerPage, totalSuppliers);
            
            document.getElementById('showing-start').textContent = startNum;
            document.getElementById('showing-end').textContent = endNum;
            document.getElementById('total-suppliers').textContent = totalSuppliers;

            // Update prev/next buttons
            const prevBtn = document.getElementById('prev-page');
            const nextBtn = document.getElementById('next-page');
            
            prevBtn.disabled = currentSupplierPage <= 1;
            nextBtn.disabled = currentSupplierPage >= totalPages;

            // Update page numbers
            const pageNumbers = document.getElementById('page-numbers');
            pageNumbers.innerHTML = '';

            const maxPagesToShow = 5;
            let startPage = Math.max(1, currentSupplierPage - Math.floor(maxPagesToShow / 2));
            let endPage = Math.min(totalPages, startPage + maxPagesToShow - 1);
            
            if (endPage - startPage + 1 < maxPagesToShow) {
                startPage = Math.max(1, endPage - maxPagesToShow + 1);
            }

            for (let i = startPage; i <= endPage; i++) {
                const pageBtn = document.createElement('button');
                pageBtn.textContent = i;
                pageBtn.className = `px-3 py-1 text-sm font-medium rounded-lg ${
                    i === currentSupplierPage 
                        ? 'bg-blue-600 text-white' 
                        : 'text-gray-700 hover:bg-gray-100'
                }`;
                pageBtn.onclick = () => goToPage(i);
                pageNumbers.appendChild(pageBtn);
            }
        }

        function changePage(direction) {
            const totalPages = Math.ceil(filteredSuppliers.length / suppliersPerPage);
            const newPage = currentSupplierPage + direction;
            
            if (newPage >= 1 && newPage <= totalPages) {
                currentSupplierPage = newPage;
                renderSuppliersTable();
            }
        }

        function goToPage(page) {
            currentSupplierPage = page;
            renderSuppliersTable();
        }

        function changeSuppliersPerPage() {
            const select = document.getElementById('suppliers-per-page');
            suppliersPerPage = select.value === 'all' ? 'all' : parseInt(select.value);
            currentSupplierPage = 1;
            renderSuppliersTable();
            
            if (suppliersPerPage === 'all') {
                showToast(`Showing all ${filteredSuppliers.length} suppliers`, 'info');
            } else {
                showToast(`Showing ${suppliersPerPage} suppliers per page`, 'info');
            }
        }

        function navigateToSuppliers() {
            showPage('suppliers');
            showToast('Opening supplier directory... 🏢', 'info');
        }

        // PO Management Tab Functions
        function switchPOTab(tabName) {
            // Hide all tab content
            const allTabContent = document.querySelectorAll('.po-tab-content');
            allTabContent.forEach(content => {
                content.classList.add('hidden');
                content.classList.remove('active');
            });

            // Remove active state from all tab buttons
            const allTabButtons = document.querySelectorAll('.po-tab-button');
            allTabButtons.forEach(button => {
                button.classList.remove('border-blue-500', 'text-blue-600');
                button.classList.add('border-transparent', 'text-gray-500');
            });

            // Show selected tab content
            const selectedContent = document.getElementById(`po-tab-${tabName}`);
            if (selectedContent) {
                selectedContent.classList.remove('hidden');
                selectedContent.classList.add('active');
            }

            // Activate selected tab button
            const selectedButton = document.getElementById(`tab-${tabName}`);
            if (selectedButton) {
                selectedButton.classList.add('border-blue-500', 'text-blue-600');
                selectedButton.classList.remove('border-transparent', 'text-gray-500');
            }

            // Show toast notification
            const tabTitles = {
                'order-management': 'Order Management Hub',
                'approvals': 'PO Approvals Queue',
                'supplier-updates': 'Supplier Update Requests',
                'history': 'PO History & Audit Trail',
                'ai-automation': 'AI & Automation Center'
            };
            
            showToast(`Switched to ${tabTitles[tabName] || 'Unknown Tab'} 📋`, 'info');
        }

        // AI & Automation Functions
        function openAIWizard() {
            showToast('🧠 AI Configuration Wizard opening... Advanced settings and training options will be available here.', 'info');
        }

        function configureAutoApproval() {
            showToast('🔧 Auto-approval rules configuration opening... Set thresholds, supplier criteria, and approval workflows.', 'info');
        }

        function viewDetailedAnalytics() {
            showToast('📈 Advanced AI Analytics opening... Predictive insights, risk assessments, and optimization recommendations.', 'info');
        }

        function trainAIModel() {
            showToast('🧠 Enhanced AI training initiated... The system will learn from recent patterns and improve accuracy.', 'success');
        }

        // Supplier Update Functions
        function approveSupplierUpdate(poNumber, updateType) {
            showToast(`✅ Approved ${updateType} for ${poNumber}. ERP will be updated automatically.`, 'success');
        }

        function rejectSupplierUpdate(poNumber, updateType) {
            showToast(`❌ Rejected ${updateType} for ${poNumber}. Supplier will be notified with reason.`, 'info');
        }

        function negotiateSupplierUpdate(poNumber, updateType) {
            showToast(`💬 Opening negotiation portal for ${poNumber} ${updateType}. Real-time chat enabled.`, 'info');
        }

        function autoApproveUpdate(poNumber) {
            showToast(`🤖 AI auto-approved early delivery for ${poNumber}. ERP sync completed.`, 'success');
        }

        function bulkApproveUpdates() {
            showToast('✅ Bulk approval processing... 3 supplier updates approved and synced to ERP.', 'success');
        }

        function exportUpdateRequests() {
            showToast('📊 Exporting supplier update requests to CSV... Download will begin shortly.', 'info');
        }

        function openSupplierChat() {
            showToast('💬 Opening Supplier Communication Portal... Real-time chat with all active suppliers.', 'info');
        }

        // PO Table Functions (placeholders for future development)
        function filterPOTable() {
            showToast('🔍 Filtering active POs... Advanced filtering with real-time updates.', 'info');
        }

        // PO Table Sorting Functionality
        let currentSortColumn = null;
        let currentSortDirection = 'asc';

        function sortPOTable(column) {
            // Determine sort direction
            if (currentSortColumn === column) {
                currentSortDirection = currentSortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                currentSortDirection = 'asc';
                currentSortColumn = column;
            }

            // Clear all sort indicators
            document.querySelectorAll('[id^="sort-"]').forEach(indicator => {
                indicator.textContent = '↕';
            });

            // Set current sort indicator
            const indicator = document.getElementById(`sort-${column}`);
            if (indicator) {
                indicator.textContent = currentSortDirection === 'asc' ? '↑' : '↓';
            }

            // Sort the data
            currentPOData.sort((a, b) => {
                let valueA, valueB;

                switch (column) {
                    case 'poNumber':
                        valueA = a.id;
                        valueB = b.id;
                        break;
                    case 'vendor':
                        valueA = a.vendor.toLowerCase();
                        valueB = b.vendor.toLowerCase();
                        break;
                    case 'partNumber':
                        valueA = (a.partNumber || '').toLowerCase();
                        valueB = (b.partNumber || '').toLowerCase();
                        break;
                    case 'total':
                        valueA = a.total;
                        valueB = b.total;
                        break;
                    case 'dueDate':
                        valueA = new Date(a.dueDate);
                        valueB = new Date(b.dueDate);
                        break;
                    default:
                        return 0;
                }

                if (valueA < valueB) return currentSortDirection === 'asc' ? -1 : 1;
                if (valueA > valueB) return currentSortDirection === 'asc' ? 1 : -1;
                return 0;
            });

            // Re-render table
            currentPage = 1; // Reset to first page
            renderPOTable();
            
            showToast(`📊 Sorted by ${column} (${currentSortDirection === 'asc' ? 'ascending' : 'descending'})`, 'success');
        }

        function resetPOFilters() {
            showToast('🔄 PO filters reset. Showing all active purchase orders.', 'info');
        }

        function exportFilteredPOs() {
            showToast('📊 Exporting filtered PO data to CSV... Download starting.', 'info');
        }

        function toggleAllPOs() {
            showToast('📋 Bulk selection toggled for all visible POs.', 'info');
        }

        function togglePOTableView() {
            showToast('👁️ Switching PO table view... Compact/expanded view toggled.', 'info');
        }

        // Approval Functions
        function bulkApproveSelected() {
            showToast('✅ Bulk approval processing... Selected POs approved and ERP updated.', 'success');
        }

        function exportApprovalQueue() {
            showToast('📊 Exporting approval queue to CSV... Download will begin shortly.', 'info');
        }

        // Order Management Hub Functions with SourceDay-inspired functionality
        
        // Comprehensive PO Data matching platform savings
        const purchaseOrdersData = [
            // High-value automation savings POs
            {
                id: 'PO-2024-048',
                vendor: 'TechSource Global',
                vendorCode: 'TSG001',
                total: 127500,
                status: 'pending-approval',
                priority: 'high',
                dueDate: '2024-01-15', // Overdue for approval
                createdDate: '2024-01-05',
                items: 'Office equipment and software licenses',
                lineCount: 4,
                category: 'Technology',
                buyer: 'Sarah Chen',
                partNumber: 'TSG-SW-OFC-2024',
                partDescription: 'Microsoft Office Suite & Hardware Bundle',
                hasMessages: true,
                hasUpdates: true,
                isLate: true,
                erpSync: 'pending',
                flags: ['urgent', 'budget-review'],
                savings: 12450, // Process automation savings
                messages: [
                    { from: 'TechSource Global', content: 'Delivery date change request - raw material shortage', timestamp: '2 hours ago' },
                    { from: 'Sarah Chen', content: 'Approved budget increase for Q2 requirements', timestamp: '1 day ago' }
                ],
                auditTrail: [
                    { action: 'Created', user: 'Sarah Chen', timestamp: '2024-01-05 09:30 AM' },
                    { action: 'Budget Review', user: 'Finance Team', timestamp: '2024-01-08 11:15 AM' },
                    { action: 'Pending Approval', user: 'System', timestamp: '2024-01-10 14:22 PM' }
                ]
            },
            {
                id: 'PO-2024-049',
                vendor: 'Industrial Solutions Inc',
                vendorCode: 'ISI002',
                total: 89200,
                status: 'in-fulfillment',
                priority: 'standard',
                dueDate: '2024-04-05',
                createdDate: '2024-03-10',
                items: 'Manufacturing supplies and maintenance tools',
                lineCount: 6,
                category: 'Manufacturing',
                buyer: 'Mike Rodriguez',
                partNumber: 'ISI-MFG-TOOLS-6X',
                partDescription: 'Industrial Maintenance Tool Set',
                hasMessages: false,
                hasUpdates: false,
                isLate: false,
                erpSync: 'synced',
                flags: [],
                savings: 8920, // Supplier management savings
                messages: [],
                auditTrail: [
                    { action: 'Created', user: 'Mike Rodriguez', timestamp: '2024-03-10 08:45 AM' },
                    { action: 'Auto-Approved', user: 'AI System', timestamp: '2024-03-10 08:47 AM' },
                    { action: 'In Fulfillment', user: 'Industrial Solutions', timestamp: '2024-03-12 10:30 AM' }
                ]
            },
            {
                id: 'PO-2024-050',
                vendor: 'European Logistics Ltd',
                vendorCode: 'ELL003',
                total: 22100,
                status: 'shipped',
                priority: 'urgent',
                dueDate: '2024-03-18',
                createdDate: '2024-03-08',
                items: 'Emergency shipping containers',
                lineCount: 2,
                category: 'Logistics',
                buyer: 'Emma Thompson',
                partNumber: 'ELL-SHIP-EMER-2024',
                partDescription: 'Emergency Logistics Container Set',
                hasMessages: true,
                hasUpdates: true,
                isLate: false,
                erpSync: 'synced',
                flags: ['rush-order'],
                savings: 4200, // Contract optimization savings
                messages: [
                    { from: 'European Logistics', content: 'Early delivery available - 3 days ahead of schedule', timestamp: '3 hours ago' }
                ],
                auditTrail: [
                    { action: 'Created', user: 'Emma Thompson', timestamp: '2024-03-08 14:20 PM' },
                    { action: 'Urgent Approved', user: 'Director', timestamp: '2024-03-08 15:05 PM' },
                    { action: 'Shipped', user: 'European Logistics', timestamp: '2024-03-15 09:00 AM' }
                ]
            },
            {
                id: 'PO-2024-051',
                vendor: 'Nordic Energy Systems',
                vendorCode: 'NES004',
                total: 125000,
                status: 'approved',
                priority: 'standard',
                dueDate: '2024-01-20', // Overdue for supplier acknowledgment
                createdDate: '2024-01-10',
                items: 'Solar panel installation equipment',
                lineCount: 8,
                category: 'Energy',
                buyer: 'Alex Kumar',
                partNumber: 'NES-SOLAR-INST-8PK',
                partDescription: 'Solar Installation Equipment Package',
                hasMessages: true,
                hasUpdates: true,
                isLate: true,
                erpSync: 'pending',
                flags: ['price-change'],
                savings: 2850, // Data analytics savings
                messages: [
                    { from: 'Nordic Energy', content: 'Price adjustment request +2.3% due to material costs', timestamp: '1 day ago' }
                ],
                auditTrail: [
                    { action: 'Created', user: 'Alex Kumar', timestamp: '2024-01-10 11:30 AM' },
                    { action: 'Approved', user: 'Finance Team', timestamp: '2024-01-15 09:15 AM' },
                    { action: 'Awaiting Supplier Acknowledgment', user: 'System', timestamp: '2024-01-15 09:20 AM' }
                ]
            },
            {
                id: 'PO-2024-052',
                vendor: 'MedEquip Solutions',
                vendorCode: 'MES005',
                total: 45600,
                status: 'delivered',
                priority: 'standard',
                dueDate: '2024-03-12',
                createdDate: '2024-02-28',
                items: 'Medical diagnostic equipment',
                lineCount: 3,
                category: 'Healthcare',
                buyer: 'Dr. Jennifer Lee',
                partNumber: 'MES-DIAG-MED-3X',
                partDescription: 'Medical Diagnostic Equipment Set',
                hasMessages: false,
                hasUpdates: false,
                isLate: false,
                erpSync: 'synced',
                flags: ['completed'],
                savings: 1240, // Contract optimization
                messages: [],
                auditTrail: [
                    { action: 'Created', user: 'Dr. Jennifer Lee', timestamp: '2024-02-28 10:15 AM' },
                    { action: 'Auto-Approved', user: 'AI System', timestamp: '2024-02-28 10:17 AM' },
                    { action: 'Delivered', user: 'MedEquip Solutions', timestamp: '2024-03-12 14:30 PM' },
                    { action: 'Completed', user: 'System', timestamp: '2024-03-12 16:45 PM' }
                ]
            },
            // Add more POs with varied savings and statuses to reach 47 total
            {
                id: 'PO-2024-053',
                vendor: 'Alpine Manufacturing',
                vendorCode: 'ALP006',
                total: 67800,
                status: 'shipped',
                priority: 'standard',
                dueDate: '2024-03-22',
                createdDate: '2024-03-05',
                items: 'Precision tooling and machinery parts',
                lineCount: 5,
                category: 'Manufacturing',
                buyer: 'David Wilson',
                hasMessages: false,
                hasUpdates: false,
                isLate: false,
                erpSync: 'synced',
                flags: [],
                savings: 3200,
                messages: [],
                auditTrail: [
                    { action: 'Created', user: 'David Wilson', timestamp: '2024-03-05 13:15 PM' },
                    { action: 'Auto-Approved', user: 'AI System', timestamp: '2024-03-05 13:17 PM' },
                    { action: 'Shipped', user: 'Alpine Manufacturing', timestamp: '2024-03-18 08:30 AM' }
                ]
            },
            {
                id: 'PO-2024-054',
                vendor: 'Global Office Supplies',
                vendorCode: 'GOS007',
                total: 8950,
                status: 'delivered',
                priority: 'low',
                dueDate: '2024-03-10',
                createdDate: '2024-02-25',
                items: 'Office furniture and supplies',
                lineCount: 12,
                category: 'Office',
                buyer: 'Lisa Parker',
                hasMessages: false,
                hasUpdates: false,
                isLate: false,
                erpSync: 'synced',
                flags: ['completed'],
                savings: 450,
                messages: [],
                auditTrail: [
                    { action: 'Created', user: 'Lisa Parker', timestamp: '2024-02-25 10:30 AM' },
                    { action: 'Auto-Approved', user: 'AI System', timestamp: '2024-02-25 10:32 AM' },
                    { action: 'Delivered', user: 'Global Office Supplies', timestamp: '2024-03-10 15:45 PM' }
                ]
            }
            // Generate additional POs programmatically to reach 335 total...
        ];

        // Generate additional POs to reach 335 total (330 additional + 5 base)
        function generateAdditionalPOs() {
            const additionalPOs = [];
            
            // Expanded vendor list with realistic part number prefixes
            const vendors = [
                { name: 'Pacific Components', code: 'PAC008', category: 'Electronics', partPrefix: 'PAC-ELEC' },
                { name: 'Sunshine Chemicals', code: 'SUN009', category: 'Chemicals', partPrefix: 'SUN-CHEM' },
                { name: 'Eastern Transport Co', code: 'ETC010', category: 'Logistics', partPrefix: 'ETC-LOG' },
                { name: 'Precision Tools Ltd', code: 'PTL011', category: 'Tools', partPrefix: 'PTL-TOOL' },
                { name: 'Metro Security Systems', code: 'MSS012', category: 'Security', partPrefix: 'MSS-SEC' },
                { name: 'Coastal Packaging', code: 'CPA013', category: 'Packaging', partPrefix: 'CPA-PKG' },
                { name: 'Global Steel Works', code: 'GSW014', category: 'Materials', partPrefix: 'GSW-STL' },
                { name: 'Advanced Robotics Inc', code: 'ARI015', category: 'Automation', partPrefix: 'ARI-ROB' },
                { name: 'Green Energy Solutions', code: 'GES016', category: 'Energy', partPrefix: 'GES-ENR' },
                { name: 'Quality Textiles Corp', code: 'QTC017', category: 'Textiles', partPrefix: 'QTC-TEX' },
                { name: 'Alpha Manufacturing', code: 'ALM018', category: 'Manufacturing', partPrefix: 'ALM-MFG' },
                { name: 'Beta Software Systems', code: 'BSS019', category: 'Software', partPrefix: 'BSS-SW' },
                { name: 'Delta Medical Supplies', code: 'DMS020', category: 'Healthcare', partPrefix: 'DMS-MED' },
                { name: 'Gamma Construction Co', code: 'GCC021', category: 'Construction', partPrefix: 'GCC-CNST' },
                { name: 'Epsilon Food Services', code: 'EFS022', category: 'Food', partPrefix: 'EFS-FOOD' },
                { name: 'Zeta Automotive Parts', code: 'ZAP023', category: 'Automotive', partPrefix: 'ZAP-AUTO' },
                { name: 'Theta Office Solutions', code: 'TOS024', category: 'Office', partPrefix: 'TOS-OFC' },
                { name: 'Iota Cleaning Services', code: 'ICS025', category: 'Cleaning', partPrefix: 'ICS-CLN' },
                { name: 'Kappa Sports Equipment', code: 'KSE026', category: 'Sports', partPrefix: 'KSE-SPRT' },
                { name: 'Lambda Print Solutions', code: 'LPS027', category: 'Printing', partPrefix: 'LPS-PRT' },
                { name: 'Mu Network Systems', code: 'MNS028', category: 'Networking', partPrefix: 'MNS-NET' },
                { name: 'Nu Safety Equipment', code: 'NSE029', category: 'Safety', partPrefix: 'NSE-SFTY' },
                { name: 'Omicron Labs', code: 'OML030', category: 'Laboratory', partPrefix: 'OML-LAB' },
                { name: 'Pi Instruments Co', code: 'PIC031', category: 'Instruments', partPrefix: 'PIC-INST' },
                { name: 'Rho Facilities Mgmt', code: 'RFM032', category: 'Facilities', partPrefix: 'RFM-FAC' }
            ];
            
            const statuses = ['pending-approval', 'approved', 'in-fulfillment', 'shipped', 'delivered', 'completed'];
            const priorities = ['urgent', 'high', 'standard', 'low'];
            const buyers = ['Sarah Chen', 'Mike Rodriguez', 'Emma Thompson', 'Alex Kumar', 'Dr. Jennifer Lee', 'David Wilson', 'Lisa Parker', 'Tom Anderson', 'Maria Garcia', 'Chris Johnson'];
            
            // Generate part number descriptors by category
            const partDescriptors = {
                'Electronics': ['Circuit Board', 'Sensor Module', 'Control Unit', 'Display Panel', 'Power Supply'],
                'Chemicals': ['Industrial Grade', 'Laboratory Grade', 'Commercial Grade', 'Specialty Compound', 'Base Solution'],
                'Logistics': ['Container System', 'Transport Unit', 'Storage Solution', 'Handling Equipment', 'Tracking Device'],
                'Tools': ['Precision Tool Set', 'Industrial Equipment', 'Maintenance Kit', 'Cutting Tool', 'Measurement Device'],
                'Security': ['Access Control', 'Surveillance System', 'Alarm Component', 'Security Hardware', 'Monitoring Device'],
                'Packaging': ['Container Set', 'Protective Material', 'Shipping Box', 'Label System', 'Sealing Equipment'],
                'Materials': ['Steel Component', 'Raw Material', 'Structural Element', 'Fabricated Part', 'Metal Assembly'],
                'Automation': ['Robotic Arm', 'Control System', 'Servo Motor', 'PLC Module', 'Automation Kit'],
                'Energy': ['Solar Panel', 'Battery Pack', 'Inverter Unit', 'Power Module', 'Energy Storage'],
                'Textiles': ['Fabric Roll', 'Thread Spool', 'Textile Kit', 'Material Sample', 'Fiber Bundle'],
                'Manufacturing': ['Assembly Line', 'Production Tool', 'Quality Control', 'Process Equipment', 'Inspection Kit'],
                'Software': ['License Package', 'Development Kit', 'Security Suite', 'Analytics Platform', 'Integration Tools'],
                'Healthcare': ['Medical Device', 'Diagnostic Kit', 'Surgical Tool', 'Patient Monitor', 'Lab Equipment'],
                'Construction': ['Building Material', 'Foundation Kit', 'Structural Steel', 'Concrete Mix', 'Safety Barrier'],
                'Food': ['Ingredient Kit', 'Packaging Material', 'Processing Equipment', 'Storage Container', 'Quality Control'],
                'Automotive': ['Engine Component', 'Brake System', 'Electrical Part', 'Body Panel', 'Safety Equipment'],
                'Office': ['Furniture Set', 'Computer Hardware', 'Stationary Kit', 'Communication Device', 'Storage Solution'],
                'Cleaning': ['Cleaning Supplies', 'Equipment Kit', 'Chemical Solution', 'Maintenance Tool', 'Safety Gear'],
                'Sports': ['Athletic Equipment', 'Training Kit', 'Safety Gear', 'Facility Equipment', 'Performance Monitor'],
                'Printing': ['Printer Cartridge', 'Paper Supply', 'Binding Equipment', 'Design Software', 'Maintenance Kit'],
                'Networking': ['Network Switch', 'Cable Assembly', 'Router Unit', 'Security Appliance', 'Monitoring Tool'],
                'Safety': ['Protective Equipment', 'Emergency Kit', 'Safety Barrier', 'Warning System', 'First Aid Supply'],
                'Laboratory': ['Analysis Kit', 'Research Equipment', 'Sample Container', 'Measurement Tool', 'Safety Equipment'],
                'Instruments': ['Measurement Device', 'Calibration Kit', 'Testing Equipment', 'Precision Tool', 'Data Logger'],
                'Facilities': ['Maintenance Kit', 'HVAC Component', 'Electrical System', 'Plumbing Supply', 'Building Supply']
            };
            
            // Generate 330 additional POs spanning 2023-2025 for active dataset
            for (let i = 6; i < 335; i++) {
                const vendor = vendors[i % vendors.length];
                const status = statuses[Math.floor(Math.random() * statuses.length)];
                const priority = priorities[Math.floor(Math.random() * priorities.length)];
                const buyer = buyers[Math.floor(Math.random() * buyers.length)];
                
                // Create realistic date ranges over 2 years (Jan 2023 - Aug 2025)
                const startDate = new Date('2023-01-02'); // Monday start
                const endDate = new Date('2025-08-31');
                const timeRange = endDate.getTime() - startDate.getTime();
                const createdDate = new Date(startDate.getTime() + Math.random() * timeRange);
                const dueDate = new Date(createdDate.getTime() + (Math.random() * 60 + 7) * 24 * 60 * 60 * 1000); // 7-67 days
                
                const total = Math.floor(Math.random() * 180000) + 3000; // $3K - $183K range
                const savings = Math.floor(total * (Math.random() * 0.18 + 0.015)); // 1.5-19.5% savings
                
                // Generate realistic part numbers
                const lineCount = Math.floor(Math.random() * 12) + 1;
                const descriptor = partDescriptors[vendor.category][Math.floor(Math.random() * partDescriptors[vendor.category].length)];
                const partNumber = `${vendor.partPrefix}-${String(Math.floor(Math.random() * 9999) + 1).padStart(4, '0')}`;
                const partDescription = `${descriptor} ${lineCount > 1 ? 'Kit' : 'Unit'}`;
                
                // Year formatting for PO ID
                const year = createdDate.getFullYear();
                const poNumber = i < 100 ? String(i + 50).padStart(3, '0') : String(i + 1950).padStart(4, '0');
                
                additionalPOs.push({
                    id: `PO-${year}-${poNumber}`,
                    vendor: vendor.name,
                    vendorCode: vendor.code,
                    total: total,
                    status: status,
                    priority: priority,
                    dueDate: dueDate.toISOString().split('T')[0],
                    createdDate: createdDate.toISOString().split('T')[0],
                    items: `${vendor.category} supplies and equipment`,
                    lineCount: lineCount,
                    category: vendor.category,
                    buyer: buyer,
                    partNumber: partNumber,
                    partDescription: partDescription,
                    hasMessages: Math.random() > 0.75,
                    hasUpdates: Math.random() > 0.85,
                    isLate: (status === 'pending-approval' || status === 'approved') && Math.random() > 0.85,
                    erpSync: Math.random() > 0.12 ? 'synced' : (Math.random() > 0.5 ? 'pending' : 'error'),
                    flags: Math.random() > 0.82 ? [priority === 'urgent' ? 'urgent' : priority === 'high' ? 'budget-review' : 'standard'] : [],
                    savings: savings,
                    messages: Math.random() > 0.75 ? [
                        { from: vendor.name, content: 'Status update on your order', timestamp: `${Math.floor(Math.random() * 72)} hours ago` }
                    ] : [],
                    auditTrail: [
                        { action: 'Created', user: buyer, timestamp: createdDate.toLocaleDateString() + ' ' + createdDate.toLocaleTimeString() },
                        { action: status === 'pending-approval' ? 'Pending Approval' : status === 'approved' ? 'Approved' : 'Auto-Approved', user: status === 'pending-approval' ? 'System' : (status === 'approved' ? 'Manager' : 'AI System'), timestamp: createdDate.toLocaleDateString() + ' ' + createdDate.toLocaleTimeString() }
                    ]
                });
            }
            
            return additionalPOs;
        }

        // Merge base POs with generated ones
        purchaseOrdersData.push(...generateAdditionalPOs());

        // Validate and adjust total spend to match $2.4M target
        function validateAndAdjustPOSpend() {
            let totalSpend = purchaseOrdersData.reduce((sum, po) => sum + po.total, 0);
            const targetSpend = 2400000; // $2.4M
            
            console.log('Initial total spend:', totalSpend.toLocaleString());
            console.log('Target spend:', targetSpend.toLocaleString());
            
            if (Math.abs(totalSpend - targetSpend) > 1000) { // If off by more than $1k
                const adjustmentFactor = targetSpend / totalSpend;
                console.log('Adjustment factor:', adjustmentFactor);
                
                // Adjust each PO total proportionally
                purchaseOrdersData.forEach(po => {
                    po.total = Math.round(po.total * adjustmentFactor);
                    if (po.savings) {
                        po.savings = Math.round(po.savings * adjustmentFactor * 0.01); // Maintain reasonable savings percentage
                    }
                });
                
                totalSpend = purchaseOrdersData.reduce((sum, po) => sum + po.total, 0);
                console.log('Adjusted total spend:', totalSpend.toLocaleString());
            }
            
            return totalSpend;
        }
        
        // Apply spend validation
        const actualTotalSpend = validateAndAdjustPOSpend();

        // Initialize currentPOData with all purchase orders IMMEDIATELY
        let currentPOData = [...purchaseOrdersData];
        let currentPOFilter = 'all';
        let currentPage = 1;
        let pageSize = 50; // Default to 50 POs per page

        console.log('PO Data initialized immediately with', currentPOData.length, 'orders');

        // Comprehensive PO filtering function with subtotals update
        function applyAllPOFilters() {
            let filteredData = [...purchaseOrdersData];
            
            // Apply open/closed filter (defaults to open)
            const openClosedFilter = document.getElementById('po-open-closed-filter')?.value || 'open';
            if (openClosedFilter === 'open') {
                // Open POs: draft, pending-approval, approved, in-fulfillment, shipped
                filteredData = filteredData.filter(po => 
                    ['draft', 'pending-approval', 'approved', 'in-fulfillment', 'shipped'].includes(po.status)
                );
            } else if (openClosedFilter === 'closed') {
                // Closed POs: delivered, completed
                filteredData = filteredData.filter(po => 
                    ['delivered', 'completed'].includes(po.status)
                );
            }
            // 'all' shows everything, no additional filtering
            
            // Apply status filter
            const statusFilter = document.getElementById('po-status-filter')?.value;
            if (statusFilter) {
                filteredData = filteredData.filter(po => po.status === statusFilter);
            }
            
            // Apply supplier filter
            const supplierFilter = document.getElementById('po-supplier-filter')?.value;
            if (supplierFilter) {
                filteredData = filteredData.filter(po => po.vendor === supplierFilter);
            }
            
            // Apply priority filter
            const priorityFilter = document.getElementById('po-priority-filter')?.value;
            if (priorityFilter) {
                filteredData = filteredData.filter(po => po.priority === priorityFilter);
            }
            
            // Apply search filter
            const searchTerm = document.getElementById('po-search')?.value.toLowerCase();
            if (searchTerm) {
                filteredData = filteredData.filter(po => 
                    po.id.toLowerCase().includes(searchTerm) ||
                    po.vendor.toLowerCase().includes(searchTerm) ||
                    po.items.toLowerCase().includes(searchTerm) ||
                    po.buyer.toLowerCase().includes(searchTerm) ||
                    (po.partNumber && po.partNumber.toLowerCase().includes(searchTerm)) ||
                    (po.partDescription && po.partDescription.toLowerCase().includes(searchTerm))
                );
            }
            
            currentPOData = filteredData;
            currentPage = 1; // Reset to first page
            
            // Update live subtotals
            updatePOSubtotals(filteredData);
            
            renderPOTable();
            updatePagination();
            
            // Update count display
            const countDisplay = document.getElementById('po-count-display');
            if (countDisplay) {
                countDisplay.textContent = `${filteredData.length}`;
            }
        }

        // Update live subtotals based on filtered data
        function updatePOSubtotals(filteredData) {
            const totalCount = filteredData.length;
            const totalValue = filteredData.reduce((sum, po) => sum + po.total, 0);
            const avgValue = totalCount > 0 ? totalValue / totalCount : 0;
            const totalSavings = filteredData.reduce((sum, po) => sum + (po.savings || 0), 0);
            
            // Update display elements
            const totalPOCountEl = document.getElementById('total-po-count');
            const totalPOValueEl = document.getElementById('total-po-value');
            const avgPOValueEl = document.getElementById('avg-po-value');
            const totalSavingsEl = document.getElementById('total-savings-display');
            
            if (totalPOCountEl) totalPOCountEl.textContent = totalCount.toLocaleString();
            if (totalPOValueEl) {
                if (totalValue >= 1000000) {
                    totalPOValueEl.textContent = `$${(totalValue / 1000000).toFixed(1)}M`;
                } else if (totalValue >= 1000) {
                    totalPOValueEl.textContent = `$${(totalValue / 1000).toFixed(0)}K`;
                } else {
                    totalPOValueEl.textContent = `$${totalValue.toLocaleString()}`;
                }
            }
            if (avgPOValueEl) avgPOValueEl.textContent = `$${Math.round(avgValue).toLocaleString()}`;
            if (totalSavingsEl) totalSavingsEl.textContent = `$${totalSavings.toLocaleString()}`;
        }

        function renderPOTable() {
            const tableBody = document.getElementById('po-table-body');
            if (!tableBody) {
                console.error('PO table body not found!');
                return;
            }
            
            console.log('Rendering PO table with', currentPOData.length, 'total POs');
            
            const startIndex = (currentPage - 1) * pageSize;
            const endIndex = Math.min(startIndex + pageSize, currentPOData.length);
            const pageData = currentPOData.slice(startIndex, endIndex);
            
            console.log('Page data:', pageData.length, 'POs (from index', startIndex, 'to', endIndex, ')');
            
            tableBody.innerHTML = '';
            
            if (pageData.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="10" class="px-6 py-8 text-center text-gray-500">No purchase orders found. Check console for debugging info.</td></tr>';
                return;
            }
            
            pageData.forEach(po => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50 cursor-pointer';
                row.onclick = () => openPOProfile(po);
                
                // Generate flags
                let flagsHtml = '';
                po.flags.forEach(flag => {
                    const flagStyles = {
                        'urgent': 'bg-red-100 text-red-800',
                        'budget-review': 'bg-yellow-100 text-yellow-800',
                        'rush-order': 'bg-purple-100 text-purple-800',
                        'price-change': 'bg-orange-100 text-orange-800',
                        'completed': 'bg-green-100 text-green-800'
                    };
                    flagsHtml += `<span class="inline-block w-3 h-3 rounded-full ${flagStyles[flag] || 'bg-gray-100'} mr-1"></span>`;
                });
                
                // Status styling
                const statusStyles = {
                    'pending-approval': 'bg-yellow-100 text-yellow-800',
                    'in-fulfillment': 'bg-blue-100 text-blue-800',
                    'shipped': 'bg-purple-100 text-purple-800',
                    'delivered': 'bg-green-100 text-green-800',
                    'completed': 'bg-gray-100 text-gray-800'
                };
                
                // ERP Sync status and overdue analysis
                const erpSyncStyles = {
                    'synced': 'bg-green-100 text-green-800',
                    'pending': 'bg-yellow-100 text-yellow-800',
                    'error': 'bg-red-100 text-red-800'
                };

                // Determine specific overdue reasons
                function getOverdueReason(po) {
                    const today = new Date();
                    const dueDate = new Date(po.dueDate);
                    const createdDate = new Date(po.createdDate);
                    const daysSinceDue = Math.floor((today - dueDate) / (1000 * 60 * 60 * 24));
                    const daysSinceCreated = Math.floor((today - createdDate) / (1000 * 60 * 60 * 24));
                    
                    if (dueDate > today) {
                        return null; // Not overdue
                    }
                    
                    // Specific overdue scenarios based on status and timing
                    switch (po.status) {
                        case 'pending-approval':
                            if (daysSinceCreated > 5) {
                                return `Approval overdue by ${daysSinceDue} days`;
                            }
                            return `Pending approval (${daysSinceCreated} days)`;
                        
                        case 'approved':
                            return `Supplier acknowledgment overdue by ${daysSinceDue} days`;
                        
                        case 'in-fulfillment':
                            return `Delivery overdue by ${daysSinceDue} days`;
                        
                        case 'shipped':
                            return `Expected delivery overdue by ${daysSinceDue} days`;
                        
                        default:
                            return `PO overdue by ${daysSinceDue} days`;
                    }
                }
                
                const overdueReason = getOverdueReason(po);
                
                row.innerHTML = `
                    <td class="px-3 py-4">
                        <input type="checkbox" class="po-checkbox rounded border-gray-300" data-po-id="${po.id}">
                    </td>
                    <td class="px-6 py-4">
                        <div class="flex items-center space-x-1">
                            ${flagsHtml}
                            ${po.hasMessages ? '<span class="text-blue-500 text-sm">💬</span>' : ''}
                            ${po.hasUpdates ? '<span class="text-green-500 text-sm">🔄</span>' : ''}
                        </div>
                    </td>
                    <td class="px-6 py-4">
                        <div class="text-sm font-medium text-blue-600 hover:text-blue-800">${po.id}</div>
                        <div class="text-xs text-gray-500">${po.lineCount} line${po.lineCount > 1 ? 's' : ''}</div>
                    </td>
                    <td class="px-6 py-4">
                        <div class="text-sm font-medium text-gray-900">${po.vendor}</div>
                        <div class="text-xs text-gray-500">${po.vendorCode}</div>
                    </td>
                    <td class="px-6 py-4">
                        <div class="text-sm font-medium text-gray-900">${po.partNumber || 'N/A'}</div>
                        <div class="text-xs text-gray-500">${po.partDescription || ''}</div>
                    </td>
                    <td class="px-6 py-4">
                        <div class="text-sm font-medium text-gray-900">$${po.total.toLocaleString()}</div>
                        ${po.savings ? `<div class="text-xs text-green-600">$${po.savings} saved</div>` : ''}
                    </td>
                    <td class="px-6 py-4">
                        <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full ${statusStyles[po.status]}">
                            ${po.status.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase())}
                        </span>
                    </td>
                    <td class="px-6 py-4">
                        <div class="text-sm text-gray-900">${new Date(po.dueDate).toLocaleDateString()}</div>
                        ${overdueReason ? `<div class="text-xs text-red-600 font-medium">${overdueReason}</div>` : ''}
                    </td>
                    <td class="px-6 py-4">
                        <div class="flex flex-col space-y-1">
                            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full ${erpSyncStyles[po.erpSync]}">
                                ${po.erpSync}
                            </span>
                            ${overdueReason ? `<div class="text-xs text-red-600 max-w-24 leading-tight">${overdueReason.includes('Approval') ? 'Internal delay' : overdueReason.includes('acknowledgment') ? 'Supplier delay' : overdueReason.includes('Delivery') ? 'Supplier delay' : 'Process delay'}</div>` : ''}
                        </div>
                    </td>
                    <td class="px-6 py-4">
                        <button onclick="openPOProfile(event, '${po.id}')" class="text-blue-600 hover:text-blue-800 text-sm font-medium">
                            View
                        </button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
            
            updatePagination();
        }

        // Pagination Functions
        function updatePagination() {
            const totalPOs = currentPOData.length;
            const totalPages = pageSize === 'all' ? 1 : Math.ceil(totalPOs / pageSize);
            
            // Update pagination info
            const paginationStart = document.getElementById('pagination-start');
            const paginationEnd = document.getElementById('pagination-end');
            const paginationTotal = document.getElementById('pagination-total');
            
            if (pageSize === 'all') {
                if (paginationStart) paginationStart.textContent = '1';
                if (paginationEnd) paginationEnd.textContent = totalPOs.toString();
            } else {
                const startIndex = (currentPage - 1) * pageSize + 1;
                const endIndex = Math.min(currentPage * pageSize, totalPOs);
                if (paginationStart) paginationStart.textContent = startIndex.toString();
                if (paginationEnd) paginationEnd.textContent = endIndex.toString();
            }
            if (paginationTotal) paginationTotal.textContent = totalPOs.toString();
            
            // Update page numbers
            updatePageNumbers(totalPages);
            
            // Update button states
            const prevButton = document.getElementById('prev-page');
            const nextButton = document.getElementById('next-page');
            
            if (prevButton) {
                prevButton.disabled = currentPage <= 1;
                prevButton.className = currentPage <= 1 
                    ? 'px-3 py-2 text-sm font-medium text-gray-300 bg-gray-100 border border-gray-300 rounded-md cursor-not-allowed'
                    : 'px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50';
            }
            
            if (nextButton) {
                nextButton.disabled = currentPage >= totalPages;
                nextButton.className = currentPage >= totalPages
                    ? 'px-3 py-2 text-sm font-medium text-gray-300 bg-gray-100 border border-gray-300 rounded-md cursor-not-allowed'
                    : 'px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50';
            }
        }
        
        function updatePageNumbers(totalPages) {
            const pageNumbersContainer = document.getElementById('page-numbers');
            if (!pageNumbersContainer || pageSize === 'all') return;
            
            pageNumbersContainer.innerHTML = '';
            
            // Show page numbers (max 5 visible)
            const maxVisible = 5;
            let startPage = Math.max(1, currentPage - Math.floor(maxVisible / 2));
            let endPage = Math.min(totalPages, startPage + maxVisible - 1);
            
            // Adjust if we're near the end
            if (endPage - startPage < maxVisible - 1) {
                startPage = Math.max(1, endPage - maxVisible + 1);
            }
            
            for (let i = startPage; i <= endPage; i++) {
                const pageButton = document.createElement('button');
                pageButton.textContent = i.toString();
                pageButton.onclick = () => goToPage(i);
                pageButton.className = i === currentPage
                    ? 'px-3 py-2 text-sm font-medium text-white bg-blue-600 border border-blue-600 rounded-md'
                    : 'px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50';
                
                pageNumbersContainer.appendChild(pageButton);
            }
        }
        
        function previousPage() {
            if (currentPage > 1) {
                currentPage--;
                renderPOTable();
                updatePagination();
            }
        }
        
        function nextPage() {
            const totalPages = pageSize === 'all' ? 1 : Math.ceil(currentPOData.length / pageSize);
            if (currentPage < totalPages) {
                currentPage++;
                renderPOTable();
                updatePagination();
            }
        }
        
        function goToPage(page) {
            currentPage = page;
            renderPOTable();
            updatePagination();
        }
        
        function changePageSize() {
            const newPageSize = document.getElementById('page-size-selector').value;
            pageSize = newPageSize === 'all' ? 'all' : parseInt(newPageSize);
            currentPage = 1; // Reset to first page
            renderPOTable();
            updatePagination();
        }

        function openPOProfile(event, poId) {
            if (event && event.stopPropagation) event.stopPropagation();
            
            const po = purchaseOrdersData.find(p => p.id === (poId || (event && event.id)));
            if (!po) return;
            
            // Update modal title and subtitle
            document.getElementById('po-modal-title').textContent = `Purchase Order ${po.id}`;
            document.getElementById('po-modal-subtitle').textContent = `${po.vendor} • ${po.status.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase())}`;
            
            // Generate detailed PO profile content
            const modalContent = document.getElementById('po-modal-content');
            modalContent.innerHTML = generatePOProfileContent(po);
            
            // Show modal
            document.getElementById('po-profile-modal').classList.remove('hidden');
            
            showToast(`Opened ${po.id} profile 📋`, 'info');
        }

        function closePOModal() {
            document.getElementById('po-profile-modal').classList.add('hidden');
        }

        function generatePOProfileContent(po) {
            const statusStyles = {
                'pending-approval': 'bg-yellow-100 text-yellow-800',
                'in-fulfillment': 'bg-blue-100 text-blue-800',
                'shipped': 'bg-purple-100 text-purple-800',
                'delivered': 'bg-green-100 text-green-800',
                'completed': 'bg-gray-100 text-gray-800'
            };

            const priorityStyles = {
                'urgent': 'bg-red-100 text-red-800',
                'high': 'bg-orange-100 text-orange-800',
                'standard': 'bg-blue-100 text-blue-800',
                'low': 'bg-gray-100 text-gray-800'
            };

            return `
                <div class="space-y-6">
                    <!-- Header Information -->
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div class="lg:col-span-2">
                            <div class="bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6">
                                <div class="flex items-center justify-between mb-4">
                                    <h4 class="text-lg font-semibold text-blue-900">Purchase Order Overview</h4>
                                    <div class="flex space-x-2">
                                        <span class="inline-flex px-3 py-1 text-sm font-semibold rounded-full ${statusStyles[po.status]}">
                                            ${po.status.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase())}
                                        </span>
                                        <span class="inline-flex px-3 py-1 text-sm font-semibold rounded-full ${priorityStyles[po.priority]}">
                                            ${po.priority.toUpperCase()}
                                        </span>
                                    </div>
                                </div>
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <p class="text-sm text-blue-700">Vendor</p>
                                        <p class="font-medium text-blue-900">${po.vendor}</p>
                                        <p class="text-xs text-blue-600">${po.vendorCode}</p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-blue-700">Total Value</p>
                                        <p class="font-medium text-blue-900">$${po.total.toLocaleString()}</p>
                                        ${po.savings ? `<p class="text-xs text-green-600">$${po.savings.toLocaleString()} saved</p>` : ''}
                                    </div>
                                    <div>
                                        <p class="text-sm text-blue-700">Buyer</p>
                                        <p class="font-medium text-blue-900">${po.buyer}</p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-blue-700">Category</p>
                                        <p class="font-medium text-blue-900">${po.category}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <div class="bg-white border border-gray-200 rounded-xl p-6">
                                <h4 class="text-lg font-semibold text-gray-900 mb-4">Key Dates</h4>
                                <div class="space-y-3">
                                    <div>
                                        <p class="text-sm text-gray-600">Created</p>
                                        <p class="font-medium text-gray-900">${new Date(po.createdDate).toLocaleDateString()}</p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-600">Due Date</p>
                                        <p class="font-medium text-gray-900">${new Date(po.dueDate).toLocaleDateString()}</p>
                                        ${po.isLate || new Date(po.dueDate) < new Date() ? '<p class="text-xs text-red-600">Overdue</p>' : ''}
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-600">ERP Sync</p>
                                        <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full ${po.erpSync === 'synced' ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'}">
                                            ${po.erpSync}
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Items and Line Details -->
                    <div class="bg-white border border-gray-200 rounded-xl p-6">
                        <h4 class="text-lg font-semibold text-gray-900 mb-4">Order Details</h4>
                        <div class="bg-gray-50 rounded-lg p-4">
                            <p class="text-sm text-gray-600">Items</p>
                            <p class="font-medium text-gray-900">${po.items}</p>
                            <p class="text-xs text-gray-500 mt-1">${po.lineCount} line item${po.lineCount > 1 ? 's' : ''}</p>
                        </div>
                    </div>

                    <!-- Messages and Communications -->
                    ${po.hasMessages && po.messages.length > 0 ? `
                    <div class="bg-white border border-gray-200 rounded-xl p-6">
                        <h4 class="text-lg font-semibold text-gray-900 mb-4">Recent Messages</h4>
                        <div class="space-y-3">
                            ${po.messages.map(message => `
                                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                    <div class="flex items-center justify-between mb-2">
                                        <p class="font-medium text-blue-900">${message.from}</p>
                                        <p class="text-xs text-blue-600">${message.timestamp}</p>
                                    </div>
                                    <p class="text-sm text-blue-800">${message.content}</p>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    ` : ''}

                    <!-- Action Buttons -->
                    <div class="flex flex-wrap gap-3 pt-4 border-t border-gray-200">
                        <button onclick="openChangeRequestForm('${po.id}')" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 font-medium transition-colors">
                            🔄 Request Change
                        </button>
                        <button onclick="messageSupplier('${po.id}')" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 font-medium transition-colors">
                            💬 Message Supplier
                        </button>
                        <button onclick="trackShipment('${po.id}')" class="bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 font-medium transition-colors">
                            📦 Track Shipment
                        </button>
                        <button onclick="exportPODetails('${po.id}')" class="bg-gray-600 text-white px-6 py-2 rounded-lg hover:bg-gray-700 font-medium transition-colors">
                            📊 Export Details
                        </button>
                    </div>
                </div>
            `;
        }

        function updatePagination() {
            const totalPages = Math.ceil(currentPOData.length / pageSize);
            const startItem = ((currentPage - 1) * pageSize) + 1;
            const endItem = Math.min(currentPage * pageSize, currentPOData.length);
            
            // Update pagination info (if elements exist)
            const showingStart = document.getElementById('showing-start');
            const showingEnd = document.getElementById('showing-end');
            const totalPOs = document.getElementById('total-pos');
            const prevBtn = document.getElementById('prev-page');
            const nextBtn = document.getElementById('next-page');
            
            if (showingStart) showingStart.textContent = startItem;
            if (showingEnd) showingEnd.textContent = endItem;
            if (totalPOs) totalPOs.textContent = currentPOData.length;
            
            if (prevBtn) prevBtn.disabled = currentPage <= 1;
            if (nextBtn) nextBtn.disabled = currentPage >= totalPages;
            
            // Update main count display
            const countDisplay = document.getElementById('po-count-display');
            if (countDisplay) {
                countDisplay.textContent = `${currentPOData.length}`;
            }
        }

        function resetAllPOFilters() {
            // Reset all filter dropdowns
            document.getElementById('po-open-closed-filter').value = 'open'; // Default to open
            document.getElementById('po-status-filter').value = '';
            document.getElementById('po-supplier-filter').value = '';
            document.getElementById('po-priority-filter').value = '';
            document.getElementById('po-search').value = '';
            
            // Reset to show open POs by default
            currentPage = 1;
            applyAllPOFilters(); // This will apply the open filter and update subtotals
            
            showToast('Filters reset to show Open POs', 'success');
        }

        // Change Request Functions
        function openChangeRequestForm(poId) {
            const po = purchaseOrdersData.find(p => p.id === poId);
            if (!po) return;

            document.getElementById('change-request-subtitle').textContent = `For ${po.id} - ${po.vendor}`;
            
            const changeRequestContent = document.getElementById('change-request-content');
            changeRequestContent.innerHTML = generateChangeRequestForm(po);
            
            document.getElementById('change-request-modal').classList.remove('hidden');
            showToast('Opening change request form...', 'info');
        }

        function generateChangeRequestForm(po) {
            return `
                <div class="space-y-6">
                    <!-- PO Summary -->
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h4 class="font-medium text-gray-900 mb-2">Purchase Order Summary</h4>
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div>
                                <p class="text-gray-600">PO Number:</p>
                                <p class="font-medium">${po.id}</p>
                            </div>
                            <div>
                                <p class="text-gray-600">Current Total:</p>
                                <p class="font-medium">$${po.total.toLocaleString()}</p>
                            </div>
                            <div>
                                <p class="text-gray-600">Due Date:</p>
                                <p class="font-medium">${new Date(po.dueDate).toLocaleDateString()}</p>
                            </div>
                            <div>
                                <p class="text-gray-600">Status:</p>
                                <p class="font-medium">${po.status.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase())}</p>
                            </div>
                        </div>
                    </div>

                    <!-- Change Request Form -->
                    <form onsubmit="submitChangeRequest(event, '${po.id}')" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Type of Change Request</label>
                            <select id="change-type" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500" required>
                                <option value="">Select change type...</option>
                                <option value="delivery-date">Delivery Date Change</option>
                                <option value="quantity">Quantity Adjustment</option>
                                <option value="price">Price Negotiation</option>
                                <option value="specifications">Specification Change</option>
                                <option value="shipping">Shipping Method Change</option>
                                <option value="split-delivery">Split Delivery</option>
                                <option value="cancellation">Partial/Full Cancellation</option>
                                <option value="other">Other</option>
                            </select>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Priority Level</label>
                            <select id="change-priority" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500" required>
                                <option value="standard">Standard (5-7 business days)</option>
                                <option value="urgent">Urgent (1-2 business days)</option>
                                <option value="emergency">Emergency (Same day)</option>
                            </select>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Requested Changes</label>
                            <textarea id="change-details" rows="4" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500" placeholder="Please provide detailed information about the requested changes..." required></textarea>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Business Justification</label>
                            <textarea id="change-justification" rows="3" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500" placeholder="Why is this change necessary? Include impact on timeline, budget, or operations..." required></textarea>
                        </div>

                        <div class="flex items-center space-x-2">
                            <input type="checkbox" id="ai-optimization" class="rounded border-gray-300">
                            <label for="ai-optimization" class="text-sm text-gray-700">Use AI to optimize this request and suggest alternatives</label>
                        </div>

                        <div class="flex space-x-3 pt-4">
                            <button type="submit" class="flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 font-medium transition-colors">
                                Submit Request
                            </button>
                            <button type="button" onclick="closeChangeRequestModal()" class="flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 font-medium transition-colors">
                                Cancel
                            </button>
                        </div>
                    </form>
                </div>
            `;
        }

        function closeChangeRequestModal() {
            document.getElementById('change-request-modal').classList.add('hidden');
        }

        function submitChangeRequest(event, poId) {
            event.preventDefault();
            
            const changeType = document.getElementById('change-type').value;
            const priority = document.getElementById('change-priority').value;
            const useAI = document.getElementById('ai-optimization').checked;
            
            // Simulate submission
            closeChangeRequestModal();
            showToast(`✅ Change request submitted for ${poId}. ${useAI ? 'AI optimization enabled.' : ''} Supplier will respond within ${priority === 'emergency' ? '24 hours' : priority === 'urgent' ? '2 business days' : '5-7 business days'}.`, 'success');
            
            // Update the PO data to reflect the pending change
            const po = purchaseOrdersData.find(p => p.id === poId);
            if (po) {
                po.hasUpdates = true;
                po.messages.unshift({
                    from: 'Your Company',
                    content: `Change request submitted: ${changeType.replace('-', ' ')}`,
                    timestamp: 'Just now'
                });
            }
        }

        // Additional PO action functions
        function messageSupplier(poId) {
            showToast(`💬 Opening supplier chat for ${poId}...`, 'info');
        }

        function trackShipment(poId) {
            showToast(`📦 Opening shipment tracking for ${poId}...`, 'info');
        }

        function exportPODetails(poId) {
            showToast(`📊 Exporting detailed report for ${poId}...`, 'info');
        }

        // Toggle both Sync'd Impact and Quick Actions sections together
        function toggleSyncdImpact() {
            toggleBothSections('syncd');
        }

        // Toggle both Quick Actions and Sync'd Impact sections together
        function toggleQuickActions() {
            toggleBothSections('quick');
        }

        // Unified function to toggle both sections simultaneously
        function toggleBothSections(triggerSource) {
            const syncdContent = document.getElementById('syncd-impact-content');
            const syncdChevron = document.getElementById('syncd-impact-chevron');
            const quickContent = document.getElementById('quick-actions-content');
            const quickChevron = document.getElementById('quick-actions-chevron');
            
            // Check if either section is currently hidden to determine the action
            const shouldExpand = syncdContent.classList.contains('hidden') || quickContent.classList.contains('hidden');
            
            if (shouldExpand) {
                // Expand both sections
                syncdContent.classList.remove('hidden');
                quickContent.classList.remove('hidden');
                syncdChevron.style.transform = 'rotate(180deg)';
                quickChevron.style.transform = 'rotate(180deg)';
                
                // Show appropriate toast based on which section was clicked
                if (triggerSource === 'syncd') {
                    showToast('Expanded Sync\'d Platform Impact & Quick Actions ✨⚡', 'info');
                } else {
                    showToast('Expanded Quick Actions & Sync\'d Platform Impact ⚡✨', 'info');
                }
            } else {
                // Collapse both sections
                syncdContent.classList.add('hidden');
                quickContent.classList.add('hidden');
                syncdChevron.style.transform = 'rotate(0deg)';
                quickChevron.style.transform = 'rotate(0deg)';
                showToast('Collapsed both sections', 'info');
            }
        }

        // Initialize the table on page load
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded - PO data length:', purchaseOrdersData.length);
            
            // Set open filter as default and apply all filters
            const openClosedFilter = document.getElementById('po-open-closed-filter');
            if (openClosedFilter) {
                openClosedFilter.value = 'open';
            }
            
            // Apply filters (which will set currentPOData to open POs and update subtotals)
            applyAllPOFilters();
            
            // Also try suppliers table if it exists
            if (typeof renderSuppliersTable === 'function') {
                renderSuppliersTable();
            }
            
            // Double-check with a small delay in case of timing issues
            setTimeout(() => {
                console.log('Final check - Current PO data length:', currentPOData.length);
                // Ensure filters are applied correctly
                applyAllPOFilters();
            }, 200);
        });

        function filterSuppliers() {
            const statusFilter = document.getElementById('supplier-status-filter').value;
            const riskFilter = document.getElementById('supplier-risk-filter').value;

            filteredSuppliers = suppliersData.filter(supplier => {
                const statusMatch = !statusFilter || supplier.status === statusFilter;
                const riskMatch = !riskFilter || supplier.riskStatus === riskFilter;
                return statusMatch && riskMatch;
            });

            currentSupplierPage = 1; // Reset to first page
            renderSuppliersTable();
            
            // Show filter status
            const filterStatus = [];
            if (statusFilter) filterStatus.push(`Status: ${statusFilter}`);
            if (riskFilter) filterStatus.push(`Risk: ${riskFilter}`);
            
            if (filterStatus.length > 0) {
                showToast(`Filtered suppliers by ${filterStatus.join(', ')} - ${filteredSuppliers.length} results`, 'info');
            }
        }

        function resetSupplierFilters() {
            document.getElementById('supplier-status-filter').value = '';
            document.getElementById('supplier-risk-filter').value = '';
            filteredSuppliers = [...suppliersData];
            currentSupplierPage = 1; // Reset to first page
            renderSuppliersTable();
            showToast('Supplier filters reset - showing all suppliers', 'success');
        }

        function showSupplierProfile(supplier) {
            const modal = document.getElementById('supplier-profile-modal');
            const title = document.getElementById('supplier-profile-title');
            const content = document.getElementById('supplier-profile-content');
            
            title.textContent = `${supplier.name} - Supplier Profile`;
            
            // Generate detailed profile content
            const profileContent = generateSupplierProfileContent(supplier);
            content.innerHTML = profileContent;
            
            modal.classList.remove('hidden');
            showToast(`Opening ${supplier.name} profile... 📊`, 'info');
        }

        function generateSupplierProfileContent(supplier) {
            // Generate purchase orders for this supplier
            const poCount = Math.floor(Math.random() * 15) + 5; // 5-20 POs
            const avgPOValue = supplier.spend / poCount;
            
            // Generate risk details based on risk status
            let riskDetails = '';
            switch (supplier.riskStatus) {
                case 'High':
                    riskDetails = `
                        <div class="space-y-3">
                            <div class="p-3 bg-red-50 border border-red-200 rounded-lg">
                                <p class="text-sm font-medium text-red-800">Financial Instability</p>
                                <p class="text-xs text-red-600">Credit rating decreased from A- to B+ in last quarter</p>
                            </div>
                            <div class="p-3 bg-red-50 border border-red-200 rounded-lg">
                                <p class="text-sm font-medium text-red-800">Geographic Risk</p>
                                <p class="text-xs text-red-600">Located in region with current political instability</p>
                            </div>
                            <div class="p-3 bg-red-50 border border-red-200 rounded-lg">
                                <p class="text-sm font-medium text-red-800">Performance Issues</p>
                                <p class="text-xs text-red-600">3 late deliveries in past 6 months, quality complaints increasing</p>
                            </div>
                        </div>
                    `;
                    break;
                case 'Medium':
                    riskDetails = `
                        <div class="space-y-3">
                            <div class="p-3 bg-yellow-50 border border-yellow-200 rounded-lg">
                                <p class="text-sm font-medium text-yellow-800">Market Volatility</p>
                                <p class="text-xs text-yellow-600">Commodity prices affecting cost stability</p>
                            </div>
                            <div class="p-3 bg-yellow-50 border border-yellow-200 rounded-lg">
                                <p class="text-sm font-medium text-yellow-800">Single Source Dependency</p>
                                <p class="text-xs text-yellow-600">Primary supplier for critical components - limited alternatives</p>
                            </div>
                        </div>
                    `;
                    break;
                default: // Low
                    riskDetails = `
                        <div class="space-y-3">
                            <div class="p-3 bg-green-50 border border-green-200 rounded-lg">
                                <p class="text-sm font-medium text-green-800">Stable Performance</p>
                                <p class="text-xs text-green-600">Consistent delivery and quality over 18+ months</p>
                            </div>
                            <div class="p-3 bg-green-50 border border-green-200 rounded-lg">
                                <p class="text-sm font-medium text-green-800">Financial Health</p>
                                <p class="text-xs text-green-600">Strong credit rating (A+) and growing revenue</p>
                            </div>
                        </div>
                    `;
            }

            return `
                <div class="space-y-6">
                    <!-- Header Info -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="bg-white border border-gray-200 rounded-lg p-4">
                            <div class="flex items-center mb-3">
                                <div class="w-12 h-12 bg-${supplier.color}-100 rounded-lg flex items-center justify-center">
                                    <span class="text-${supplier.color}-600 font-medium text-lg">${supplier.initials}</span>
                                </div>
                                <div class="ml-3">
                                    <h3 class="text-lg font-medium text-gray-900">${supplier.name}</h3>
                                    <p class="text-sm text-gray-500">ID: ${supplier.id}</p>
                                </div>
                            </div>
                            <div class="space-y-2 text-sm">
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Category:</span>
                                    <span class="font-medium">${supplier.category}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Location:</span>
                                    <span class="font-medium">${supplier.location}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Status:</span>
                                    <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full ${
                                        supplier.status === 'Active' ? 'bg-green-100 text-green-800' :
                                        supplier.status === 'Under Review' ? 'bg-yellow-100 text-yellow-800' :
                                        supplier.status === 'Suspended' ? 'bg-red-100 text-red-800' :
                                        'bg-gray-100 text-gray-800'
                                    }">${supplier.status}</span>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white border border-gray-200 rounded-lg p-4">
                            <h4 class="text-md font-medium text-gray-900 mb-3">Performance Metrics</h4>
                            <div class="space-y-3">
                                <div>
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="text-sm text-gray-600">Rating</span>
                                        <span class="text-sm font-medium">${supplier.rating}/5.0</span>
                                    </div>
                                    <div class="flex items-center">
                                        <span class="text-yellow-400">${'★'.repeat(Math.floor(supplier.rating))}${'☆'.repeat(5 - Math.floor(supplier.rating))}</span>
                                    </div>
                                </div>
                                <div>
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="text-sm text-gray-600">On-Time Delivery</span>
                                        <span class="text-sm font-medium">${Math.round(85 + Math.random() * 10)}%</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                        <div class="bg-green-500 h-2 rounded-full" style="width: ${Math.round(85 + Math.random() * 10)}%"></div>
                                    </div>
                                </div>
                                <div>
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="text-sm text-gray-600">Quality Score</span>
                                        <span class="text-sm font-medium">${Math.round(90 + Math.random() * 8)}%</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                        <div class="bg-blue-500 h-2 rounded-full" style="width: ${Math.round(90 + Math.random() * 8)}%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white border border-gray-200 rounded-lg p-4">
                            <h4 class="text-md font-medium text-gray-900 mb-3">Financial Overview</h4>
                            <div class="space-y-3">
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600">YTD Spend:</span>
                                    <span class="text-lg font-bold text-gray-900">${supplier.spendDisplay}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600">Purchase Orders:</span>
                                    <span class="font-medium">${poCount} orders</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600">Avg PO Value:</span>
                                    <span class="font-medium">$${Math.round(avgPOValue).toLocaleString()}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600">Payment Terms:</span>
                                    <span class="font-medium">Net 30</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Risk Assessment -->
                    <div class="bg-white border border-gray-200 rounded-lg p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h4 class="text-lg font-medium text-gray-900">Risk Assessment</h4>
                            <span class="inline-flex px-3 py-1 text-sm font-semibold rounded-full ${
                                supplier.riskStatus === 'Low' ? 'bg-green-100 text-green-800' :
                                supplier.riskStatus === 'Medium' ? 'bg-yellow-100 text-yellow-800' :
                                'bg-red-100 text-red-800'
                            }">${supplier.riskStatus} Risk</span>
                        </div>
                        ${riskDetails}
                    </div>

                    <!-- Recent Purchase Orders -->
                    <div class="bg-white border border-gray-200 rounded-lg p-6">
                        <h4 class="text-lg font-medium text-gray-900 mb-4">Recent Purchase Orders</h4>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase">PO Number</th>
                                        <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase">Date</th>
                                        <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase">Amount</th>
                                        <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase">Status</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-gray-200">
                                    ${Array.from({length: Math.min(5, poCount)}, (_, i) => {
                                        const poNum = `PO-${new Date().getFullYear()}-${String(Math.floor(Math.random() * 999) + 100).padStart(3, '0')}`;
                                        const amount = Math.round(avgPOValue * (0.7 + Math.random() * 0.6));
                                        const statuses = ['Delivered', 'In Transit', 'Processing', 'Pending'];
                                        const status = statuses[Math.floor(Math.random() * statuses.length)];
                                        const date = new Date(Date.now() - Math.random() * 90 * 24 * 60 * 60 * 1000).toLocaleDateString();
                                        
                                        return `
                                            <tr>
                                                <td class="px-3 py-2 text-sm text-gray-900">${poNum}</td>
                                                <td class="px-3 py-2 text-sm text-gray-500">${date}</td>
                                                <td class="px-3 py-2 text-sm text-gray-900">$${amount.toLocaleString()}</td>
                                                <td class="px-3 py-2">
                                                    <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full ${
                                                        status === 'Delivered' ? 'bg-green-100 text-green-800' :
                                                        status === 'In Transit' ? 'bg-blue-100 text-blue-800' :
                                                        status === 'Processing' ? 'bg-yellow-100 text-yellow-800' :
                                                        'bg-gray-100 text-gray-800'
                                                    }">${status}</span>
                                                </td>
                                            </tr>
                                        `;
                                    }).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Contact Information -->
                    <div class="bg-white border border-gray-200 rounded-lg p-6">
                        <h4 class="text-lg font-medium text-gray-900 mb-4">Contact Information</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <h5 class="text-sm font-medium text-gray-700 mb-2">Primary Contact</h5>
                                <div class="space-y-1 text-sm">
                                    <p><span class="text-gray-600">Name:</span> John Smith</p>
                                    <p><span class="text-gray-600">Title:</span> Procurement Manager</p>
                                    <p><span class="text-gray-600">Email:</span> j.smith@${supplier.name.toLowerCase().replace(/\s+/g, '')}.com</p>
                                    <p><span class="text-gray-600">Phone:</span> +1 (555) ${Math.floor(Math.random() * 900) + 100}-${Math.floor(Math.random() * 9000) + 1000}</p>
                                </div>
                            </div>
                            <div>
                                <h5 class="text-sm font-medium text-gray-700 mb-2">Company Details</h5>
                                <div class="space-y-1 text-sm">
                                    <p><span class="text-gray-600">Founded:</span> ${2000 + Math.floor(Math.random() * 20)}</p>
                                    <p><span class="text-gray-600">Employees:</span> ${Math.floor(Math.random() * 5000) + 50}</p>
                                    <p><span class="text-gray-600">Certifications:</span> ISO 9001, ISO 14001</p>
                                    <p><span class="text-gray-600">Website:</span> www.${supplier.name.toLowerCase().replace(/\s+/g, '')}.com</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function sortSuppliers(column) {
            // Toggle sort direction
            if (currentSupplierSort.column === column) {
                currentSupplierSort.direction = currentSupplierSort.direction === 'asc' ? 'desc' : 'asc';
            } else {
                currentSupplierSort.column = column;
                currentSupplierSort.direction = 'asc';
            }

            // Sort the filtered suppliers
            filteredSuppliers.sort((a, b) => {
                let aValue, bValue;

                switch (column) {
                    case 'name':
                        aValue = a.name.toLowerCase();
                        bValue = b.name.toLowerCase();
                        break;
                    case 'category':
                        aValue = a.category.toLowerCase();
                        bValue = b.category.toLowerCase();
                        break;
                    case 'location':
                        aValue = a.location.toLowerCase();
                        bValue = b.location.toLowerCase();
                        break;
                    case 'rating':
                        aValue = a.rating;
                        bValue = b.rating;
                        break;
                    case 'spend':
                        aValue = a.spend;
                        bValue = b.spend;
                        break;
                    case 'risk':
                        // Custom order for risk levels
                        const riskOrder = { 'Low': 1, 'Medium': 2, 'High': 3 };
                        aValue = riskOrder[a.riskStatus] || 0;
                        bValue = riskOrder[b.riskStatus] || 0;
                        break;
                    case 'status':
                        // Custom order for status
                        const statusOrder = { 'Active': 1, 'Under Review': 2, 'Inactive': 3, 'Suspended': 4 };
                        aValue = statusOrder[a.status] || 0;
                        bValue = statusOrder[b.status] || 0;
                        break;
                    default:
                        return 0;
                }

                if (aValue < bValue) {
                    return currentSupplierSort.direction === 'asc' ? -1 : 1;
                }
                if (aValue > bValue) {
                    return currentSupplierSort.direction === 'asc' ? 1 : -1;
                }
                return 0;
            });

            renderSuppliersTable();
            updateSupplierSortIndicators();
            showToast(`Sorted by ${column} (${currentSupplierSort.direction === 'asc' ? 'ascending' : 'descending'})`, 'info');
        }

        function updateSupplierSortIndicators() {
            // Reset all indicators
            ['name', 'category', 'location', 'rating', 'spend', 'risk', 'status'].forEach(col => {
                const indicator = document.getElementById(`sort-${col}`);
                if (indicator) {
                    indicator.textContent = '↕';
                    indicator.className = 'ml-1 text-gray-400';
                }
            });

            // Set active indicator
            if (currentSupplierSort.column) {
                const activeIndicator = document.getElementById(`sort-${currentSupplierSort.column}`);
                if (activeIndicator) {
                    activeIndicator.textContent = currentSupplierSort.direction === 'asc' ? '↑' : '↓';
                    activeIndicator.className = 'ml-1 text-blue-600';
                }
            }
        }

        // Chart Initialization and Data
        let savingsChart = null;
        let projectsChart = null;
        let chartsInitialized = false;

        function initializeChartsIfNeeded() {
            // Check if Projects page is visible and charts need initialization
            const projectsPage = document.getElementById('projects-content');
            if (!projectsPage || !projectsPage.classList.contains('active')) {
                console.log('Projects page not active, skipping chart initialization');
                return;
            }
            
            // If charts are already working, no need to reinitialize
            if (chartsInitialized && savingsChart && projectsChart) {
                console.log('Charts already initialized and working');
                return;
            }
            
            const savingsCanvas = document.getElementById('savingsChart');
            const projectsCanvas = document.getElementById('projectsChart');
            
            if (!savingsCanvas || !projectsCanvas) {
                console.log('Project chart canvases not found, retrying in 200ms...');
                // Retry after a short delay to allow DOM to fully render
                setTimeout(() => {
                    const retryS = document.getElementById('savingsChart');
                    const retryP = document.getElementById('projectsChart');
                    if (retryS && retryP) {
                        console.log('Chart canvases found on retry, initializing...');
                        initializeChartsActual();
                    } else {
                        console.error('Chart canvases still not found after retry');
                    }
                }, 200);
                return;
            }
            
            initializeChartsActual();
        }
        
        function initializeChartsActual() {
            console.log('Starting chart initialization...');
            
            // Destroy existing charts if they exist to prevent conflicts
            if (savingsChart) {
                savingsChart.destroy();
                savingsChart = null;
            }
            if (projectsChart) {
                projectsChart.destroy();
                projectsChart = null;
            }
            
            // Reset initialization flag
            chartsInitialized = false;
            
            // Re-initialize charts
            initializeCharts();
        }

        function initializeCharts() {
            console.log('Initializing charts...');
            
            // Check if Chart.js is available
            if (typeof Chart === 'undefined') {
                console.error('Chart.js not loaded');
                return;
            }
            
            // Check if canvas elements exist
            const savingsCanvas = document.getElementById('savingsChart');
            const projectsCanvas = document.getElementById('projectsChart');
            
            if (!savingsCanvas || !projectsCanvas) {
                console.error('Project chart canvas elements not found');
                return;
            }
            
            // Savings Over Time Chart Data
            const savingsData = {
                labels: ['Jan 2023', 'Feb 2023', 'Mar 2023', 'Apr 2023', 'May 2023', 'Jun 2023', 
                        'Jul 2023', 'Aug 2023', 'Sep 2023', 'Oct 2023', 'Nov 2023', 'Dec 2023',
                        'Jan 2024', 'Feb 2024', 'Mar 2024', 'Apr 2024'],
                datasets: [{
                    label: 'Cumulative Savings ($M)',
                    data: [0, 0.42, 0.89, 1.67, 2.15, 2.85, 3.62, 4.18, 4.95, 5.73, 6.84, 7.62, 8.29, 8.95, 9.42, 9.8],
                    borderColor: '#10B981',
                    backgroundColor: 'rgba(16, 185, 129, 0.1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.4,
                    pointBackgroundColor: '#10B981',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5,
                    pointHoverRadius: 7
                }, {
                    label: 'Monthly Savings ($M)',
                    data: [0, 0.42, 0.47, 0.78, 0.48, 0.70, 0.77, 0.56, 0.77, 0.78, 1.11, 0.78, 0.67, 0.66, 0.47, 0.38],
                    borderColor: '#3B82F6',
                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                    borderWidth: 2,
                    fill: false,
                    tension: 0.4,
                    pointBackgroundColor: '#3B82F6',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 4,
                    pointHoverRadius: 6
                }]
            };

            // Projects Completed Over Time Chart Data
            const projectsData = {
                labels: ['Jan 2023', 'Feb 2023', 'Mar 2023', 'Apr 2023', 'May 2023', 'Jun 2023', 
                        'Jul 2023', 'Aug 2023', 'Sep 2023', 'Oct 2023', 'Nov 2023', 'Dec 2023',
                        'Jan 2024', 'Feb 2024', 'Mar 2024', 'Apr 2024'],
                datasets: [{
                    label: 'Cumulative Projects',
                    data: [0, 1, 2, 3, 4, 6, 8, 10, 12, 14, 16, 18, 19, 20, 22, 23],
                    borderColor: '#8B5CF6',
                    backgroundColor: 'rgba(139, 92, 246, 0.1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.4,
                    pointBackgroundColor: '#8B5CF6',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5,
                    pointHoverRadius: 7
                }, {
                    label: 'Projects Completed',
                    data: [0, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 1, 1, 2, 1],
                    borderColor: '#F59E0B',
                    backgroundColor: 'rgba(245, 158, 11, 0.1)',
                    borderWidth: 2,
                    fill: false,
                    tension: 0.4,
                    pointBackgroundColor: '#F59E0B',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 4,
                    pointHoverRadius: 6
                }]
            };

            // Chart Options
            const chartOptions = {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'top',
                        labels: {
                            usePointStyle: true,
                            padding: 20,
                            font: {
                                family: 'Inter',
                                size: 12
                            }
                        }
                    },
                    tooltip: {
                        backgroundColor: 'rgba(0, 0, 0, 0.8)',
                        titleColor: '#ffffff',
                        bodyColor: '#ffffff',
                        borderColor: '#374151',
                        borderWidth: 1,
                        cornerRadius: 8,
                        displayColors: true,
                        intersect: false,
                        mode: 'index'
                    }
                },
                scales: {
                    x: {
                        grid: {
                            display: false
                        },
                        ticks: {
                            font: {
                                family: 'Inter',
                                size: 11
                            },
                            color: '#6B7280'
                        }
                    },
                    y: {
                        beginAtZero: true,
                        grid: {
                            color: '#F3F4F6',
                            borderDash: [2, 2]
                        },
                        ticks: {
                            font: {
                                family: 'Inter',
                                size: 11
                            },
                            color: '#6B7280'
                        }
                    }
                },
                elements: {
                    point: {
                        hoverBorderWidth: 3
                    }
                },
                interaction: {
                    intersect: false,
                    mode: 'index'
                }
            };

            // Initialize Savings Chart
            const savingsCtx = document.getElementById('savingsChart');
            if (savingsCtx) {
                savingsChart = new Chart(savingsCtx, {
                    type: 'line',
                    data: savingsData,
                    options: {
                        ...chartOptions,
                        scales: {
                            ...chartOptions.scales,
                            y: {
                                ...chartOptions.scales.y,
                                ticks: {
                                    ...chartOptions.scales.y.ticks,
                                    callback: function(value) {
                                        return '$' + value + 'M';
                                    }
                                }
                            }
                        },
                        plugins: {
                            ...chartOptions.plugins,
                            tooltip: {
                                ...chartOptions.plugins.tooltip,
                                callbacks: {
                                    label: function(context) {
                                        return context.dataset.label + ': $' + context.parsed.y + 'M';
                                    }
                                }
                            }
                        }
                    }
                });
            }

            // Initialize Projects Chart
            const projectsCtx = document.getElementById('projectsChart');
            if (projectsCtx) {
                projectsChart = new Chart(projectsCtx, {
                    type: 'line',
                    data: projectsData,
                    options: {
                        ...chartOptions,
                        scales: {
                            ...chartOptions.scales,
                            y: {
                                ...chartOptions.scales.y,
                                ticks: {
                                    ...chartOptions.scales.y.ticks,
                                    stepSize: 1,
                                    callback: function(value) {
                                        return value;
                                    }
                                }
                            }
                        },
                        plugins: {
                            ...chartOptions.plugins,
                            tooltip: {
                                ...chartOptions.plugins.tooltip,
                                callbacks: {
                                    label: function(context) {
                                        return context.dataset.label + ': ' + context.parsed.y;
                                    }
                                }
                            }
                        }
                    }
                });
                
                // Mark charts as successfully initialized
                chartsInitialized = true;
                console.log('Charts successfully initialized!');
            }
        }

        // PO Data for dashboard filtering (Jan 2023 - Aug 2025)
        const poData = [
            { id: 'PO-001', amount: 85000, placedDate: '2023-01-15', status: 'Active' },
            { id: 'PO-002', amount: 125000, placedDate: '2023-02-20', status: 'Completed' },
            { id: 'PO-003', amount: 67000, placedDate: '2023-03-10', status: 'Active' },
            { id: 'PO-004', amount: 195000, placedDate: '2023-04-05', status: 'Completed' },
            { id: 'PO-005', amount: 88000, placedDate: '2023-05-12', status: 'Active' },
            { id: 'PO-006', amount: 142000, placedDate: '2023-06-18', status: 'Completed' },
            { id: 'PO-007', amount: 73000, placedDate: '2023-07-22', status: 'Active' },
            { id: 'PO-008', amount: 156000, placedDate: '2023-08-14', status: 'Completed' },
            { id: 'PO-009', amount: 92000, placedDate: '2023-09-08', status: 'Active' },
            { id: 'PO-010', amount: 218000, placedDate: '2023-10-16', status: 'Completed' },
            { id: 'PO-011', amount: 108000, placedDate: '2023-11-20', status: 'Active' },
            { id: 'PO-012', amount: 167000, placedDate: '2023-12-05', status: 'Completed' },
            { id: 'PO-013', amount: 134000, placedDate: '2024-01-18', status: 'Active' },
            { id: 'PO-014', amount: 201000, placedDate: '2024-02-25', status: 'Completed' },
            { id: 'PO-015', amount: 89000, placedDate: '2024-03-12', status: 'Active' },
            { id: 'PO-016', amount: 175000, placedDate: '2024-04-08', status: 'Completed' },
            { id: 'PO-017', amount: 96000, placedDate: '2024-05-15', status: 'Active' },
            { id: 'PO-018', amount: 187000, placedDate: '2024-06-22', status: 'Completed' },
            { id: 'PO-019', amount: 113000, placedDate: '2024-07-10', status: 'Active' },
            { id: 'PO-020', amount: 229000, placedDate: '2024-08-17', status: 'Completed' },
            { id: 'PO-021', amount: 145000, placedDate: '2024-09-14', status: 'Active' },
            { id: 'PO-022', amount: 198000, placedDate: '2024-10-20', status: 'Completed' },
            { id: 'PO-023', amount: 127000, placedDate: '2024-11-12', status: 'Active' },
            { id: 'PO-024', amount: 182000, placedDate: '2024-12-18', status: 'Completed' },
            { id: 'PO-025', amount: 158000, placedDate: '2025-01-15', status: 'Active' },
            { id: 'PO-026', amount: 213000, placedDate: '2025-02-22', status: 'Active' },
            { id: 'PO-027', amount: 171000, placedDate: '2025-03-18', status: 'Active' },
            { id: 'PO-028', amount: 194000, placedDate: '2025-04-25', status: 'Active' },
            { id: 'PO-029', amount: 136000, placedDate: '2025-05-12', status: 'Active' },
            { id: 'PO-030', amount: 205000, placedDate: '2025-06-08', status: 'Active' },
            { id: 'PO-031', amount: 148000, placedDate: '2025-07-15', status: 'Active' },
            { id: 'PO-032', amount: 167000, placedDate: '2025-08-20', status: 'Active' }
        ];

        // Set default dates (Monday of first week = January 2, 2023)
        function setDefaultDates() {
            // Set default dates to capture all data from dataset start
            const datasetStartDate = '2023-01-02'; // First Monday of dataset (Jan 2, 2023)
            const today = new Date();
            const todayString = today.toISOString().split('T')[0];
            
            // Update dashboard date filter to show all time data
            const dashboardStartDate = document.getElementById('dashboard-start-date');
            const dashboardEndDate = document.getElementById('dashboard-end-date');
            if (dashboardStartDate) dashboardStartDate.value = datasetStartDate;
            if (dashboardEndDate) dashboardEndDate.value = todayString;
            
            // Update projects date filter to show all time data  
            const projectsStartDate = document.getElementById('projects-start-date');
            const projectsEndDate = document.getElementById('projects-end-date');
            if (projectsStartDate) projectsStartDate.value = datasetStartDate;
            if (projectsEndDate) projectsEndDate.value = todayString;
            
            // Update status indicators
            const projectsStatus = document.getElementById('date-filter-status');
            const dashboardStatus = document.getElementById('dashboard-date-filter-status');
            if (projectsStatus) projectsStatus.textContent = 'Showing: Total (All Time) Data';
            if (dashboardStatus) dashboardStatus.textContent = 'Showing: Total (All Time) Data';
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            console.log(' SynqChain Production Demo Loaded!');
            console.log(' Full-screen login gateway');
            console.log(' Complete PO Management System');
            console.log(' Ready for first customer!');
            
            // Set default dates first
            setDefaultDates();
            
            // Initialize projects table
            renderProjectsTable();
            
            // Initialize suppliers table
            renderSuppliersTable();
            
            // Charts will be initialized when Analytics page is first accessed
            console.log(' Login: demo@demo.com / demo');
            
            // Update time every minute
            setInterval(updateLastUpdated, 60000);
            
            // Initialize savings display
            updateSavingsDisplay();
            
            // Update savings display every 30 seconds for demo effect
            setInterval(updateSavingsDisplay, 30000);
            
            // PO table populated by DOMContentLoaded event
            
            // Show initial welcome message
            setTimeout(() => {
                showToast('SynqChain MVP loaded - ready for customer demos! ', 'success');
            }, 1000);
        });
    </script>

    <!-- AI Support Bot - "SynqBot" -->
    <div id="synqbot-button" class="ai-support-button" onclick="toggleSynqBot()">
        <span style="font-size: 24px;">🤖</span>
    </div>

    <!-- AI Chat Window -->
    <div id="synqbot-window" class="ai-chat-window">
        <div class="ai-chat-header">
            <div class="flex items-center justify-between">
                <div>
                    <h3 class="font-semibold">SynqBot AI Assistant</h3>
                    <p class="text-sm opacity-90">Your procurement intelligence helper</p>
                </div>
                <button onclick="closeSynqBot()" class="text-white hover:text-gray-200">✕</button>
            </div>
        </div>
        
        <div id="synqbot-messages" class="ai-chat-messages">
            <div class="ai-message bot">
                <div class="text-sm">
                    <strong>👋 Hi! I'm SynqBot!</strong><br>
                    I'm your AI procurement assistant. I can help you with:
                    <ul class="mt-2 text-xs list-disc list-inside">
                        <li>Finding project data</li>
                        <li>Analyzing supplier performance</li>
                        <li>Troubleshooting data issues</li>
                        <li>Explaining procurement metrics</li>
                    </ul>
                    How can I assist you today?
                </div>
            </div>
        </div>

        <div class="ai-suggestions">
            <p class="text-xs text-gray-600 mb-2">Quick suggestions:</p>
            <button class="ai-suggestion" onclick="askSynqBot('Why is my total spend showing 0?')">
                🚨 Why is my total spend showing 0?
            </button>
            <button class="ai-suggestion" onclick="askSynqBot('Show me projects with savings issues')">
                📊 Show me projects with savings issues
            </button>
            <button class="ai-suggestion" onclick="askSynqBot('Which suppliers have quality problems?')">
                ⚠️ Which suppliers have quality problems?
            </button>
            <button class="ai-suggestion" onclick="askSynqBot('Explain the PPV metric')">
                💡 Explain the PPV metric
            </button>
            <button class="ai-suggestion" onclick="askSynqBot('Why are my charts not loading?')">
                📈 Why are my charts not loading?
            </button>
        </div>
    </div>

    <script>
        // SynqBot AI Assistant Functions
        let synqbotOpen = false;

        function toggleSynqBot() {
            const window = document.getElementById('synqbot-window');
            const button = document.getElementById('synqbot-button');
            
            if (synqbotOpen) {
                closeSynqBot();
            } else {
                window.style.display = 'flex';
                button.style.transform = 'scale(0.9)';
                synqbotOpen = true;
                
                // Add a welcome back message if user has used it before
                if (localStorage.getItem('synqbot-used')) {
                    addSynqBotMessage('Welcome back! How can I help you today?', 'bot');
                }
            }
        }

        function closeSynqBot() {
            const window = document.getElementById('synqbot-window');
            const button = document.getElementById('synqbot-button');
            
            window.style.display = 'none';
            button.style.transform = 'scale(1)';
            synqbotOpen = false;
        }

        function askSynqBot(question) {
            // Add user message
            addSynqBotMessage(question, 'user');
            
            // Mark as used
            localStorage.setItem('synqbot-used', 'true');
            
            // Simulate AI thinking with delay
            setTimeout(() => {
                const response = getSynqBotResponse(question);
                addSynqBotMessage(response, 'bot');
            }, 1500);
        }

        function addSynqBotMessage(message, type) {
            const messagesContainer = document.getElementById('synqbot-messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `ai-message ${type}`;
            
            if (type === 'bot') {
                messageDiv.innerHTML = `<div class="text-sm">${message}</div>`;
            } else {
                messageDiv.innerHTML = `<div class="text-sm">${message}</div>`;
            }
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function getSynqBotResponse(question) {
            const responses = {
                'Why is my total spend showing 0?': `
                    <strong>🔍 Data Investigation:</strong><br>
                    I found the issue! Your PO data might be filtered by date. Here are common causes:
                    <ul class="mt-2 text-xs list-disc list-inside">
                        <li><strong>Date Filter:</strong> Check if your dashboard date range excludes PO placement dates</li>
                        <li><strong>ERP Sync:</strong> Last sync was 2 hours ago - try refreshing</li>
                        <li><strong>Currency Format:</strong> Verify currency is set to USD in settings</li>
                    </ul>
                    <em>💡 Try resetting your date filters first!</em>
                `,
                'Show me projects with savings issues': `
                    <strong>📊 Savings Analysis:</strong><br>
                    Found 3 projects with potential issues:
                    <ul class="mt-2 text-xs list-disc list-inside">
                        <li><strong>Manufacturing Cost Reduction:</strong> $0 actual vs $1.2M target</li>
                        <li><strong>Green Energy Procurement:</strong> Still in planning phase</li>
                        <li><strong>Mobile Payment Solutions:</strong> Cancelled (status issue)</li>
                    </ul>
                    <em>🎯 Recommend reviewing project status and completion dates</em>
                `,
                'Which suppliers have quality problems?': `
                    <strong>⚠️ Quality Alert Summary:</strong><br>
                    Current quality concerns:
                    <ul class="mt-2 text-xs list-disc list-inside">
                        <li><strong>Automotive Parts supplier:</strong> 485 PPM (target: <100)</li>
                        <li><strong>Global Manufacturing:</strong> Late deliveries (78% OTD)</li>
                        <li><strong>Tech Components Ltd:</strong> Response time 24h+ (target: <24h)</li>
                    </ul>
                    <em>📋 Check supplier management for detailed action plans</em>
                `,
                'Explain the PPV metric': `
                    <strong>💡 Purchase Price Variance (PPV) Explained:</strong><br>
                    PPV measures the difference between actual and standard purchase prices:
                    <ul class="mt-2 text-xs list-disc list-inside">
                        <li><strong>Negative PPV:</strong> Good! You paid less than budgeted</li>
                        <li><strong>Positive PPV:</strong> You paid more than expected</li>
                        <li><strong>Current: -3.2%:</strong> You're saving 3.2% vs budget</li>
                    </ul>
                    <em>🎯 Target is -5.0% for excellent performance</em>
                `,
                'Why are my charts not loading?': `
                    <strong>📈 Chart Troubleshooting:</strong><br>
                    Common chart loading issues:
                    <ul class="mt-2 text-xs list-disc list-inside">
                        <li><strong>Browser:</strong> Try refreshing or clearing cache</li>
                        <li><strong>Data Range:</strong> Charts need completion dates - check project data</li>
                        <li><strong>Filters:</strong> Too restrictive date filters may show empty charts</li>
                    </ul>
                    <em>🔄 I see you have charts loading now - issue resolved!</em>
                `
            };
            
            return responses[question] || `
                <strong>🤔 Hmm, interesting question!</strong><br>
                I'm still learning about that topic. For now, try:
                <ul class="mt-2 text-xs list-disc list-inside">
                    <li>Checking the analytics section for detailed data</li>
                    <li>Reviewing project or supplier management tabs</li>
                    <li>Using the date filters to narrow your search</li>
                </ul>
                <em>💪 I'm getting smarter every day - ask me again soon!</em>
            `;
        }

        // Helper function to completely reset login container state
        function resetLoginContainer() {
            const loginContainer = document.getElementById('login-container');
            if (loginContainer) {
                // Remove all animation classes
                loginContainer.classList.remove('hidden', 'login-fade-out');
                
                // Reset all inline styles
                loginContainer.style.display = 'block';
                loginContainer.style.opacity = '';
                loginContainer.style.transform = '';
                loginContainer.style.visibility = '';
                loginContainer.style.pointerEvents = '';
                loginContainer.style.position = '';
                loginContainer.style.zIndex = '';
                
                // Force a reflow to ensure styles are applied
                loginContainer.offsetHeight;
            }
        }

        // Navigation Click Handler
        function handleNavClick(page) {
            console.log('handleNavClick called with page:', page);
            
            // Update active navigation state for horizontal nav
            updateHorizontalNavActive(page);
            
            // Navigate to the selected page
            showPage(page);
        }
        
        // Update horizontal navigation active state
        function updateHorizontalNavActive(activePage) {
            console.log('updateHorizontalNavActive called with:', activePage);
            
            // Remove active class from all nav items
            const navItems = document.querySelectorAll('.nav-item-horizontal');
            navItems.forEach(item => {
                item.classList.remove('active');
            });
            
            // Add active class to the selected nav item
            const activeNavItem = document.getElementById(`nav-${activePage}`);
            if (activeNavItem) {
                activeNavItem.classList.add('active');
            }
        }
        
        // Account dropdown toggle
        function toggleAccountDropdown() {
            const dropdownMenu = document.getElementById('account-dropdown-menu');
            const chevron = document.getElementById('account-dropdown-chevron');
            
            if (dropdownMenu.classList.contains('hidden')) {
                dropdownMenu.classList.remove('hidden');
                chevron.style.transform = 'rotate(180deg)';
            } else {
                dropdownMenu.classList.add('hidden');
                chevron.style.transform = 'rotate(0deg)';
            }
        }
        
        // Close account dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const dropdownButton = document.getElementById('account-dropdown-button');
            const dropdownMenu = document.getElementById('account-dropdown-menu');
            
            if (!dropdownButton.contains(event.target) && !dropdownMenu.contains(event.target)) {
                dropdownMenu.classList.add('hidden');
                document.getElementById('account-dropdown-chevron').style.transform = 'rotate(0deg)';
            }
        });

        // Close modals when clicking outside or pressing Escape
        document.addEventListener('click', function(event) {
            // List of all modals
            const modals = [
                'kpi-modal', 'platform-savings-modal', 'project-modal', 'new-project-modal',
                'project-stats-modal', 'supplier-details-modal', 'add-supplier-modal',
                'supplier-profile-modal', 'po-profile-modal', 'change-request-modal'
            ];
            
            modals.forEach(modalId => {
                const modal = document.getElementById(modalId);
                if (modal && !modal.classList.contains('hidden')) {
                    // Check if click is on the backdrop (not the modal content)
                    if (event.target === modal) {
                        closeModal(modalId);
                    }
                }
            });
            
            // Handle legacy supplier modal
            const supplierModal = document.getElementById('modal');
            if (supplierModal && supplierModal.classList.contains('active')) {
                if (event.target === supplierModal) {
                    closeModal();
                }
            }
        });

        // Close modals with Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                // List of all modals
                const modals = [
                    'kpi-modal', 'platform-savings-modal', 'project-modal', 'new-project-modal',
                    'project-stats-modal', 'supplier-details-modal', 'add-supplier-modal',
                    'supplier-profile-modal', 'po-profile-modal', 'change-request-modal'
                ];
                
                modals.forEach(modalId => {
                    const modal = document.getElementById(modalId);
                    if (modal && !modal.classList.contains('hidden')) {
                        closeModal(modalId);
                    }
                });
                
                // Handle legacy supplier modal
                const supplierModal = document.getElementById('modal');
                if (supplierModal && supplierModal.classList.contains('active')) {
                    closeModal();
                }
            }
        });
        
        // Dashboard navigation functions
        function navigateToAnalytics() {
            handleNavClick('analytics');
        }
        
        function navigateToProjects() {
            handleNavClick('projects');
        }
        
        function navigateToPOs() {
            handleNavClick('po');
        }
        
        function navigateToSuppliers() {
            handleNavClick('suppliers');
        }

        // Sidebar Toggle Function (kept for compatibility but no longer functional)
        function toggleSidebar() {
            // This function is no longer needed with horizontal navigation
            console.log('Sidebar toggle deprecated - using horizontal navigation');
        }

        // =======================
        // SUPPLIER PORTAL DATA & FUNCTIONS
        // =======================

        // Supplier PO Data (Eastern Transport Co. perspective)
        let supplierPOData = [];
        let currentSupplierPOData = [];
        let supplierCurrentPage = 1;
        let supplierPageSize = 25;
        let supplierCurrentSortDirection = 'asc';
        let supplierCurrentSortColumn = '';

        // Generate supplier PO data (Eastern Transport Co. receiving POs)
        function generateSupplierPOData() {
            const customers = [
                'SynqChain Demo LLC', 'AutoTech Manufacturing', 'Global Parts Depot', 
                'Midwest Industrial', 'Precision Components Inc', 'Advanced Systems Corp',
                'Northern Manufacturing', 'Coastal Supply Chain', 'Industrial Dynamics',
                'Metro Equipment Co'
            ];
            
            const statuses = [
                'pending-ack', 'acknowledged', 'in-production', 'ready-to-ship', 'shipped', 'delivered'
            ];
            
            const priorities = ['urgent', 'high', 'medium', 'low'];
            
            const partCategories = {
                'Transportation': ['TRN-HVY-', 'TRN-LT-', 'TRN-SP-'],
                'Logistics': ['LOG-WH-', 'LOG-DL-', 'LOG-ST-'],
                'Industrial': ['IND-MFG-', 'IND-ASM-', 'IND-PKG-'],
                'Automotive': ['AUTO-ENG-', 'AUTO-TRN-', 'AUTO-ELC-']
            };

            const pos = [];

            // Generate 63 POs
            for (let i = 1; i <= 63; i++) {
                const customer = customers[Math.floor(Math.random() * customers.length)];
                const status = statuses[Math.floor(Math.random() * statuses.length)];
                const priority = priorities[Math.floor(Math.random() * priorities.length)];
                
                const category = Object.keys(partCategories)[Math.floor(Math.random() * Object.keys(partCategories).length)];
                const partPrefix = partCategories[category][Math.floor(Math.random() * partCategories[category].length)];
                const partNumber = partPrefix + String(i).padStart(4, '0');
                
                const baseValue = Math.floor(Math.random() * 50000) + 3000;
                const total = baseValue + (Math.random() * 20000);
                
                // Generate dates within last 2 years
                const startDate = new Date('2023-01-02');
                const endDate = new Date('2025-08-31');
                const receivedDate = new Date(startDate.getTime() + Math.random() * (endDate.getTime() - startDate.getTime()));
                const dueDate = new Date(receivedDate.getTime() + (Math.random() * 45 + 5) * 24 * 60 * 60 * 1000);

                const po = {
                    id: `PO-${receivedDate.getFullYear()}-${String(i).padStart(3, '0')}`,
                    customer: customer,
                    customerCode: customer.replace(/\s+/g, '').substring(0, 6).toUpperCase(),
                    total: Math.round(total),
                    status: status,
                    priority: priority,
                    receivedDate: receivedDate.toISOString().split('T')[0],
                    dueDate: dueDate.toISOString().split('T')[0],
                    partNumber: partNumber,
                    partDescription: `${category} component - ${partNumber}`,
                    items: `${category} parts and components`,
                    lineCount: Math.floor(Math.random() * 8) + 1,
                    category: category,
                    responseTime: Math.floor(Math.random() * 12) + 0.5, // hours
                    needsResponse: status === 'pending-ack',
                    isUrgent: priority === 'urgent' || priority === 'high',
                    estimatedDelivery: new Date(dueDate.getTime() - Math.random() * 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    messages: generateSupplierMessages(customer, i),
                    auditTrail: generateSupplierAuditTrail(receivedDate, status)
                };
                
                pos.push(po);
            }
            
            return pos.sort((a, b) => new Date(b.receivedDate) - new Date(a.receivedDate));
        }

        function generateSupplierMessages(customer, poIndex) {
            const messages = [
                { from: customer, content: 'Please confirm receipt and expected delivery date', timestamp: '2 hours ago' },
                { from: 'Eastern Transport Co.', content: 'Acknowledged. Will deliver by due date.', timestamp: '1 hour ago' }
            ];
            
            if (poIndex % 3 === 0) {
                messages.push({ from: customer, content: 'Can we expedite this order? Urgent need.', timestamp: '30 minutes ago' });
            }
            
            return messages;
        }

        function generateSupplierAuditTrail(receivedDate, status) {
            const trail = [
                { action: 'PO Received', user: 'System', timestamp: receivedDate + ' 09:30 AM' }
            ];
            
            if (status !== 'pending-ack') {
                trail.push({ action: 'Acknowledged', user: 'Eastern Transport Co.', timestamp: receivedDate + ' 11:15 AM' });
            }
            
            if (['in-production', 'ready-to-ship', 'shipped', 'delivered'].includes(status)) {
                trail.push({ action: 'Production Started', user: 'Production Team', timestamp: receivedDate + ' 14:22 PM' });
            }
            
            return trail;
        }

        // Initialize supplier data
        supplierPOData = generateSupplierPOData();
        currentSupplierPOData = [...supplierPOData];

        // Supplier Portal Tab Functions
        function switchSupplierTab(tabName) {
            // Hide all tabs
            const tabs = document.querySelectorAll('.supplier-tab-content');
            tabs.forEach(tab => {
                tab.classList.remove('active');
                tab.classList.add('hidden');
            });
            
            // Remove active class from all tab buttons
            const tabButtons = document.querySelectorAll('.supplier-tab-button');
            tabButtons.forEach(button => {
                button.classList.remove('active', 'border-blue-500', 'text-blue-600');
                button.classList.add('border-transparent', 'text-gray-500');
            });
            
            // Show selected tab
            const selectedTab = document.getElementById(`supplier-tab-${tabName}`);
            if (selectedTab) {
                selectedTab.classList.add('active');
                selectedTab.classList.remove('hidden');
            }
            
            // Update active tab button
            const activeButton = document.getElementById(`supplier-tab-${tabName}`);
            if (activeButton) {
                activeButton.classList.add('active', 'border-blue-500', 'text-blue-600');
                activeButton.classList.remove('border-transparent', 'text-gray-500');
            }
            
            // Load tab-specific content
            if (tabName === 'orders') {
                renderSupplierPOTable();
            }
            
            showToast(`Switched to ${tabName} tab 📋`, 'info');
        }

        // Supplier PO Table Functions
        function renderSupplierPOTable() {
            const tableBody = document.getElementById('supplier-po-table-body');
            if (!tableBody) return;
            
            const startIndex = (supplierCurrentPage - 1) * supplierPageSize;
            const endIndex = supplierPageSize === 'all' ? currentSupplierPOData.length : startIndex + parseInt(supplierPageSize);
            const pageData = currentSupplierPOData.slice(startIndex, endIndex);
            
            if (pageData.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="10" class="px-6 py-8 text-center text-gray-500">No purchase orders found.</td></tr>';
                return;
            }
            
            tableBody.innerHTML = pageData.map(po => {
                const statusColors = {
                    'pending-ack': 'bg-yellow-100 text-yellow-800',
                    'acknowledged': 'bg-blue-100 text-blue-800',
                    'in-production': 'bg-purple-100 text-purple-800',
                    'ready-to-ship': 'bg-green-100 text-green-800',
                    'shipped': 'bg-indigo-100 text-indigo-800',
                    'delivered': 'bg-gray-100 text-gray-800'
                };
                
                const priorityColors = {
                    'urgent': 'bg-red-100 text-red-800',
                    'high': 'bg-orange-100 text-orange-800',
                    'medium': 'bg-yellow-100 text-yellow-800',
                    'low': 'bg-green-100 text-green-800'
                };
                
                const responseStatus = po.needsResponse ? 
                    '<span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800">Response Needed</span>' :
                    '<span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">Up to Date</span>';
                
                return `
                    <tr class="hover:bg-gray-50 cursor-pointer" onclick="openSupplierPOProfile(event, '${po.id}')">
                        <td class="px-6 py-4">
                            <div class="text-sm font-medium text-blue-600">${po.id}</div>
                            <div class="text-xs text-gray-500">${po.lineCount} lines</div>
                        </td>
                        <td class="px-6 py-4">
                            <div class="text-sm font-medium text-gray-900">${po.customer}</div>
                            <div class="text-xs text-gray-500">${po.customerCode}</div>
                        </td>
                        <td class="px-6 py-4">
                            <div class="text-sm font-medium text-gray-900">${po.partNumber || 'N/A'}</div>
                            <div class="text-xs text-gray-500">${po.partDescription || ''}</div>
                        </td>
                        <td class="px-6 py-4">
                            <div class="text-sm font-medium text-gray-900">$${po.total.toLocaleString()}</div>
                            <div class="text-xs text-gray-500">$${Math.round(po.total / po.lineCount).toLocaleString()}/line</div>
                        </td>
                        <td class="px-6 py-4">
                            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full ${statusColors[po.status]}">
                                ${po.status.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase())}
                            </span>
                        </td>
                        <td class="px-6 py-4">
                            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full ${priorityColors[po.priority]}">
                                ${po.priority.charAt(0).toUpperCase() + po.priority.slice(1)}
                            </span>
                        </td>
                        <td class="px-6 py-4 text-sm text-gray-900">${new Date(po.receivedDate).toLocaleDateString()}</td>
                        <td class="px-6 py-4 text-sm text-gray-900">${new Date(po.dueDate).toLocaleDateString()}</td>
                        <td class="px-6 py-4">${responseStatus}</td>
                        <td class="px-6 py-4">
                            <button onclick="respondToSupplierPO(event, '${po.id}')" class="text-blue-600 hover:text-blue-800 text-sm font-medium">
                                ${po.needsResponse ? '⚡ Respond' : '📝 Update'}
                            </button>
                        </td>
                    </tr>
                `;
            }).join('');
            
            updateSupplierPagination();
        }

        // Supplier-specific functions
        function applyAllSupplierPOFilters() {
            let filteredData = [...supplierPOData];
            
            // Apply filters (similar to main PO filters but for supplier perspective)
            const searchTerm = document.getElementById('supplier-po-search')?.value.toLowerCase() || '';
            const statusFilter = document.getElementById('supplier-po-status-filter')?.value || 'all';
            const customerFilter = document.getElementById('supplier-po-customer-filter')?.value || 'all';
            const priorityFilter = document.getElementById('supplier-po-priority-filter')?.value || 'all';
            
            if (searchTerm) {
                filteredData = filteredData.filter(po => 
                    po.id.toLowerCase().includes(searchTerm) ||
                    po.customer.toLowerCase().includes(searchTerm) ||
                    po.items.toLowerCase().includes(searchTerm) ||
                    (po.partNumber && po.partNumber.toLowerCase().includes(searchTerm)) ||
                    (po.partDescription && po.partDescription.toLowerCase().includes(searchTerm))
                );
            }
            
            if (statusFilter !== 'all') {
                filteredData = filteredData.filter(po => po.status === statusFilter);
            }
            
            if (customerFilter !== 'all') {
                const customerMap = {
                    'synqchain': 'SynqChain Demo LLC',
                    'autotech': 'AutoTech Manufacturing',
                    'globalparts': 'Global Parts Depot',
                    'midwest': 'Midwest Industrial'
                };
                if (customerMap[customerFilter]) {
                    filteredData = filteredData.filter(po => po.customer === customerMap[customerFilter]);
                }
            }
            
            if (priorityFilter !== 'all') {
                filteredData = filteredData.filter(po => po.priority === priorityFilter);
            }
            
            currentSupplierPOData = filteredData;
            supplierCurrentPage = 1;
            updateSupplierSubtotals(filteredData);
            renderSupplierPOTable();
        }

        function updateSupplierSubtotals(filteredData) {
            const totalCount = filteredData.length;
            const totalValue = filteredData.reduce((sum, po) => sum + po.total, 0);
            const avgValue = totalCount > 0 ? totalValue / totalCount : 0;
            const avgResponseTime = filteredData.reduce((sum, po) => sum + po.responseTime, 0) / totalCount;
            
            const elements = {
                'supplier-po-count': totalCount.toLocaleString(),
                'supplier-po-value': totalValue >= 1000000 ? `$${(totalValue / 1000000).toFixed(1)}M` : `$${Math.round(totalValue / 1000)}K`,
                'supplier-avg-value': `$${Math.round(avgValue).toLocaleString()}`,
                'supplier-response-display': `${avgResponseTime.toFixed(1)} hours`
            };
            
            Object.entries(elements).forEach(([id, value]) => {
                const el = document.getElementById(id);
                if (el) el.textContent = value;
            });
        }

        function updateSupplierPagination() {
            // Similar to main PO pagination but for supplier data
            const totalItems = currentSupplierPOData.length;
            const totalPages = supplierPageSize === 'all' ? 1 : Math.ceil(totalItems / supplierPageSize);
            
            // Update pagination display
            const startItem = supplierPageSize === 'all' ? 1 : (supplierCurrentPage - 1) * supplierPageSize + 1;
            const endItem = supplierPageSize === 'all' ? totalItems : Math.min(supplierCurrentPage * supplierPageSize, totalItems);
            
            const elements = {
                'supplier-pagination-start': startItem,
                'supplier-pagination-end': endItem,
                'supplier-pagination-total': totalItems
            };
            
            Object.entries(elements).forEach(([id, value]) => {
                const el = document.getElementById(id);
                if (el) el.textContent = value;
            });
        }

        // Supplier portal action functions
        function exportSupplierPOs() {
            showToast('📊 Exporting supplier PO report...', 'info');
        }

        function showSupplierDashboard() {
            showToast('📈 Opening performance dashboard...', 'info');
        }

        function respondToSupplierPO(event, poId) {
            event.stopPropagation();
            showToast(`📝 Opening response form for ${poId}...`, 'info');
        }

        function openSupplierPOProfile(event, poId) {
            showToast(`📋 Opening PO profile for ${poId}...`, 'info');
        }

        function toggleSupplierQuickActions() {
            toggleSupplierCollapsible('supplier-quick-actions');
        }

        function toggleSupplierImpact() {
            toggleSupplierCollapsible('supplier-impact');
        }

        function toggleSupplierCollapsible(type) {
            const content = document.getElementById(`${type}-content`);
            const chevron = document.getElementById(`${type}-chevron`);
            
            if (content && chevron) {
                const isHidden = content.classList.contains('hidden');
                if (isHidden) {
                    content.classList.remove('hidden');
                    chevron.style.transform = 'rotate(180deg)';
                } else {
                    content.classList.add('hidden');
                    chevron.style.transform = 'rotate(0deg)';
                }
            }
        }

        function resetAllSupplierPOFilters() {
            const filters = ['supplier-po-search', 'supplier-po-status-filter', 'supplier-po-customer-filter', 'supplier-po-priority-filter'];
            filters.forEach(filterId => {
                const element = document.getElementById(filterId);
                if (element) {
                    if (element.type === 'text') {
                        element.value = '';
                    } else {
                        element.value = 'all';
                    }
                }
            });
            
            supplierCurrentPage = 1;
            applyAllSupplierPOFilters();
            showToast('Filters reset 🔄', 'success');
        }

        // Initialize supplier portal when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Set up supplier portal after main app is loaded
            setTimeout(() => {
                if (typeof supplierPOData !== 'undefined' && supplierPOData.length > 0) {
                    applyAllSupplierPOFilters();
                    console.log('Supplier portal initialized with', supplierPOData.length, 'POs');
                }
            }, 100);
        });
        
        // Suppliers page functions
        function showSupplierDetails(type) {
            let title, content;
            
            switch(type) {
                case 'total':
                    title = 'Total Suppliers Overview';
                    content = `
                        <div class="space-y-4">
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <h4 class="font-semibold text-blue-900">Total Count: 234</h4>
                                <p class="text-sm text-blue-700">Active suppliers across all categories</p>
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div class="text-center">
                                    <div class="text-2xl font-bold text-blue-600">187</div>
                                    <div class="text-sm text-gray-600">Active</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-2xl font-bold text-gray-600">47</div>
                                    <div class="text-sm text-gray-600">Inactive</div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'active':
                    title = 'Active Suppliers';
                    content = `
                        <div class="space-y-4">
                            <div class="bg-green-50 p-4 rounded-lg">
                                <h4 class="font-semibold text-green-900">Active Suppliers: 187</h4>
                                <p class="text-sm text-green-700">Suppliers with active contracts and POs</p>
                            </div>
                            <div class="text-sm text-gray-600">
                                <p>• 80% of total supplier base</p>
                                <p>• Average contract value: $45,000</p>
                                <p>• 12 new suppliers added this month</p>
                            </div>
                        </div>
                    `;
                    break;
                case 'rating':
                    title = 'Supplier Ratings';
                    content = `
                        <div class="space-y-4">
                            <div class="bg-purple-50 p-4 rounded-lg">
                                <h4 class="font-semibold text-purple-900">Average Rating: 4.2/5.0</h4>
                                <p class="text-sm text-purple-700">Based on performance metrics and feedback</p>
                            </div>
                            <div class="grid grid-cols-3 gap-4 text-center">
                                <div>
                                    <div class="text-lg font-bold text-green-600">4.5+</div>
                                    <div class="text-xs text-gray-600">Top Tier (45%)</div>
                                </div>
                                <div>
                                    <div class="text-lg font-bold text-blue-600">3.5-4.4</div>
                                    <div class="text-xs text-gray-600">Good (38%)</div>
                                </div>
                                <div>
                                    <div class="text-lg font-bold text-orange-600">3.0-3.4</div>
                                    <div class="text-xs text-gray-600">Needs Improvement (17%)</div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'performance':
                    title = 'Performance Metrics';
                    content = `
                        <div class="space-y-4">
                            <div class="bg-orange-50 p-4 rounded-lg">
                                <h4 class="font-semibold text-orange-900">Overall Performance: 92%</h4>
                                <p class="text-sm text-orange-700">Key performance indicators</p>
                            </div>
                            <div class="space-y-3">
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600">On-Time Delivery:</span>
                                    <span class="text-sm font-medium text-green-600">94%</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600">Quality (PPM):</span>
                                    <span class="text-sm font-medium text-blue-600">125</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600">Response Time:</span>
                                    <span class="text-sm font-medium text-orange-600">2.3 days</span>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'categories':
                    title = 'Supplier Categories';
                    content = `
                        <div class="space-y-4">
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <h4 class="font-semibold text-blue-900">Category Breakdown</h4>
                                <p class="text-sm text-blue-700">Total suppliers by category</p>
                            </div>
                            <div class="space-y-3">
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-gray-600">Manufacturing</span>
                                    <span class="text-sm font-medium text-gray-900">67 suppliers</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-gray-600">Technology</span>
                                    <span class="text-sm font-medium text-gray-900">45 suppliers</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-gray-600">Services</span>
                                    <span class="text-sm font-medium text-gray-900">38 suppliers</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-gray-600">Logistics</span>
                                    <span class="text-sm font-medium text-gray-900">32 suppliers</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-gray-600">Other</span>
                                    <span class="text-sm font-medium text-gray-900">52 suppliers</span>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'geography':
                    title = 'Geographic Distribution';
                    content = `
                        <div class="space-y-4">
                            <div class="bg-green-50 p-4 rounded-lg">
                                <h4 class="font-semibold text-green-900">Global Coverage</h4>
                                <p class="text-sm text-green-700">Suppliers by region</p>
                            </div>
                            <div class="space-y-3">
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-gray-600">North America</span>
                                    <span class="text-sm font-medium text-gray-900">45% (105)</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-gray-600">Europe</span>
                                    <span class="text-sm font-medium text-gray-900">28% (66)</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-gray-600">Asia Pacific</span>
                                    <span class="text-sm font-medium text-gray-900">18% (42)</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-gray-600">Other</span>
                                    <span class="text-sm font-medium text-gray-900">9% (21)</span>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                default:
                    title = 'Supplier Information';
                    content = '<p class="text-gray-600">Select a category to view detailed information.</p>';
            }
            
            showModal(title, content);
        }
        
        function showAddSupplierForm() {
            const content = `
                <div class="space-y-6">
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Company Name</label>
                            <input type="text" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="Enter company name">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Category</label>
                            <select class="w-full px-3 py-2 border border-gray-300 rounded-md">
                                <option>Manufacturing</option>
                                <option>Technology</option>
                                <option>Services</option>
                                <option>Logistics</option>
                                <option>Other</option>
                            </select>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Contact Person</label>
                            <input type="text" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="Enter contact name">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                            <input type="email" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="Enter email">
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Phone</label>
                            <input type="tel" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="Enter phone">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Country</label>
                            <select class="w-full px-3 py-2 border border-gray-300 rounded-md">
                                <option>United States</option>
                                <option>Canada</option>
                                <option>Germany</option>
                                <option>United Kingdom</option>
                                <option>Japan</option>
                                <option>Other</option>
                            </select>
                        </div>
                    </div>
                    <div class="flex space-x-3 pt-4">
                        <button onclick="closeModal()" class="flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50">
                            Cancel
                        </button>
                        <button onclick="addSupplier()" class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">
                            Add Supplier
                        </button>
                    </div>
                </div>
            `;
            
            showModal('Add New Supplier', content);
        }
        
        function addSupplier() {
            showToast('✅ Supplier added successfully!', 'success');
            closeModal();
        }
        
        function showModal(title, content) {
            const modal = document.getElementById('modal');
            const modalTitle = document.getElementById('modal-title');
            const modalContent = document.getElementById('modal-content');
            
            modalTitle.textContent = title;
            modalContent.innerHTML = content;
            modal.classList.add('active');
        }
        

        
        // ERP Integration functions
        function testConnection() {
            showToast('🔌 Testing ERP connection...', 'info');
            setTimeout(() => {
                showToast('✅ Connection successful!', 'success');
            }, 2000);
        }
        
        function syncData() {
            showToast('🔄 Syncing data from ERP systems...', 'info');
            setTimeout(() => {
                showToast('✅ Data sync completed successfully!', 'success');
            }, 3000);
        }
        
        function configureERP(system) {
            showToast(`⚙️ Opening ${system.toUpperCase()} configuration...`, 'info');
        }
        
        function exportMapping() {
            showToast('📄 Exporting field mapping configuration...', 'info');
        }
        
        function importMapping() {
            showToast('📥 Opening import dialog for field mapping...', 'info');
        }
        
        function resetMapping() {
            if (confirm('Are you sure you want to reset field mapping to default?')) {
                showToast('🔄 Field mapping reset to default configuration', 'success');
            }
        }
        
        // Settings functions
        function resetDemoData() {
            if (confirm('Are you sure you want to reset all demo data?')) {
                showToast('🔄 Demo data has been reset', 'success');
            }
        }
    </script>
</body>
</html>
